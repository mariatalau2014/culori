<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Platformă Educațională Matematică</title>

<style>
body{
    margin:0;
    font-family:Segoe UI,sans-serif;
    background:linear-gradient(135deg,#667eea,#764ba2);
    display:flex;
    justify-content:center;
    align-items:center;
    min-height:100vh;
    color:#333;
}
.app{
    width:95%;
    max-width:700px;
    background:white;
    border-radius:20px;
    padding:25px;
    box-shadow:0 20px 40px rgba(0,0,0,0.2);
}
h2{text-align:center;margin-bottom:20px;}

button{
    padding:10px 15px;
    border:none;
    border-radius:10px;
    cursor:pointer;
    background:#764ba2;
    color:white;
    margin:5px 0;
}
input,select{
    padding:8px;
    border-radius:8px;
    border:1px solid #ccc;
    margin:5px 0;
}

.section{display:none;}
.list-item{
    background:#f3f3f3;
    padding:8px;
    margin:5px 0;
    border-radius:8px;
    cursor:pointer;
}
.problem{
    font-size:28px;
    text-align:center;
    margin:20px 0;
}
.stats-box{
    background:#f9f9f9;
    padding:10px;
    border-radius:10px;
    margin-top:10px;
}
</style>
</head>
<body>

<div class="app">

<!-- MENIU -->
<div id="menu">
    <h2>Platformă Educațională</h2>
    <button onclick="openTeacher()">Cont Profesor</button>
    <button onclick="openStudent()">Elev</button>
</div>

<!-- PROFESOR -->
<div class="section" id="teacherPanel">
    <h2>Panou Profesor</h2>

    <input type="text" id="className" placeholder="Nume clasă">
    <button onclick="addClass()">Adaugă clasă</button>

    <div id="classList"></div>

    <button onclick="goMenu()">Înapoi</button>
</div>

<!-- ELEV -->
<div class="section" id="studentPanel">
    <h2>Elev</h2>

    <select id="studentClass"></select>
    <select id="studentName"></select>
    <button onclick="startGame()">Start Joc</button>

    <div id="gameArea" style="display:none;">
        <div class="problem" id="problem"></div>
        <input type="number" id="answer">
        <button onclick="checkAnswer()">Verifică</button>
        <div id="score"></div>
    </div>

    <button onclick="goMenu()">Înapoi</button>
</div>

</div>

<script>
let correctAnswer=0;
let currentStudent="";
let currentClass="";
let score=0;

function saveData(data){
    localStorage.setItem("edu_data",JSON.stringify(data));
}
function loadData(){
    return JSON.parse(localStorage.getItem("edu_data")||"{}");
}

function openTeacher(){
    document.getElementById("menu").style.display="none";
    document.getElementById("teacherPanel").style.display="block";
    renderClasses();
}

function openStudent(){
    document.getElementById("menu").style.display="none";
    document.getElementById("studentPanel").style.display="block";
    loadStudentSelectors();
}

function goMenu(){
    document.querySelectorAll(".section").forEach(s=>s.style.display="none");
    document.getElementById("menu").style.display="block";
}

function addClass(){
    let name=document.getElementById("className").value.trim();
    if(!name)return;

    let data=loadData();
    if(!data[name])data[name]={students:{}};
    saveData(data);
    document.getElementById("className").value="";
    renderClasses();
}

function renderClasses(){
    let data=loadData();
    let container=document.getElementById("classList");
    container.innerHTML="";
    for(let c in data){
        let div=document.createElement("div");
        div.className="list-item";
        div.innerHTML="<b>"+c+"</b>";
        div.onclick=()=>openClass(c);
        container.appendChild(div);
    }
}

function openClass(c){
    let data=loadData();
    let students=data[c].students;

    let html="<h3>"+c+"</h3>";
    html+=`<input type="text" id="newStudent" placeholder="Nume elev">
           <button onclick="addStudent('${c}')">Adaugă</button>`;

    for(let s in students){
        let stats=calculateStats(students[s]);
        html+=`<div class="stats-box">
                <b>${s}</b><br>
                Jocuri: ${stats.games}<br>
                Medie: ${stats.average}<br>
                Cel mai bun scor: ${stats.best}
               </div>`;
    }

    html+=`<button onclick="renderClasses()">Înapoi</button>`;
    document.getElementById("classList").innerHTML=html;
}

function addStudent(c){
    let name=document.getElementById("newStudent").value.trim();
    if(!name)return;

    let data=loadData();
    data[c].students[name]=[];
    saveData(data);
    openClass(c);
}

function loadStudentSelectors(){
    let data=loadData();
    let classSel=document.getElementById("studentClass");
    let nameSel=document.getElementById("studentName");

    classSel.innerHTML="";
    for(let c in data){
        classSel.innerHTML+=`<option value="${c}">${c}</option>`;
    }

    classSel.onchange=()=>{
        nameSel.innerHTML="";
        let students=data[classSel.value].students;
        for(let s in students){
            nameSel.innerHTML+=`<option value="${s}">${s}</option>`;
        }
    };
    classSel.dispatchEvent(new Event("change"));
}

function startGame(){
    currentClass=document.getElementById("studentClass").value;
    currentStudent=document.getElementById("studentName").value;
    score=0;
    document.getElementById("gameArea").style.display="block";
    nextQuestion();
}

function nextQuestion(){
    let a=Math.floor(Math.random()*10)+1;
    let b=Math.floor(Math.random()*10)+1;
    correctAnswer=a+b;
    document.getElementById("problem").innerText=a+" + "+b+" = ?";
    document.getElementById("answer").value="";
}

function checkAnswer(){
    let val=parseInt(document.getElementById("answer").value);
    if(val===correctAnswer){
        score+=10;
    }
    document.getElementById("score").innerText="Scor: "+score;

    if(score>=100){
        endGame();
    }else{
        nextQuestion();
    }
}

function endGame(){
    let data=loadData();
    data[currentClass].students[currentStudent].push(score);
    saveData(data);
    alert("Joc terminat! Scor final: "+score);
    document.getElementById("gameArea").style.display="none";
}

function calculateStats(scores){
    if(scores.length===0) return {games:0,average:0,best:0};
    let sum=scores.reduce((a,b)=>a+b,0);
    return {
        games:scores.length,
        average:(sum/scores.length).toFixed(1),
        best:Math.max(...scores)
    };
}
</script>

</body>
</html>