<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>üöó Ma»ôinu»õa Mea</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      touch-action: manipulation;
    }
    body {
      background: #6a1b9a; /* violet */
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      overflow: hidden;
      user-select: none;
    }
    #gameContainer {
      position: relative;
      width: 320px;
      max-width: 95vw;
    }
    canvas {
      background: #2e1a47;
      border: 3px solid #9c27b0;
      border-radius: 12px;
      display: block;
      margin: 0 auto;
    }
    #ui {
      position: absolute;
      top: 10px;
      left: 0;
      right: 0;
      display: flex;
      justify-content: space-between;
      padding: 0 15px;
      color: white;
      font-weight: bold;
      font-size: 16px;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
      z-index: 10;
    }
    #controls {
      position: absolute;
      bottom: 15px;
      left: 0;
      right: 0;
      display: flex;
      justify-content: center;
      gap: 20px;
      z-index: 10;
    }
    .btn {
      background: #9c27b0;
      color: white;
      border: none;
      border-radius: 50%;
      width: 55px;
      height: 55px;
      font-size: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      cursor: pointer;
      transition: transform 0.1s;
    }
    .btn:active {
      transform: scale(0.95);
    }
    #exitBtn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #e91e63;
      width: 45px;
      height: 45px;
      border-radius: 50%;
      font-size: 20px;
      z-index: 20;
    }
    #gameOver, #startScreen {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(46, 26, 71, 0.95);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      color: white;
      border-radius: 12px;
      text-align: center;
      padding: 20px;
      z-index: 30;
    }
    #startScreen h1, #gameOver h2 {
      font-size: 24px;
      margin-bottom: 15px;
      color: #ce93d8;
    }
    #startScreen p, #gameOver p {
      margin: 8px 0;
      font-size: 14px;
      max-width: 280px;
    }
    .actionBtn {
      margin-top: 20px;
      background: #7e57c2;
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 25px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }
    .actionBtn:hover {
      background: #9575cd;
    }
    .hidden {
      display: none !important;
    }
    @media (max-height: 500px) {
      .btn { width: 45px; height: 45px; font-size: 20px; }
      #ui { font-size: 14px; }
    }
  </style>
</head>
<body>
  <div id="gameContainer">
    <canvas id="game" width="320" height="480"></canvas>
    
    <div id="ui">
      <span>Scor: <span id="score">0</span>/100</span>
      <span>Viteza: <span id="speed">1</span>x</span>
    </div>
    
    <button id="exitBtn" class="btn" title="Ie»ôire">‚úï</button>
    
    <div id="controls">
      <button class="btn" id="leftBtn">‚óÄ</button>
      <button class="btn" id="rightBtn">‚ñ∂</button>
    </div>
    
    <div id="startScreen">
      <h1>üöó Ma»ôinu»õa Mea</h1>
      <p>Folose»ôte sƒÉge»õile ‚Üê ‚Üí sau butoanele de jos</p>
      <p>Ocole»ôte obstacolele! +1 punct la fiecare obstacol evitat</p>
      <p>-5 puncte dacƒÉ love»ôti un obstacol</p>
      <button class="actionBtn" id="startBtn">‚ñ∂ JOACƒÇ</button>
    </div>
    
    <div id="gameOver" class="hidden">
      <h2>üí• Joc Terminat!</h2>
      <p>Scorul tƒÉu: <span id="finalScore">0</span>/100</p>
      <p id="message">√éncearcƒÉ din nou!</p>
      <button class="actionBtn" id="restartBtn">üîÑ REIA</button>
    </div>
  </div>

  <script>
    // === Config ===
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const scoreEl = document.getElementById('score');
    const speedEl = document.getElementById('speed');
    const finalScoreEl = document.getElementById('finalScore');
    const messageEl = document.getElementById('message');
    const startScreen = document.getElementById('startScreen');
    const gameOverScreen = document.getElementById('gameOver');
    const startBtn = document.getElementById('startBtn');
    const restartBtn = document.getElementById('restartBtn');
    const exitBtn = document.getElementById('exitBtn');
    const leftBtn = document.getElementById('leftBtn');
    const rightBtn = document.getElementById('rightBtn');

    // === Stare joc ===
    let gameRunning = false;
    let score = 0;
    let speed = 2;
    let animationId;
    
    // === Ma»ôina jucƒÉtorului ===
    const car = {
      x: canvas.width / 2 - 20,
      y: canvas.height - 70,
      width: 40,
      height: 60,
      speed: 5,
      color: '#4fc3f7'
    };
    
    // === Obstacole ===
    let obstacles = [];
    const obstacleColors = ['#ff7043', '#66bb6a', '#ffa726', '#ab47bc'];
    
    // === Controale ===
    const keys = { left: false, right: false };
    
    // === Evenimente tastaturƒÉ ===
    window.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft') keys.left = true;
      if (e.key === 'ArrowRight') keys.right = true;
    });
    
    window.addEventListener('keyup', (e) => {
      if (e.key === 'ArrowLeft') keys.left = false;
      if (e.key === 'ArrowRight') keys.right = false;
    });
    
    // === Controale touch/mouse pe butoane ===
    function addTouch(btn, key) {
      const start = (e) => { e.preventDefault(); keys[key] = true; };
      const end = (e) => { e.preventDefault(); keys[key] = false; };
      btn.addEventListener('touchstart', start, {passive: false});
      btn.addEventListener('touchend', end);
      btn.addEventListener('mousedown', start);
      btn.addEventListener('mouseup', end);
      btn.addEventListener('mouseleave', end);
    }
    addTouch(leftBtn, 'left');
    addTouch(rightBtn, 'right');
    
    // === Buton ie»ôire ===
    exitBtn.addEventListener('click', () => {
      if (gameRunning) {
        cancelAnimationFrame(animationId);
        gameRunning = false;
      }
      startScreen.classList.remove('hidden');
      gameOverScreen.classList.add('hidden');
      score = 0;
      scoreEl.textContent = score;
      obstacles = [];
    });
    
    // === Pornire joc ===
    function startGame() {
      startScreen.classList.add('hidden');
      gameOverScreen.classList.add('hidden');
      score = 0;
      speed = 2;
      scoreEl.textContent = score;
      speedEl.textContent = speed;
      car.x = canvas.width / 2 - 20;
      obstacles = [];
      gameRunning = true;
      gameLoop();
    }
    
    startBtn.addEventListener('click', startGame);
    restartBtn.addEventListener('click', startGame);
    
    // === Generare obstacole ===
    function spawnObstacle() {
      if (!gameRunning) return;
      const width = 35 + Math.random() * 25;
      const obstacle = {
        x: Math.random() * (canvas.width - width),
        y: -60,
        width: width,
        height: 40,
        color: obstacleColors[Math.floor(Math.random() * obstacleColors.length)],
        passed: false
      };
      obstacles.push(obstacle);
      
      // UrmƒÉtorul obstacol √Æntre 800-1500ms
      const nextSpawn = Math.max(400, 1500 - speed * 200);
      setTimeout(spawnObstacle, nextSpawn + Math.random() * 700);
    }
    
    // === Coliziune ===
    function checkCollision(a, b) {
      return a.x < b.x + b.width &&
             a.x + a.width > b.x &&
             a.y < b.y + b.height &&
             a.y + a.height > b.y;
    }
    
    // === Desenare ===
    function drawCar() {
      // Corp ma»ôinƒÉ
      ctx.fillStyle = car.color;
      ctx.fillRect(car.x, car.y, car.width, car.height);
      
      // Geamuri
      ctx.fillStyle = '#1a237e';
      ctx.fillRect(car.x + 5, car.y + 10, car.width - 10, 15);
      
      // Ro»õi
      ctx.fillStyle = '#212121';
      ctx.fillRect(car.x - 3, car.y + 10, 6, 12);
      ctx.fillRect(car.x + car.width - 3, car.y + 10, 6, 12);
      ctx.fillRect(car.x - 3, car.y + 38, 6, 12);
      ctx.fillRect(car.x + car.width - 3, car.y + 38, 6, 12);
      
      // Faruri
      ctx.fillStyle = '#ffeb3b';
      ctx.fillRect(car.x + 5, car.y, 8, 5);
      ctx.fillRect(car.x + car.width - 13, car.y, 8, 5);
    }
    
    function drawObstacle(obs) {
      ctx.fillStyle = obs.color;
      ctx.fillRect(obs.x, obs.y, obs.width, obs.height);
      
      // Detalii obstacol
      ctx.fillStyle = 'rgba(0,0,0,0.2)';
      ctx.fillRect(obs.x + 5, obs.y + 5, obs.width - 10, obs.height - 10);
    }
    
    function drawRoad() {
      // Linii drum
      ctx.setLineDash([20, 15]);
      ctx.strokeStyle = 'rgba(255,255,255,0.4)';
      ctx.lineWidth = 3;
      ctx.beginPath();
      ctx.moveTo(canvas.width / 2, 0);
      ctx.lineTo(canvas.width / 2, canvas.height);
      ctx.stroke();
      ctx.setLineDash([]);
    }
    
    // === Actualizare logicƒÉ ===
    function update() {
      // Mi»ôcare ma»ôinƒÉ
      if (keys.left && car.x > 10) car.x -= car.speed;
      if (keys.right && car.x < canvas.width - car.width - 10) car.x += car.speed;
      
      // Actualizare obstacole
      for (let i = obstacles.length - 1; i >= 0; i--) {
        const obs = obstacles[i];
        obs.y += speed;
        
        // Scor c√¢nd obstacolul este evitat
        if (!obs.passed && obs.y > car.y + car.height) {
          obs.passed = true;
          score = Math.min(100, score + 1);
          scoreEl.textContent = score;
          
          // Cre»ôtere vitezƒÉ la fiecare 10 puncte
          if (score % 10 === 0 && speed < 6) {
            speed += 0.5;
            speedEl.textContent = speed.toFixed(1);
          }
        }
        
        // Coliziune
        if (checkCollision(car, obs)) {
          score = Math.max(0, score - 5);
          scoreEl.textContent = score;
          endGame();
          return;
        }
        
        // Eliminarea obstacolelor ie»ôite din ecran
        if (obs.y > canvas.height) {
          obstacles.splice(i, 1);
        }
      }
    }
    
    // === Sf√¢r»ôit joc ===
    function endGame() {
      gameRunning = false;
      cancelAnimationFrame(animationId);
      finalScoreEl.textContent = score;
      
      if (score >= 80) {
        messageEl.textContent = 'üåü Excelent! E»ôti un pilot grozav!';
      } else if (score >= 50) {
        messageEl.textContent = 'üëç Bun! Mai exerseazƒÉ pentru scor mai mare!';
      } else {
        messageEl.textContent = 'üí™ √éncearcƒÉ din nou! Po»õi mai mult!';
      }
      
      gameOverScreen.classList.remove('hidden');
    }
    
    // === BuclƒÉ principalƒÉ ===
    function gameLoop() {
      if (!gameRunning) return;
      
      // CurƒÉ»õare canvas
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      // Desenare elemente
      drawRoad();
      obstacles.forEach(drawObstacle);
      drawCar();
      
      // Actualizare logicƒÉ
      update();
      
      // Continuare buclƒÉ
      animationId = requestAnimationFrame(gameLoop);
    }
    
    // === Ini»õializare ===
    spawnObstacle();
    
    // === Prevenire scroll la touch ===
    document.addEventListener('touchmove', (e) => {
      if (gameRunning) e.preventDefault();
    }, { passive: false });
  </script>
</body>
</html>
