<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Super Jocuri Educa»õionale Complete</title>
<link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;700&family=Comic+Sans+MS&display=swap" rel="stylesheet">
<style>
/* --- VARIABILE TEME --- */
:root {
    --bg-color: #FCE4EC;
    --bg-pattern: radial-gradient(#F8BBD0 15%, transparent 16%);
    --primary-color: #EC407A;
    --secondary-color: #F48FB1;
    --accent-color: #AB47BC;
    --text-color: #880E4F;
    --card-bg: #FFFFFF;
    --btn-shadow: #C2185B;
    --font-main: 'Comic Sans MS', 'Chalkboard SE', sans-serif;
}

/* Tema BƒÉiat */
body.boy-theme {
    --bg-color: #E3F2FD;
    --bg-pattern: radial-gradient(#BBDEFB 15%, transparent 16%);
    --primary-color: #2196F3;
    --secondary-color: #4FC3F7;
    --accent-color: #4CAF50;
    --text-color: #0D47A1;
    --card-bg: #FFFFFF;
    --btn-shadow: #1565C0;
}

* { box-sizing: border-box; margin: 0; padding: 0; font-family: var(--font-main); user-select: none; -webkit-tap-highlight-color: transparent; }

body {
    background-color: var(--bg-color);
    background-image: var(--bg-pattern), var(--bg-pattern);
    background-size: 60px 60px;
    background-position: 0 0, 30px 30px;
    color: var(--text-color);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    overflow-x: hidden;
    transition: all 0.5s ease;
}

/* --- ECRAN START --- */
#startScreen {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: linear-gradient(135deg, #fff 0%, #f0f0f0 100%);
    z-index: 9999;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
}
.start-title { font-size: 2.5rem; color: #555; margin-bottom: 3rem; font-family: 'Fredoka One', cursive; }
.gender-cards { display: flex; gap: 2rem; flex-wrap: wrap; justify-content: center; }
.gender-card {
    background: white; padding: 2rem; border-radius: 30px;
    cursor: pointer; transition: transform 0.3s;
    box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    border: 5px solid #eee;
    min-width: 200px;
}
.gender-card:hover { transform: scale(1.1); }
.gender-icon { font-size: 5rem; display: block; margin-bottom: 1rem; }
.gender-title { font-size: 1.5rem; font-weight: bold; color: #333; }
.girl-card { border-color: #F48FB1; }
.girl-card .gender-title { color: #EC407A; }
.boy-card { border-color: #4FC3F7; }
.boy-card .gender-title { color: #2196F3; }

/* --- MENIU PRINCIPAL --- */
.container { width: 90%; max-width: 900px; text-align: center; padding: 1rem; z-index: 10; }
h1 { font-size: 2.5rem; margin-bottom: 1.5rem; color: var(--primary-color); text-shadow: 2px 2px 0px #FFF; font-family: 'Fredoka One', cursive; }
.menu-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1.5rem; width: 100%; margin-bottom: 2rem; }

.big-card {
    background: var(--card-bg); border-radius: 25px; padding: 1.5rem;
    cursor: pointer; transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    box-shadow: 0 8px 0 rgba(0,0,0,0.1); border: 4px solid #FFF;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    min-height: 180px; position: relative;
}
.big-card:hover { transform: translateY(-8px) scale(1.02); box-shadow: 0 15px 0 rgba(0,0,0,0.1); }
.big-card-icon { font-size: 4rem; margin-bottom: 0.5rem; filter: drop-shadow(0 5px 5px rgba(0,0,0,0.1)); }
.big-card-title { font-weight: 900; font-size: 1.4rem; margin-bottom: 0.5rem; font-family: 'Fredoka One', cursive; color: var(--text-color); }
.big-card-desc { font-size: 0.9rem; line-height: 1.4; font-weight: 600; opacity: 0.8; color: var(--text-color); }

/* Buton Ie»ôire Global */
.exit-btn {
    position: absolute; top: 10px; right: 10px;
    background: #FF5252; color: white; border: none;
    padding: 8px 15px; border-radius: 20px;
    font-weight: bold; cursor: pointer;
    box-shadow: 0 4px 0 #D32F2F;
    font-size: 0.9rem; z-index: 100;
    display: flex; align-items: center; gap: 5px;
}
.exit-btn:active { transform: translateY(4px); box-shadow: none; }

/* Stiluri Generale Jocuri */
.sub-menu-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1rem; width: 100%; }
.card { background: var(--card-bg); border-radius: 20px; padding: 1.5rem; cursor: pointer; transition: all 0.3s; box-shadow: 0 6px 0 rgba(0,0,0,0.1); border: 3px solid #FFF; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 140px; }
.card:hover { transform: translateY(-6px); box-shadow: 0 12px 0 rgba(0,0,0,0.1); }
.card-icon { font-size: 2.5rem; margin-bottom: 0.5rem; }
.card-title { font-weight: 900; font-size: 1.2rem; margin-bottom: 0.5rem; color: var(--text-color); }
.card-desc { font-size: 0.8rem; line-height: 1.4; font-weight: 600; opacity: 0.8; }

.game-area { display: none; background: var(--card-bg); border-radius: 25px; padding: 2rem; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 100%; max-width: 600px; animation: popIn 0.5s; border: 4px solid var(--secondary-color); }
@keyframes popIn { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }

.stats-bar { display: flex; justify-content: space-between; margin-bottom: 1rem; font-size: 1.2rem; font-weight: 800; color: var(--primary-color); background: var(--secondary-color); padding: 8px 15px; border-radius: 50px; color: white; }
.timer-container { width: 100%; height: 12px; background-color: #eee; border-radius: 10px; margin-bottom: 1rem; overflow: hidden; border: 2px solid #ddd; }
.timer-bar { height: 100%; width: 100%; background-color: #66BB6A; transition: width 1s linear; }

.problem-display { font-size: 3.5rem; font-weight: 900; margin: 1rem 0; color: var(--primary-color); }
.input-group { display: flex; gap: 1rem; justify-content: center; margin-bottom: 1.5rem; }
input[type="number"], input[type="text"] { width: 120px; padding: 0.8rem; font-size: 2rem; text-align: center; border: 3px solid var(--secondary-color); border-radius: 15px; outline: none; background: #FFF; color: var(--text-color); }
input:focus { border-color: var(--primary-color); transform: scale(1.05); }

.choices-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-top: 1rem; }
.choice-btn { background: white; border: 3px solid var(--secondary-color); border-radius: 15px; padding: 1rem; font-size: 1.8rem; font-weight: 900; color: var(--primary-color); cursor: pointer; box-shadow: 0 5px 0 #0277BD; }
.choice-btn:active { transform: translateY(5px); box-shadow: none; }

.btn { padding: 0.8rem 1.5rem; font-size: 1.2rem; border: none; border-radius: 50px; cursor: pointer; font-weight: 900; color: white; box-shadow: 0 4px 0 rgba(0,0,0,0.2); margin-top: 10px; }
.btn:active { transform: translateY(4px); box-shadow: none; }
.btn-primary { background-color: var(--primary-color); box-shadow: 0 4px 0 var(--btn-shadow); }
.btn-secondary { background-color: #B0BEC5; box-shadow: 0 4px 0 #78909C; font-size: 1rem; }

.feedback { height: 2.5rem; margin-top: 1rem; font-weight: 900; font-size: 1.2rem; }
.feedback.correct { color: #66BB6A; }
.feedback.wrong { color: #EF5350; }

.back-btn { position: absolute; top: 10px; left: 10px; background: white; border: none; padding: 8px 15px; border-radius: 20px; cursor: pointer; font-weight: 900; box-shadow: 0 3px 5px rgba(0,0,0,0.1); z-index: 10; color: var(--primary-color); }

/* Jump Game */
#jumpGameContainer { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #222; z-index: 200; touch-action: none; }
#jumpCanvas { display: block; width: 100%; height: 100%; }
#jumpUI { position: absolute; top: 20px; left: 20px; color: white; font-size: 20px; font-weight: bold; text-shadow: 2px 2px 4px #000; z-index: 10; pointer-events: none; }
#jumpMenu { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: flex; flex-direction: column; justify-content: center; align-items: center; color: white; z-index: 20; }
#jumpWinScreen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(76, 175, 80, 0.95); display: none; flex-direction: column; justify-content: center; align-items: center; color: white; z-index: 30; text-align: center; }

/* Letter Game */
#letterGameContainer { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #FFF0F5; z-index: 200; touch-action: none; }
.letter-card-ui { background: rgba(255, 255, 255, 0.95); width: 95%; height: 95%; max-height: 800px; border-radius: 25px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); display: flex; flex-direction: column; align-items: center; padding: 15px; position: relative; margin: 2.5% auto; }
.letter-header { text-align: center; width: 100%; margin-bottom: 5px; }
.letter-header h1 { font-family: 'Fredoka One'; color: var(--primary-color); font-size: 1.6rem; margin: 0; }
.letter-score { background: var(--secondary-color); color: white; padding: 5px 15px; border-radius: 20px; font-weight: bold; font-size: 1rem; display: inline-block; margin-top: 5px; }
.letter-play-area { flex: 1; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 15px; }
.letter-card-display { background: var(--accent-color); width: 90px; height: 90px; border-radius: 20px; display: flex; justify-content: center; align-items: center; font-family: 'Fredoka One'; font-size: 3.5rem; color: white; box-shadow: 0 6px 0 rgba(0,0,0,0.2); }
.letter-canvas-container { position: relative; width: 100%; max-width: 320px; aspect-ratio: 1; background: white; border: 3px dashed var(--secondary-color); border-radius: 20px; }
.letter-canvas-container canvas { border-radius: 15px; width: 100%; height: 100%; display: block; position: absolute; top: 0; left: 0; }
#guideCanvas { z-index: 1; pointer-events: none; }
#drawCanvas { z-index: 2; }
.letter-action-btn { background: var(--primary-color); color: white; border: none; padding: 12px 25px; font-family: 'Fredoka One'; font-size: 1.2rem; border-radius: 50px; cursor: pointer; box-shadow: 0 5px 0 var(--btn-shadow); width: 90%; max-width: 250px; margin-top: auto; margin-bottom: 10px; }
.letter-action-btn:active { transform: translateY(5px); box-shadow: none; }
.letter-feedback-overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255,255,255,0.95); display: flex; flex-direction: column; justify-content: center; align-items: center; font-family: 'Fredoka One'; font-size: 2.5rem; pointer-events: none; opacity: 0; transition: opacity 0.3s; z-index: 100; border-radius: 25px; }
.letter-feedback-overlay.show { opacity: 1; }

/* Translation Game Styles */
#translationGameContainer { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(74, 20, 140, 0.95); z-index: 200; touch-action: manipulation; backdrop-filter: blur(5px); }
.trans-ui { 
    background: rgba(255, 255, 255, 0.15); 
    padding: 25px; 
    border-radius: 25px; 
    box-shadow: 0 8px 20px rgba(0,0,0,0.3); 
    width: 90%; 
    max-width: 450px; 
    border: 4px solid rgba(255, 255, 255, 0.4); 
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    display: flex; flex-direction: column; align-items: center;
}
.trans-title { font-family: 'Fredoka One'; font-size: 1.8rem; margin-bottom: 15px; color: #ffeaa7; text-shadow: 2px 2px 0px #d63031; }
.lang-buttons { display: flex; gap: 15px; justify-content: center; margin-bottom: 20px; }
.trans-btn { 
    font-family: 'Fredoka One'; border: none; padding: 12px 20px; border-radius: 50px; color: white; 
    font-size: 1.1rem; cursor: pointer; transition: all 0.2s; outline: none; box-shadow: 0 5px 0 rgba(0,0,0,0.3); 
}
.trans-btn:active { top: 5px; box-shadow: none; transform: scale(0.95); }
.btn-en { background-color: #0984e3; }
.btn-fr { background-color: #e84393; }
.trans-btn.selected { filter: brightness(1.2); box-shadow: 0 0 15px #fff; transform: scale(1.05); }
.trans-area { display: none; flex-direction: column; gap: 15px; width: 100%; animation: fadeIn 0.5s; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
.word-card { 
    background-color: #fff; color: #6c5ce7; font-family: 'Fredoka One'; font-size: 2.2rem; 
    padding: 20px; border-radius: 20px; margin: 10px 0; box-shadow: 0 6px 0 #dfe6e9; 
    border: 3px dashed #a29bfe; position: relative; width: 100%; text-align: center;
}
.word-card::after { content: '‚ú®'; position: absolute; top: -15px; right: -10px; font-size: 1.5rem; }
.trans-input { 
    padding: 15px; border-radius: 15px; border: 4px solid #fff; background-color: #fff; 
    font-family: 'Nunito', sans-serif; font-size: 1.3rem; text-align: center; width: 100%; 
    outline: none; color: #2d3436; transition: all 0.3s; box-sizing: border-box; 
}
.trans-input:focus { border-color: #fd79a8; transform: scale(1.02); }
.btn-check { background-color: #00b894; width: 100%; font-size: 1.4rem; margin-top: 15px; color: white; border:none; padding:12px; border-radius:50px; font-weight:bold; cursor:pointer; box-shadow: 0 5px 0 rgba(0,0,0,0.2); }
.btn-check:active { transform: translateY(5px); box-shadow: none; }
.btn-next-trans { background-color: #fdcb6e; color: #d63031; display: none; width: 100%; font-size: 1.4rem; margin-top: 15px; border:none; padding:12px; border-radius:50px; font-weight:bold; cursor:pointer; box-shadow: 0 5px 0 rgba(0,0,0,0.2); }
.btn-next-trans:active { transform: translateY(5px); box-shadow: none; }
.feedback-trans { min-height: 100px; display: flex; align-items: center; justify-content: center; flex-direction: column; width: 100%; }
.magic-square { width: 80px; height: 80px; background: linear-gradient(45deg, #fd79a8, #feca57); border-radius: 15px; display: flex; align-items: center; justify-content: center; font-size: 3rem; color: white; box-shadow: 0 0 20px #fd79a8; animation: popAndSpin 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275); border: 4px solid #fff; }
@keyframes popAndSpin { 0% { transform: scale(0) rotate(-180deg); opacity: 0; } 60% { transform: scale(1.2) rotate(10deg); opacity: 1; } 100% { transform: scale(1) rotate(0deg); opacity: 1; } }
.shake { animation: shakeAnim 0.4s ease-in-out; border-color: #ff7675 !important; background-color: #ffeaa7 !important; }
@keyframes shakeAnim { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } }

/* Time Game Styles */
#timeGameContainer { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(74, 20, 140, 0.98); z-index: 200; touch-action: manipulation; backdrop-filter: blur(5px); overflow-y: auto; }
.time-ui { 
    background: rgba(255, 255, 255, 0.98); 
    color: #4B0082;
    padding: 15px; 
    border-radius: 20px; 
    box-shadow: 0 8px 20px rgba(75, 0, 130, 0.25); 
    width: 95%; 
    max-width: 380px; 
    border: 3px solid #FFF; 
    position: relative;
    margin: 20px auto 100px auto; 
    text-align: center;
}
.time-h1 { font-size: 1.3rem; color: #FF1493; margin: 5px 0; text-shadow: 1px 1px 0px #FFD700; font-family: 'Fredoka One'; }
.time-sub { font-size: 0.75rem; color: #8A2BE2; margin-bottom: 10px; }
.time-progress-container { width: 100%; background-color: #E6E6FA; border-radius: 10px; margin: 8px 0; height: 12px; overflow: hidden; border: 1px solid #9370DB; }
.time-progress-bar { height: 100%; background: linear-gradient(to right, #FF69B4, #FFD700); width: 0%; transition: width 0.4s ease; }
.time-year-display { font-size: 2.5rem; font-weight: 600; color: #FF1493; margin: 10px 0; background: #FFF0F5; border: 2px dashed #FF1493; border-radius: 15px; padding: 10px; display: inline-block; min-width: 100px; }
.time-input-group { display: grid; grid-template-columns: 1fr; gap: 12px; margin-bottom: 15px; text-align: left; }
.time-input-field { display: flex; flex-direction: column; }
.time-label { font-size: 0.75rem; color: #9370DB; margin-bottom: 3px; font-weight: 600; text-align: left; padding-left: 5px; }
.time-input { background-color: #F0F8FF; border: 2px solid #87CEEB; border-radius: 8px; padding: 10px; font-size: 1.1rem; color: #4B0082; text-align: center; cursor: pointer; caret-color: transparent; height: 45px; width: 100%; font-family: 'Fredoka', sans-serif; }
.time-input:focus { outline: none; border-color: #FF1493; background-color: #FFF; box-shadow: 0 0 8px rgba(255, 20, 147, 0.3); transform: scale(1.01); }
.time-input.error-input { border-color: #FF0000; background-color: #FFE4E1; animation: shake 0.3s; }
.time-input-name { background-color: #FFF; border-color: #FFD700; cursor: text; }
.time-btn { background: linear-gradient(to bottom, #FF69B4, #FF1493); color: white; border: none; padding: 12px; font-size: 1rem; border-radius: 25px; cursor: pointer; width: 100%; margin-top: 10px; font-family: 'Fredoka', sans-serif; font-weight: 600; box-shadow: 0 4px 0 #C71585; }
.time-btn:active { transform: translateY(4px); box-shadow: none; }
.time-hint { background-color: #E6E6FA; border: 2px dotted #9370DB; padding: 10px; border-radius: 10px; margin: 10px 0; font-size: 0.9rem; color: #4B0082; }
.time-options-grid { display: flex; flex-direction: column; gap: 8px; }
.time-opt-btn { background: linear-gradient(to bottom, #87CEEB, #00BFFF); box-shadow: 0 3px 0 #008B8B; color: white; border: none; padding: 12px; font-size: 0.95rem; border-radius: 12px; cursor: pointer; font-family: 'Fredoka', sans-serif; font-weight: 600; }
.time-opt-btn:nth-child(2) { background: linear-gradient(to bottom, #FFD700, #FFA500); box-shadow: 0 3px 0 #DAA520; color: #5D3FD3; }
.time-opt-btn:nth-child(3) { background: linear-gradient(to bottom, #98FB98, #32CD32); box-shadow: 0 3px 0 #228B22; }
.time-correct { background: #32CD32 !important; box-shadow: 0 3px 0 #228B22 !important; }
.time-wrong { background: #FF69B4 !important; box-shadow: 0 3px 0 #C71585 !important; opacity: 0.7; }
.time-score-board { margin-top: 10px; font-size: 1rem; color: #FF1493; background: #FFF; padding: 5px 15px; border-radius: 20px; display: inline-block; border: 2px solid #FFD700; font-weight: bold; }
.time-feedback { font-size: 0.85rem; margin: 8px 0; min-height: 30px; font-weight: bold; padding: 5px; border-radius: 8px; }
.time-final-score { font-size: 2.5rem; color: #FF1493; font-weight: bold; margin: 10px 0; }
.time-btn-sec { background: linear-gradient(to bottom, #DDA0DD, #9370DB); box-shadow: 0 4px 0 #6A5ACD; margin-top: 8px; color: white; border: none; padding: 10px; border-radius: 20px; font-family: 'Fredoka', sans-serif; font-weight: bold; width: 100%; font-size: 0.95rem; }
.time-lb-list { list-style: none; padding: 0; text-align: left; max-height: 150px; overflow-y: auto; border: 2px solid #E6E6FA; border-radius: 10px; margin: 10px 0; font-size: 0.85rem; }
.time-lb-item { background: #FFF0F5; margin: 4px; padding: 6px 10px; border-radius: 8px; display: flex; justify-content: space-between; font-weight: bold; color: #8A2BE2; }
.time-lb-item:nth-child(1) { background: #FFD700; color: #fff; text-shadow: 1px 1px 0 #DAA520; }
.time-lb-item:nth-child(2) { background: #C0C0C0; color: #fff; text-shadow: 1px 1px 0 #808080; }
.time-lb-item:nth-child(3) { background: #CD7F32; color: #fff; text-shadow: 1px 1px 0 #8B4513; }

/* Custom Keyboards */
.custom-keyboard {
    background: #f0f0f5;
    border-top: 3px solid #DDA0DD;
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    padding: 8px;
    box-sizing: border-box;
    box-shadow: 0 -5px 15px rgba(0,0,0,0.1);
    z-index: 3000;
    display: none;
}
.kb-row { display: flex; justify-content: center; gap: 4px; margin-bottom: 5px; flex-wrap: wrap; }
.kb-key {
    background: white; border: 1px solid #ccc; border-radius: 6px; padding: 8px 0;
    width: 11%; height: 40px; font-size: 1.1rem; font-weight: bold; color: #5D3FD3;
    cursor: pointer; display: flex; align-items: center; justify-content: center;
    user-select: none; box-shadow: 0 3px 0 #bbb; transition: transform 0.1s;
}
.kb-key:active { transform: translateY(3px); box-shadow: none; background: #eee; }
.kb-key.wide { width: 14%; }
.kb-key.space { width: 40%; font-size: 0.8rem; }
.kb-key.action { background: #FFD700; border-color: #DAA520; color: #5D3FD3; }
.kb-key.delete { background: #FF69B4; border-color: #C71585; color: white; width: 14%; }
.kb-key.done { background: #32CD32; border-color: #228B22; color: white; width: 20%; font-size: 0.9rem; }

@media (max-width: 600px) {
    h1 { font-size: 1.8rem; }
    .menu-grid { grid-template-columns: 1fr; }
    .choices-grid { grid-template-columns: 1fr; }
    .problem-display { font-size: 2.5rem; }
}
</style>
</head>
<body>

<!-- ECRAN START: ALEGE GENUL -->
<div id="startScreen">
    <h1 class="start-title">Cine e»ôti? ü§î</h1>
    <div class="gender-cards">
        <div class="gender-card girl-card" onclick="selectGender('girl')">
            <span class="gender-icon">üëßüèº</span>
            <span class="gender-title">FatƒÉ</span>
        </div>
        <div class="gender-card boy-card" onclick="selectGender('boy')">
            <span class="gender-icon">üë¶üèª</span>
            <span class="gender-title">BƒÉiat</span>
        </div>
    </div>
</div>

<!-- BUTON IE»òIRE GLOBAL -->
<button id="globalExitBtn" class="exit-btn" style="display:none;" onclick="exitToStart()">üö™ IE»òIRE</button>

<!-- MENIU PRINCIPAL -->
<div class="container" id="mainContainer" style="display:none;">
    <h1 id="mainTitle">Super Jocuri ‚ú®</h1>
    <div class="menu-grid">
        <!-- Joc Matematic -->
        <div class="big-card" onclick="openMathMenu()">
            <div class="big-card-icon" id="icon-math">üßÆ</div>
            <div class="big-card-title">Joc Matematic</div>
            <div class="big-card-desc">Calcule amuzante!</div>
        </div>
        <!-- Joc SƒÉrituri -->
        <div class="big-card" onclick="openJumpGame()">
            <div class="big-card-icon" id="icon-jump">ü¶ï</div>
            <div class="big-card-title">Aventura Eroului</div>
            <div class="big-card-desc">Sari peste obstacole!</div>
        </div>
        <!-- Joc Litere -->
        <div class="big-card" onclick="openLetterGame()">
            <div class="big-card-icon" id="icon-letter">‚úèÔ∏è</div>
            <div class="big-card-title">Litere Magice</div>
            <div class="big-card-desc">DeseneazƒÉ litere!</div>
        </div>
        <!-- Joc Traduceri -->
        <div class="big-card" onclick="openTranslationGame()">
            <div class="big-card-icon" id="icon-trans">ü¶Ñ</div>
            <div class="big-card-title">Traduceri Magice</div>
            <div class="big-card-desc">√énva»õƒÉ limbi strƒÉine!</div>
        </div>
        <!-- Joc Timp -->
        <div class="big-card" onclick="openTimeGame()">
            <div class="big-card-icon" id="icon-time">‚è≥</div>
            <div class="big-card-title">Jocul Timpului</div>
            <div class="big-card-desc">5 Momente de Istorie!</div>
        </div>
    </div>
</div>

<!-- INTERFA»öA JOC MATEMATIC -->
<button class="back-btn" id="mathBackBtn" style="display: none;" onclick="showMainMenu()">‚Üê √énapoi</button>
<div class="container" id="mathContainer" style="display: none;">
    <div id="mathMainMenu"><h1>Alege Nivelul</h1><div class="sub-menu-grid" id="mathMenuGrid"></div><button class="btn btn-secondary" onclick="showMainMenu()" style="margin-top: 2rem;">√énapoi</button></div>
    <div id="mathSubMenu" style="display: none;"><h2 id="mathSubMenuTitle">ActivitƒÉ»õi:</h2><div class="sub-menu-grid" id="mathSubMenuGrid"></div><button class="btn btn-secondary" onclick="openMathMenu()" style="margin-top: 2rem;">√énapoi</button></div>
    <div id="mathGameArea" class="game-area">
        <div class="stats-bar"><span id="mathScoreDisplay">Scor: 100</span><span id="mathProgressDisplay">Ex: 1/10</span></div>
        <div class="timer-container"><div class="timer-bar" id="mathTimerBar"></div></div>
        <div id="mathGameContent"></div>
        <div id="mathChoicesContainer" class="choices-grid" style="display: none;"></div>
        <div id="mathInputContainer" class="input-group" style="display: none;"><input type="number" id="mathAnswerInput" placeholder="?"><button class="btn btn-primary" onclick="checkMathAnswer()">VerificƒÉ</button></div>
        <div class="feedback" id="mathFeedbackText"></div>
        <button class="btn btn-secondary" onclick="openMathMenu()">Ie»ôire</button>
    </div>
    <div id="mathAwardScreen" class="game-area" style="display:none; flex-direction:column; align-items:center;"><div style="font-size:4rem;" id="mathAwardIcon">üèÜ</div><h2 id="mathAwardTitle">Bravo!</h2><div class="final-score" id="mathFinalScoreText" style="font-size:1.5rem; margin:10px 0; font-weight:bold;">Scor: 100</div><button class="btn btn-secondary" onclick="openMathMenu()">√énapoi</button></div>
</div>

<!-- INTERFA»öA JOC SƒÇRITURI -->
<div id="jumpGameContainer"><canvas id="jumpCanvas"></canvas><div id="jumpUI"><div>‚≠ê Scor: <span id="jumpScoreVal">0</span></div><div>üö© Sta»õia: <span id="jumpStationVal">0</span>/15</div></div><div id="jumpMenu"><h1>Alege Eroul</h1><div style="margin-bottom: 20px;"><button class="btn selected" id="jumpBtnGirl" onclick="setJumpChar('girl')" style="background:#EC407A;">üåü Fata</button><button class="btn" id="jumpBtnBoy" onclick="setJumpChar('boy')" style="background:#2196F3;">ü¶ï BƒÉiat</button></div><button class="btn" id="jumpStartBtn" onclick="startJumpGame()" style="background:#66BB6A; margin-top:30px;">START</button><button class="btn btn-secondary" onclick="closeJumpGame()" style="margin-top: 20px;">√énapoi</button></div><div id="jumpWinScreen"><h1 style="font-size: 40px;">VICTORIE! üèÜ</h1><button class="btn" onclick="closeJumpGame()" style="background:#fff; color:#2e7d32; margin-top:30px;">√énapoi</button></div></div>

<!-- INTERFA»öA JOC LITERE -->
<div id="letterGameContainer"><div class="letter-card-ui"><header class="letter-header"><h1>Jocul Literelor</h1><div class="letter-score">Stelu»õe: <span id="letterScore">0</span> ‚≠ê</div></header><div class="letter-play-area"><div class="letter-card-display" id="letterTargetCard"><span id="letterTargetChar">A</span></div><div class="letter-canvas-container"><canvas id="guideCanvas"></canvas><canvas id="drawCanvas"></canvas></div><button id="letterMainBtn" class="letter-action-btn" onclick="handleLetterAction()">VerificƒÉ!</button></div><div class="letter-feedback-overlay" id="letterFeedback"><div id="letterFeedbackText">Bravo!</div></div><button class="btn btn-secondary" onclick="closeLetterGame()" style="position:absolute; bottom:10px; left:10px;">Ie»ôire</button></div></div>

<!-- INTERFA»öA JOC TRADUCERI -->
<div id="translationGameContainer"><div class="trans-ui"><div class="trans-title">ü¶Ñ Jocul Cuvintelor ü¶Ñ</div><p style="color:#fff; margin-bottom:10px;">Pasul 1: Alege limba magicƒÉ!</p><div class="lang-buttons" id="lang-selection"><button class="trans-btn btn-en" onclick="selectTransLang('en')">EnglezƒÉ üá∫üá∏</button><button class="trans-btn btn-fr" onclick="selectTransLang('fr')">FrancezƒÉ üá´üá∑</button></div><div class="trans-area" id="trans-game-area"><div style="font-size: 1rem; color: #ffeaa7;">Cum se spune √Æn limba aleasƒÉ?</div><div class="word-card" id="rom-word">...</div><input type="text" class="trans-input" id="trans-user-input" placeholder="Scrie traducerea aici..." autocomplete="off"><button class="btn-check" id="trans-check-btn" onclick="verificaRaspunsTrans()">VERIFICƒÇ ‚ú®</button><div class="feedback-trans" id="trans-feedback-area"></div><button class="btn-next-trans" id="trans-next-btn" onclick="nextTransWord()">Alt Cuv√¢nt üåü</button></div><button class="btn btn-secondary" onclick="closeTranslationGame()" style="margin-top:20px; background:#d63031;">Ie»ôire</button></div></div>

<!-- INTERFA»öA JOC TIMP -->
<div id="timeGameContainer">
    <div class="time-ui">
        <!-- Buton Ie»ôire specific jocului Timp -->
        <button class="btn btn-secondary" onclick="closeTimeGame()" style="position:absolute; top:-50px; right:0; width:auto; padding:8px 15px; font-size:0.9rem;">üö™ IE»òIRE</button>
        
        <div id="time-game-screen">
            <h1 class="time-h1">‚ú® Jocul Timpului ‚ú®</h1>
            <div class="time-sub">5 Momente Istorie</div>
            <div style="font-size:0.8rem; color:#8A2BE2; font-weight:600;">√éntrebarea <span id="time-q-current">1</span>/5</div>
            <div class="time-progress-container"><div class="time-progress-bar" id="time-progress-bar"></div></div>
            <div style="font-size:0.85rem; color:#8A2BE2; font-weight:600; margin-top:10px;">Anul:</div>
            <div class="time-year-display" id="time-year-display">----</div>

            <div id="time-date-input-section">
                <p style="font-size: 0.8rem; color: #8A2BE2; margin: 8px 0;">üìù CompleteazƒÉ datele:</p>
                <div class="time-input-group">
                    <div class="time-input-field"><label class="time-label">üè∞ Mileniu</label><input type="text" class="time-input" id="time-millennium" readonly placeholder="?"><span style="font-size:0.65rem; color:#8A2BE2; display:block;" id="help-mill"></span></div>
                    <div class="time-input-field"><label class="time-label">üìÖ Secol</label><input type="text" class="time-input" id="time-century" readonly placeholder="?"><span style="font-size:0.65rem; color:#8A2BE2; display:block;" id="help-cent"></span></div>
                    <div class="time-input-field"><label class="time-label">üî¢ Deceniu</label><input type="text" class="time-input" id="time-decade" readonly placeholder="?"><span style="font-size:0.65rem; color:#8A2BE2; display:block;" id="help-dec"></span></div>
                    <div class="time-input-field"><label class="time-label">‚è≥ ErƒÉ</label><input type="text" class="time-input" id="time-era" readonly placeholder="?"><span style="font-size:0.65rem; color:#8A2BE2; display:block;" id="help-era"></span></div>
                </div>
                <div class="time-feedback" id="time-date-feedback"></div>
                <button class="time-btn" onclick="validateTimeDate()">VerificƒÉ üåü</button>
            </div>

            <div id="time-event-section" style="display:none;">
                <div class="time-hint" id="time-hint-text">üí° Indiciu...</div>
                <div style="margin-bottom: 10px; font-weight: bold; color: #FF1493; font-size: 1rem;">Evenimentul? ü§î</div>
                <div class="time-options-grid" id="time-options-container"></div>
                <button id="time-next-btn" class="time-btn" onclick="nextTimeQuestion()" style="background: linear-gradient(to bottom, #9370DB, #6A5ACD); margin-top: 15px; display:none;">UrmƒÉtoarea ‚û°Ô∏è</button>
            </div>
            <div class="time-score-board">‚≠ê Puncte: <span id="time-score">0</span></div>
        </div>

        <!-- Ecran Final Timp -->
        <div id="time-end-screen" style="display:none;">
            <h1 class="time-h1">üéâ Joc Terminat! üéâ</h1>
            <div>Punctaj tƒÉu:</div>
            <div class="time-final-score" id="time-final-score-display">0</div>
            <div id="time-save-score-section">
                <p style="font-size:0.9rem; margin:10px 0; color:#666;">Scrie numele pentru clasament:</p>
                <input type="text" class="time-input time-input-name" id="time-player-name" placeholder="Numele tƒÉu..." onclick="openTimeNameKeyboard()">
                <button class="time-btn" onclick="saveTimeScore()">SalveazƒÉ üíæ</button>
            </div>
            <button class="time-btn-sec" onclick="showTimeLeaderboard()">üèÜ Clasament</button>
            <button class="time-btn-sec" onclick="restartTimeGame()" style="background: linear-gradient(to bottom, #98FB98, #32CD32); box-shadow: 0 4px 0 #228B22;">JoacƒÉ Din Nou üîÑ</button>
            <div id="time-leaderboard-view" style="display:none; margin-top: 15px;">
                <h3 style="font-size:1.1rem; margin:5px 0;">Top C√¢»ôtigƒÉtori ü•á</h3>
                <ul class="time-lb-list" id="time-leaderboard-list"></ul>
                <button class="time-btn-sec" onclick="hideTimeLeaderboard()">√énchide Clasament</button>
            </div>
        </div>
    </div>
</div>

<!-- TASTATURA DATE (Romane + √Æ, d, h, r) -->
<div class="custom-keyboard" id="timeDateKeyboard">
    <div class="kb-row">
        <div class="kb-key" onclick="typeTimeChar('I')">I</div>
        <div class="kb-key" onclick="typeTimeChar('V')">V</div>
        <div class="kb-key" onclick="typeTimeChar('X')">X</div>
        <div class="kb-key" onclick="typeTimeChar('L')">L</div>
        <div class="kb-key" onclick="typeTimeChar('C')">C</div>
        <div class="kb-key" onclick="typeTimeChar('D')">D</div>
        <div class="kb-key" onclick="typeTimeChar('M')">M</div>
    </div>
    <div class="kb-row">
        <div class="kb-key" onclick="typeTimeChar('√Æ')">√Æ</div>
        <div class="kb-key" onclick="typeTimeChar('d')">d</div>
        <div class="kb-key" onclick="typeTimeChar('h')">h</div>
        <div class="kb-key" onclick="typeTimeChar('r')">r</div>
        <div class="kb-key" onclick="typeTimeChar('.')">.</div>
        <div class="kb-key" onclick="typeTimeChar('-')">-</div>
        <div class="kb-key delete" onclick="deleteTimeChar()">‚å´</div>
    </div>
    <div class="kb-row"><div class="kb-key done" onclick="closeTimeKeyboard()">Gata ‚úì</div></div>
</div>

<!-- TASTATURA NUME (Alfabet complet) -->
<div class="custom-keyboard" id="timeNameKeyboard" style="display:none;">
    <div class="kb-row">
        <div class="kb-key" onclick="typeNameChar('A')">A</div><div class="kb-key" onclick="typeNameChar('ƒÇ')">ƒÇ</div><div class="kb-key" onclick="typeNameChar('√Ç')">√Ç</div><div class="kb-key" onclick="typeNameChar('B')">B</div><div class="kb-key" onclick="typeNameChar('C')">C</div><div class="kb-key" onclick="typeNameChar('D')">D</div><div class="kb-key" onclick="typeNameChar('E')">E</div>
    </div>
    <div class="kb-row">
        <div class="kb-key" onclick="typeNameChar('F')">F</div><div class="kb-key" onclick="typeNameChar('G')">G</div><div class="kb-key" onclick="typeNameChar('H')">H</div><div class="kb-key" onclick="typeNameChar('I')">I</div><div class="kb-key" onclick="typeNameChar('√é')">√é</div><div class="kb-key" onclick="typeNameChar('J')">J</div><div class="kb-key" onclick="typeNameChar('K')">K</div>
    </div>
    <div class="kb-row">
        <div class="kb-key" onclick="typeNameChar('L')">L</div><div class="kb-key" onclick="typeNameChar('M')">M</div><div class="kb-key" onclick="typeNameChar('N')">N</div><div class="kb-key" onclick="typeNameChar('O')">O</div><div class="kb-key" onclick="typeNameChar('P')">P</div><div class="kb-key" onclick="typeNameChar('Q')">Q</div><div class="kb-key" onclick="typeNameChar('R')">R</div>
    </div>
    <div class="kb-row">
        <div class="kb-key" onclick="typeNameChar('S')">S</div><div class="kb-key" onclick="typeNameChar('»ò')">»ò</div><div class="kb-key" onclick="typeNameChar('T')">T</div><div class="kb-key" onclick="typeNameChar('»ö')">»ö</div><div class="kb-key" onclick="typeNameChar('U')">U</div><div class="kb-key" onclick="typeNameChar('V')">V</div><div class="kb-key" onclick="typeNameChar('W')">W</div>
    </div>
    <div class="kb-row">
        <div class="kb-key" onclick="typeNameChar('X')">X</div><div class="kb-key" onclick="typeNameChar('Y')">Y</div><div class="kb-key" onclick="typeNameChar('Z')">Z</div><div class="kb-key space" onclick="typeNameChar(' ')">Spa»õiu</div><div class="kb-key delete" onclick="deleteNameChar()">‚å´</div>
    </div>
    <div class="kb-row"><div class="kb-key done" onclick="closeNameKeyboard()">Gata ‚úì</div></div>
</div>

<script>
// ==========================================
// LOGICA DE START & TEME
// ==========================================
let currentGender = '';

function selectGender(gender) {
    currentGender = gender;
    document.getElementById('startScreen').style.display = 'none';
    document.getElementById('mainContainer').style.display = 'block';
    document.getElementById('globalExitBtn').style.display = 'flex';

    if (gender === 'girl') {
        document.body.classList.remove('boy-theme');
        document.documentElement.style.setProperty('--primary-color', '#EC407A');
        document.documentElement.style.setProperty('--secondary-color', '#F48FB1');
        document.documentElement.style.setProperty('--accent-color', '#AB47BC');
        document.documentElement.style.setProperty('--text-color', '#880E4F');
        document.getElementById('mainTitle').innerHTML = "Super Jocuri ü¶Ñ‚ú®";
        document.getElementById('icon-math').innerText = "üßö‚Äç‚ôÄÔ∏è";
        document.getElementById('icon-jump').innerText = "ü¶Ñ";
        document.getElementById('icon-letter').innerText = "üé®";
        document.getElementById('icon-trans').innerText = "ü¶ã";
        document.getElementById('icon-time').innerText = "üëë";
    } else {
        document.body.classList.add('boy-theme');
        document.documentElement.style.setProperty('--primary-color', '#2196F3');
        document.documentElement.style.setProperty('--secondary-color', '#4FC3F7');
        document.documentElement.style.setProperty('--accent-color', '#4CAF50');
        document.documentElement.style.setProperty('--text-color', '#0D47A1');
        document.getElementById('mainTitle').innerHTML = "Super Jocuri üöó‚öΩ";
        document.getElementById('icon-math').innerText = "üöÇ";
        document.getElementById('icon-jump').innerText = "ü¶ñ";
        document.getElementById('icon-letter').innerText = "üöí";
        document.getElementById('icon-trans').innerText = "üöÄ";
        document.getElementById('icon-time').innerText = "üöÅ";
    }
    initMath();
}

// Func»õia care reparƒÉ problema: duce utilizatorul √Ænapoi la start
function exitToStart() {
    if(confirm("Vrei sƒÉ ie»ôi din joc »ôi sƒÉ alegi din nou FatƒÉ/BƒÉiat?")) {
        location.reload(); // Re√ÆncarcƒÉ pagina pentru a reveni la ecranul de start
    }
}

function showMainMenu() {
    document.getElementById('mainContainer').style.display = 'block';
    document.getElementById('mathContainer').style.display = 'none';
    document.getElementById('mathBackBtn').style.display = 'none';
    closeJumpGame(); closeLetterGame(); closeTranslationGame(); closeTimeGame();
}

// ==========================================
// LOGICA JOC MATEMATIC (ScurtatƒÉ)
// ==========================================
let mathCurrentMode = '', mathScore = 100, mathCurrentAnswer = 0, mathQuestionCount = 0, isMathGameEnding = false;
const MAX_QUESTIONS = 10;
const mathMenus = {
    'kg': { title: 'Micu»õii', items: [{ id: 'kg_add', icon: '‚öΩ', title: 'AdunƒÉri', desc: 'Simple' }] },
    'easy': { title: '»òcolari', items: [{ id: 'easy_math', icon: 'ü¶Ñ', title: 'Calcule', desc: 'AdunƒÉri/ScƒÉderi' }] },
    'hard': { title: 'Genii', items: [{ id: 'hard_pow', icon: '‚ö°', title: 'Puteri', desc: 'Avansat' }] }
};

function initMath() { renderMathMainMenu(); document.getElementById('mathAnswerInput').addEventListener("keypress", function(event) { if (event.key === "Enter") checkMathAnswer(); }); }

function openMathMenu() {
    document.getElementById('mainContainer').style.display = 'none';
    document.getElementById('mathContainer').style.display = 'block';
    document.getElementById('mathBackBtn').style.display = 'flex';
    document.getElementById('mathMainMenu').style.display = 'block';
    document.getElementById('mathSubMenu').style.display = 'none';
    document.getElementById('mathGameArea').style.display = 'none';
    document.getElementById('mathAwardScreen').style.display = 'none';
    renderMathMainMenu();
}

function renderMathMainMenu() {
    const grid = document.getElementById('mathMenuGrid'); grid.innerHTML = '';
    Object.keys(mathMenus).forEach(key => {
        const menuData = mathMenus[key];
        const card = document.createElement('div'); card.className = 'card';
        let icon = menuData.items[0].icon;
        if(currentGender === 'boy' && key === 'kg') icon = 'üöó';
        if(currentGender === 'girl' && key === 'kg') icon = 'üç≠';
        card.innerHTML = `<div class="card-icon">${icon}</div><div class="card-title">${menuData.title}</div><div class="card-desc">${menuData.items[0].desc}</div>`;
        card.onclick = () => startMathGame(menuData.items[0].id);
        grid.appendChild(card);
    });
}

function startMathGame(mode) {
    mathCurrentMode = mode; mathScore = 100; mathQuestionCount = 0; isMathGameEnding = false;
    document.getElementById('mathMainMenu').style.display = 'none';
    document.getElementById('mathSubMenu').style.display = 'none';
    document.getElementById('mathGameArea').style.display = 'block';
    nextMathProblem();
}

function nextMathProblem() {
    if (mathQuestionCount >= MAX_QUESTIONS) { endMathGame(); return; }
    mathQuestionCount++;
    document.getElementById('mathScoreDisplay').textContent = `Scor: ${mathScore}`;
    document.getElementById('mathProgressDisplay').textContent = `Ex: ${mathQuestionCount}/${MAX_QUESTIONS}`;
    document.getElementById('mathAnswerInput').value = '';
    document.getElementById('mathFeedbackText').textContent = '';
    document.getElementById('mathGameContent').innerHTML = '';
    const n1 = Math.floor(Math.random() * 10) + 1, n2 = Math.floor(Math.random() * 10) + 1;
    mathCurrentAnswer = n1 + n2;
    let icon = currentGender === 'boy' ? 'üöó' : 'üç¨';
    document.getElementById('mathGameContent').innerHTML = `<div style="font-size:3rem; margin:10px;">${icon} ${n1} + ${icon} ${n2} = ?</div><div class="problem-display">${n1} + ${n2} = ?</div>`;
    document.getElementById('mathInputContainer').style.display = 'flex';
    document.getElementById('mathAnswerInput').focus();
}

function checkMathAnswer() {
    const userVal = parseFloat(document.getElementById('mathAnswerInput').value);
    if (isNaN(userVal)) return;
    if (userVal === mathCurrentAnswer) {
        document.getElementById('mathFeedbackText').textContent = "Bravo! Corect! üéâ";
        document.getElementById('mathFeedbackText').className = "feedback correct";
        setTimeout(nextMathProblem, 1000);
    } else {
        mathScore -= 5;
        document.getElementById('mathScoreDisplay').textContent = `Scor: ${mathScore}`;
        document.getElementById('mathFeedbackText').textContent = "Gre»ôit! Mai √ÆncearcƒÉ.";
        document.getElementById('mathFeedbackText').className = "feedback wrong";
        setTimeout(nextMathProblem, 1500);
    }
}

function endMathGame() {
    document.getElementById('mathGameArea').style.display = 'none';
    document.getElementById('mathAwardScreen').style.display = 'flex';
    document.getElementById('mathFinalScoreText').textContent = `Scor Final: ${mathScore}`;
}

// ==========================================
// LOGICA JOC SƒÇRITURI (ScurtatƒÉ)
// ==========================================
const jumpCanvas = document.getElementById('jumpCanvas'), jumpCtx = jumpCanvas.getContext('2d');
let jumpGameRunning = false, jumpScore = 0, jumpStation = 0, jumpFrame = 0, jumpSpeed = 6, jumpCharType = 'girl';
const jumpGravity = 0.5, jumpPower = -20, jumpGroundH = 100;
const jumpPlayer = { x: 100, y: 0, size: 80, dy: 0, grounded: false };
let jumpObstacles = [];
function openJumpGame() {
    document.getElementById('mainContainer').style.display = 'none';
    document.getElementById('jumpGameContainer').style.display = 'block';
    resizeJumpCanvas();
    document.getElementById('jumpMenu').style.display = 'flex';
    document.getElementById('jumpWinScreen').style.display = 'none';
    setJumpChar(currentGender);
}
function closeJumpGame() { jumpGameRunning = false; document.getElementById('jumpGameContainer').style.display = 'none'; showMainMenu(); }
function resizeJumpCanvas() {
    jumpCanvas.width = window.innerWidth; jumpCanvas.height = window.innerHeight;
    if(!jumpGameRunning) { jumpPlayer.y = jumpCanvas.height - jumpGroundH - jumpPlayer.size; jumpPlayer.x = jumpCanvas.width * 0.15; drawJump(); }
}
window.setJumpChar = function(type) {
    jumpCharType = type;
    document.getElementById('jumpBtnGirl').classList.toggle('selected', type === 'girl');
    document.getElementById('jumpBtnBoy').classList.toggle('selected', type === 'boy');
};
window.startJumpGame = function() {
    document.getElementById('jumpMenu').style.display = 'none';
    jumpGameRunning = true; jumpScore = 0; jumpStation = 0; jumpSpeed = 6; jumpFrame = 0; jumpObstacles = [];
    jumpPlayer.y = jumpCanvas.height - jumpGroundH - jumpPlayer.size; jumpPlayer.dy = 0;
    updateJumpUI(); jumpLoop();
};
function jumpDoJump() { if (!jumpGameRunning) return; if (jumpPlayer.grounded || jumpPlayer.y > jumpCanvas.height - jumpGroundH - jumpPlayer.size - 10) { jumpPlayer.dy = jumpPower; jumpPlayer.grounded = false; } }
function updateJumpUI() { document.getElementById('jumpScoreVal').innerText = jumpScore; document.getElementById('jumpStationVal').innerText = Math.min(jumpStation, 15); }
function jumpLoop() { if (!jumpGameRunning) return; requestAnimationFrame(jumpLoop); jumpFrame++; updateJump(); drawJump(); }
function updateJump() {
    jumpPlayer.dy += jumpGravity; jumpPlayer.y += jumpPlayer.dy;
    if (jumpPlayer.y + jumpPlayer.size > jumpCanvas.height - jumpGroundH) { jumpPlayer.y = jumpCanvas.height - jumpGroundH - jumpPlayer.size; jumpPlayer.dy = 0; jumpPlayer.grounded = true; }
    if (jumpFrame % Math.floor(1000 / jumpSpeed) === 0) { let oh = 40 + Math.random() * 40; jumpObstacles.push({ x: jumpCanvas.width, y: jumpCanvas.height - jumpGroundH - oh, w: 40, h: oh, passed: false }); }
    for (let i = 0; i < jumpObstacles.length; i++) {
        let o = jumpObstacles[i]; o.x -= jumpSpeed;
        if (jumpPlayer.x < o.x + o.w && jumpPlayer.x + jumpPlayer.size > o.x && jumpPlayer.y < o.y + o.h && jumpPlayer.y + jumpPlayer.size > o.y) { jumpGameRunning = false; document.getElementById('jumpMenu').style.display = 'flex'; document.querySelector('#jumpMenu h1').innerText = "Joc Terminat! Scor: " + jumpScore; return; }
        if (o.x + o.w < jumpPlayer.x && !o.passed) { jumpScore++; if (jumpScore % 5 === 0) { jumpStation++; jumpSpeed += 0.5; if (jumpStation >= 15) { jumpGameRunning = false; document.getElementById('jumpWinScreen').style.display = 'flex'; } } updateJumpUI(); o.passed = true; }
    }
    if (jumpObstacles.length > 0 && jumpObstacles[0].x < -50) jumpObstacles.shift();
}
function drawJump() {
    let bgColor = currentGender === 'boy' ? ['#4facfe', '#00f2fe'] : ['#ff9a9e', '#fecfef'];
    let groundColor = currentGender === 'boy' ? '#4CAF50' : '#EC407A';
    let grad = jumpCtx.createLinearGradient(0, 0, 0, jumpCanvas.height);
    grad.addColorStop(0, bgColor[0]); grad.addColorStop(1, bgColor[1]);
    jumpCtx.fillStyle = grad; jumpCtx.fillRect(0, 0, jumpCanvas.width, jumpCanvas.height);
    jumpCtx.fillStyle = groundColor; jumpCtx.fillRect(0, jumpCanvas.height - jumpGroundH, jumpCanvas.width, jumpGroundH);
    jumpCtx.fillStyle = "#fff";
    jumpObstacles.forEach(o => {
        let shape = currentGender === 'boy' ? 'üåµ' : 'üçÑ';
        jumpCtx.font = "40px Arial"; jumpCtx.fillText(shape, o.x, o.y + o.h);
    });
    jumpCtx.save(); jumpCtx.translate(jumpPlayer.x + jumpPlayer.size/2, jumpPlayer.y + jumpPlayer.size/2);
    jumpCtx.font = jumpPlayer.size + "px Arial"; jumpCtx.textAlign = "center"; jumpCtx.textBaseline = "middle";
    let char = jumpCharType === 'girl' ? 'üßö‚Äç‚ôÄÔ∏è' : 'ü¶ñ';
    jumpCtx.fillText(char, 0, 0); jumpCtx.restore();
}
window.addEventListener('pointerdown', function(e) { if(e.target.tagName !== 'BUTTON') jumpDoJump(); });
window.addEventListener('keydown', function(e) { if ((e.code === 'Space' || e.code === 'ArrowUp') && jumpGameRunning) jumpDoJump(); });

// ==========================================
// LOGICA JOC LITERE (ScurtatƒÉ)
// ==========================================
const letterAllChars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
let letterCurrentChar = '', letterScore = 0, letterIsLevelComplete = false, letterHasDrawnSomething = false;
const letterDrawCanvas = document.getElementById('drawCanvas'), letterDrawCtx = letterDrawCanvas.getContext('2d');
const letterGuideCanvas = document.getElementById('guideCanvas'), letterGuideCtx = letterGuideCanvas.getContext('2d');
function openLetterGame() {
    document.getElementById('mainContainer').style.display = 'none';
    document.getElementById('letterGameContainer').style.display = 'block';
    initLetterGame();
}
function closeLetterGame() { document.getElementById('letterGameContainer').style.display = 'none'; showMainMenu(); }
function initLetterGame() { resizeLetterCanvases(); setupLetterDrawing(); nextLetterLevel(); }
function resizeLetterCanvases() {
    const container = letterDrawCanvas.parentElement;
    [letterDrawCanvas, letterGuideCanvas].forEach(c => { c.width = container.clientWidth; c.height = container.clientHeight; });
    letterDrawCtx.lineCap = 'round'; letterDrawCtx.lineJoin = 'round';
    letterDrawCtx.lineWidth = Math.max(10, container.clientWidth / 20);
    letterDrawCtx.strokeStyle = currentGender === 'boy' ? '#2196F3' : '#EC407A';
    if(letterCurrentChar) drawLetterGuide();
}
function drawLetterGuide() {
    letterGuideCtx.clearRect(0, 0, letterGuideCanvas.width, letterGuideCanvas.height);
    letterGuideCtx.fillStyle = '#E0E0E0';
    letterGuideCtx.font = `bold ${letterGuideCanvas.height * 0.8}px 'Fredoka One'`;
    letterGuideCtx.textAlign = 'center'; letterGuideCtx.textBaseline = 'middle';
    letterGuideCtx.fillText(letterCurrentChar, letterGuideCanvas.width / 2, letterGuideCanvas.height / 2);
}
function setupLetterDrawing() {
    let letterIsDrawing = false;
    function getPos(e) { const rect = letterDrawCanvas.getBoundingClientRect(); const clientX = e.touches ? e.touches[0].clientX : e.clientX; const clientY = e.touches ? e.touches[0].clientY : e.clientY; return { x: clientX - rect.left, y: clientY - rect.top }; }
    function startDraw(e) { if (letterIsLevelComplete) return; letterIsDrawing = true; letterHasDrawnSomething = true; const pos = getPos(e); letterDrawCtx.beginPath(); letterDrawCtx.moveTo(pos.x, pos.y); if(e.cancelable) e.preventDefault(); }
    function draw(e) { if (!letterIsDrawing || letterIsLevelComplete) return; const pos = getPos(e); letterDrawCtx.lineTo(pos.x, pos.y); letterDrawCtx.stroke(); if(e.cancelable) e.preventDefault(); }
    function stopDraw() { letterIsDrawing = false; letterDrawCtx.closePath(); }
    letterDrawCanvas.addEventListener('mousedown', startDraw); letterDrawCanvas.addEventListener('mousemove', draw); letterDrawCanvas.addEventListener('mouseup', stopDraw);
    letterDrawCanvas.addEventListener('touchstart', startDraw, { passive: false }); letterDrawCanvas.addEventListener('touchmove', draw, { passive: false }); letterDrawCanvas.addEventListener('touchend', stopDraw);
}
function nextLetterLevel() {
    letterIsLevelComplete = false; letterHasDrawnSomething = false;
    letterCurrentChar = letterAllChars.charAt(Math.floor(Math.random() * letterAllChars.length));
    document.getElementById('letterTargetChar').textContent = letterCurrentChar;
    letterDrawCtx.clearRect(0, 0, letterDrawCanvas.width, letterDrawCanvas.height);
    drawLetterGuide();
    document.getElementById('letterMainBtn').textContent = "VerificƒÉ!";
    document.getElementById('letterMainBtn').onclick = handleLetterCheck;
    document.getElementById('letterFeedback').classList.remove('show');
}
function handleLetterAction() { if(letterIsLevelComplete) nextLetterLevel(); }
function handleLetterCheck() {
    if (!letterHasDrawnSomething) { showLetterFeedback("DeseneazƒÉ ceva!", "fail"); return; }
    winLetterLevel();
}
function winLetterLevel() {
    letterIsLevelComplete = true; letterScore += 1;
    document.getElementById('letterScore').textContent = letterScore;
    showLetterFeedback("Bravo!", "success");
    document.getElementById('letterMainBtn').textContent = "UrmƒÉtoarea ‚û°Ô∏è";
    document.getElementById('letterMainBtn').onclick = nextLetterLevel;
}
function showLetterFeedback(text, type) {
    document.getElementById('letterFeedbackText').textContent = text;
    document.getElementById('letterFeedback').classList.add('show');
    setTimeout(() => document.getElementById('letterFeedback').classList.remove('show'), 1500);
}
window.addEventListener('resize', () => { if(document.getElementById('letterGameContainer').style.display === 'block') resizeLetterCanvases(); });

// ==========================================
// LOGICA JOC TRADUCERI
// ==========================================
const transDictionary = [{ ro: "PisicƒÉ", en: "Cat", fr: "Chat" }, { ro: "C√¢ine", en: "Dog", fr: "Chien" }, { ro: "Floare", en: "Flower", fr: "Fleur" }, { ro: "Soare", en: "Sun", fr: "Soleil" }, { ro: "LunƒÉ", en: "Moon", fr: "Lune" }, { ro: "ColindƒÉ", en: "Carol", fr: "No√´l" }, { ro: "Steaua", en: "Star", fr: "√âtoile" }];
let currentTransLang = '', currentTransWordObj = null;
function openTranslationGame() {
    document.getElementById('mainContainer').style.display = 'none';
    document.getElementById('translationGameContainer').style.display = 'block';
    document.getElementById('lang-selection').style.display = 'flex';
    document.getElementById('trans-game-area').style.display = 'none';
    currentTransLang = '';
}
function closeTranslationGame() { document.getElementById('translationGameContainer').style.display = 'none'; showMainMenu(); }
function selectTransLang(lang) {
    currentTransLang = lang;
    document.querySelector('.btn-en').classList.toggle('selected', lang==='en');
    document.querySelector('.btn-fr').classList.toggle('selected', lang==='fr');
    document.getElementById('lang-selection').style.display = 'none';
    document.getElementById('trans-game-area').style.display = 'flex';
    nextTransWord();
}
function nextTransWord() {
    const input = document.getElementById('trans-user-input');
    input.value = ''; input.disabled = false; input.classList.remove('shake');
    document.getElementById('trans-feedback-area').innerHTML = '';
    document.getElementById('trans-next-btn').style.display = 'none';
    document.getElementById('trans-check-btn').style.display = 'block';
    currentTransWordObj = transDictionary[Math.floor(Math.random() * transDictionary.length)];
    document.getElementById('rom-word').innerText = currentTransWordObj.ro;
}
function verificaRaspunsTrans() {
    const input = document.getElementById('trans-user-input');
    const val = input.value.trim().toLowerCase();
    if(!val) return;
    const correct = currentTransLang === 'en' ? currentTransWordObj.en : currentTransWordObj.fr;
    const normalize = (str) => str.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
    if(normalize(val) === normalize(correct.toLowerCase())) {
        input.disabled = true;
        document.getElementById('trans-check-btn').style.display = 'none';
        document.getElementById('trans-next-btn').style.display = 'block';
        document.getElementById('trans-feedback-area').innerHTML = `<div class="magic-square">‚òÖ</div><div style="color:#ffeaa7; margin-top:10px;">Bravo!</div>`;
    } else {
        input.classList.add('shake');
        setTimeout(()=>input.classList.remove('shake'), 500);
    }
}
document.getElementById('trans-user-input').addEventListener("keypress", (e) => { if(e.key==="Enter") verificaRaspunsTrans(); });
document.getElementById('trans-next-btn').addEventListener("click", nextTransWord);

// ==========================================
// LOGICA JOC TIMP
// ==========================================
const timeBaseData = [
    { year: 1918, mill: ["II", "2"], cent: ["XX", "20"], dec: ["al 2-lea", "2", "al 2lea", "II"], era: ["d.Hr", "dh"], hint: "üá∑üá¥ Rom√¢nia devine mare!", correct: "Marea Unire", options: ["Marea Unire", "Independen»õa", "Republica"] },
    { year: 1453, mill: ["II", "2"], cent: ["XV", "15"], dec: ["al 6-lea", "6", "VI"], era: ["d.Hr", "dh"], hint: "üè∞ CƒÉderea unui ora»ô legendar.", correct: "Constantinopol", options: ["Roma", "Constantinopol", "Athens"] },
    { year: 1492, mill: ["II", "2"], cent: ["XV", "15"], dec: ["al 9-lea", "9", "IX"], era: ["d.Hr", "dh"], hint: "‚õµ Cristofor Columb ajunge √Æn America.", correct: "America", options: ["Asia", "America", "Africa"] },
    { year: 1789, mill: ["II", "2"], cent: ["XVIII", "18"], dec: ["al 9-lea", "9", "IX"], era: ["d.Hr", "dh"], hint: "üá´üá∑ Libertate, Egalitate, Fraternitate.", correct: "Revolu»õia FrancezƒÉ", options: ["Revolu»õia IndustrialƒÉ", "Revolu»õia FrancezƒÉ", "RƒÉzboiul"] },
    { year: 1969, mill: ["II", "2"], cent: ["XX", "20"], dec: ["al 7-lea", "7", "VII"], era: ["d.Hr", "dh"], hint: "üöÄ Omul pe LunƒÉ.", correct: "Aselenizarea", options: ["Satelitul", "Aselenizarea", "Racheta"] }
];

let timeQuestions = [], timeCurrentIndex = 0, timeScore = 0, timeActiveInput = null;

function openTimeGame() {
    document.getElementById('mainContainer').style.display = 'none';
    document.getElementById('timeGameContainer').style.display = 'block';
    initTimeGame();
}

function closeTimeGame() {
    document.getElementById('timeGameContainer').style.display = 'none';
    closeTimeKeyboard(); closeNameKeyboard();
    showMainMenu();
}

function initTimeGame() {
    timeQuestions = [...timeBaseData].sort(() => Math.random() - 0.5).slice(0, 5);
    timeCurrentIndex = 0; timeScore = 0;
    document.getElementById('time-game-screen').style.display = 'block';
    document.getElementById('time-end-screen').style.display = 'none';
    loadTimeQuestion();
}

function loadTimeQuestion() {
    document.getElementById('time-event-section').style.display = 'none';
    document.getElementById('time-date-input-section').style.display = 'block';
    document.getElementById('time-next-btn').style.display = 'none';
    resetTimeInputs();
    const data = timeQuestions[timeCurrentIndex];
    document.getElementById('time-year-display').textContent = data.year;
    document.getElementById('time-q-current').textContent = timeCurrentIndex + 1;
    document.getElementById('help-mill').textContent = "ex: " + data.mill[0];
    document.getElementById('help-cent').textContent = "ex: " + data.cent[0];
    document.getElementById('help-dec').textContent = "ex: " + data.dec[0];
    document.getElementById('help-era').textContent = "ex: " + data.era[0];
    document.getElementById('time-progress-bar').style.width = ((timeCurrentIndex) / 5) * 100 + "%";
}

function resetTimeInputs() {
    ['time-millennium', 'time-century', 'time-decade', 'time-era'].forEach(id => {
        const el = document.getElementById(id);
        el.value = ""; el.classList.remove('error-input'); el.disabled = false;
        el.onclick = function() { openTimeKeyboard(this); };
    });
    const fb = document.getElementById('time-date-feedback');
    fb.textContent = ""; fb.style.color = "#5D3FD3"; fb.style.backgroundColor = "transparent";
}

// Tastaturi Timp
function openTimeKeyboard(inputElement) {
    timeActiveInput = inputElement;
    document.getElementById('timeDateKeyboard').style.display = 'block';
    document.getElementById('timeNameKeyboard').style.display = 'none';
    inputElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
}
function closeTimeKeyboard() { document.getElementById('timeDateKeyboard').style.display = 'none'; timeActiveInput = null; }
function typeTimeChar(char) { if (timeActiveInput) timeActiveInput.value += char; }
function deleteTimeChar() { if (timeActiveInput) timeActiveInput.value = timeActiveInput.value.slice(0, -1); }

function openTimeNameKeyboard() {
    document.getElementById('timeNameKeyboard').style.display = 'block';
    document.getElementById('timeDateKeyboard').style.display = 'none';
    document.getElementById('time-player-name').scrollIntoView({ behavior: 'smooth', block: 'center' });
}
function closeNameKeyboard() { document.getElementById('timeNameKeyboard').style.display = 'none'; }
function typeNameChar(char) { document.getElementById('time-player-name').value += char; }
function deleteNameChar() { document.getElementById('time-player-name').value = document.getElementById('time-player-name').value.slice(0, -1); }

// Logica Joc Timp
function normalizeText(text) { if (!text) return ""; return text.toString().trim().toLowerCase().replace(/[\s-]/g, ''); }
function isMatch(userInput, validOptions) {
    const normalizedUser = normalizeText(userInput);
    return validOptions.some(option => normalizeText(option) === normalizedUser);
}

function validateTimeDate() {
    const data = timeQuestions[timeCurrentIndex];
    const feedback = document.getElementById('time-date-feedback');
    const inputs = ['time-millennium', 'time-century', 'time-decade', 'time-era'];
    const keys = ['mill', 'cent', 'dec', 'era'];
    let hasError = false, errors = [];

    inputs.forEach((id, idx) => {
        const el = document.getElementById(id);
        if (!isMatch(el.value, data[keys[idx]])) {
            el.classList.add('error-input'); hasError = true; errors.push(el.previousElementSibling.innerText.split(' ')[1]);
        } else { el.classList.remove('error-input'); }
    });

    if (hasError) {
        feedback.style.color = "#DC143C"; feedback.style.backgroundColor = "#FFE4E1";
        feedback.innerHTML = "‚ùå VerificƒÉ: <b>" + errors.join(", ") + "</b>";
        return;
    }

    feedback.style.color = "#32CD13"; feedback.style.backgroundColor = "#E0FFE0";
    feedback.textContent = "‚úÖ Corect! Treci la eveniment...";
    timeScore += 20; updateTimeScore();
    closeTimeKeyboard();
    inputs.forEach(id => document.getElementById(id).disabled = true);

    setTimeout(() => {
        document.getElementById('time-date-input-section').style.display = 'none';
        showTimeEvent();
    }, 1000);
}

function showTimeEvent() {
    const data = timeQuestions[timeCurrentIndex];
    document.getElementById('time-hint-text').textContent = data.hint;
    const container = document.getElementById('time-options-container');
    container.innerHTML = '';
    let shuffled = [...data.options].sort(() => Math.random() - 0.5);
    shuffled.forEach(opt => {
        const btn = document.createElement('button');
        btn.textContent = opt; btn.classList.add('time-opt-btn');
        btn.onclick = function() { checkTimeAnswer(this, opt, data.correct); };
        container.appendChild(btn);
    });
    document.getElementById('time-event-section').style.display = 'block';
}

function checkTimeAnswer(btn, selected, correct) {
    document.querySelectorAll('#time-options-container button').forEach(b => b.disabled = true);
    if (selected === correct) {
        btn.classList.add('time-correct');
        timeScore += 20;
        document.getElementById('time-year-display').textContent = "üéâ BRAVO!";
    } else {
        btn.classList.add('time-wrong');
        timeScore -= 5;
        document.querySelectorAll('#time-options-container button').forEach(b => { if(b.textContent === correct) b.classList.add('time-correct'); });
        document.getElementById('time-year-display').textContent = "üòû Gre»ôit!";
    }
    updateTimeScore();
    document.getElementById('time-next-btn').style.display = 'block';
}

function updateTimeScore() { document.getElementById('time-score').textContent = timeScore; }
function nextTimeQuestion() {
    timeCurrentIndex++;
    if (timeCurrentIndex >= 5) endTimeGame();
    else loadTimeQuestion();
}

function endTimeGame() {
    document.getElementById('time-game-screen').style.display = 'none';
    document.getElementById('time-end-screen').style.display = 'block';
    document.getElementById('time-final-score-display').textContent = timeScore;
    document.getElementById('time-save-score-section').style.display = 'block';
    document.getElementById('time-leaderboard-view').style.display = 'none';
    closeTimeKeyboard(); closeNameKeyboard();
}

function saveTimeScore() {
    const name = document.getElementById('time-player-name').value.trim();
    if (!name) { alert("Te rog scrie un nume!"); return; }
    let lb = JSON.parse(localStorage.getItem('timeGameLeaderboard')) || [];
    lb.push({ name: name, score: timeScore });
    lb.sort((a, b) => b.score - a.score);
    lb = lb.slice(0, 10);
    localStorage.setItem('timeGameLeaderboard', JSON.stringify(lb));
    document.getElementById('time-save-score-section').style.display = 'none';
    showTimeLeaderboard();
}

function showTimeLeaderboard() {
    const list = document.getElementById('time-leaderboard-list');
    list.innerHTML = '';
    const lb = JSON.parse(localStorage.getItem('timeGameLeaderboard')) || [];
    if (lb.length === 0) list.innerHTML = '<li style="text-align:center; padding:10px;">Nu existƒÉ scoruri.</li>';
    else lb.forEach((e, i) => {
        const li = document.createElement('li'); li.className = 'time-lb-item';
        li.innerHTML = `<span>#${i+1} ${e.name}</span> <span>${e.score} pts</span>`;
        list.appendChild(li);
    });
    document.getElementById('time-leaderboard-view').style.display = 'block';
}
function hideTimeLeaderboard() { document.getElementById('time-leaderboard-view').style.display = 'none'; }
function restartTimeGame() { initTimeGame(); }

// Click outside closes keyboards
document.addEventListener('click', function(e) {
    const kb1 = document.getElementById('timeDateKeyboard'), kb2 = document.getElementById('timeNameKeyboard');
    if (!kb1.contains(e.target) && !kb2.contains(e.target) && !e.target.closest('.time-input')) {
        closeTimeKeyboard(); closeNameKeyboard();
    }
});

</script>
</body>
</html>

