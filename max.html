<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Super Jocuri Educa»õionale</title>
<link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;700&family=Comic+Sans+MS&display=swap" rel="stylesheet">
<style>
/* --- STILURI GENERALE & VARIABILE --- */
:root {
--boy-bg: #E3F2FD; --boy-primary: #2196F3; --boy-secondary: #4FC3F7; --boy-accent: #4CAF50;
--girl-bg: #FCE4EC; --girl-primary: #EC407A; --girl-secondary: #F48FB1; --girl-accent: #AB47BC;
--pro-bg: #263238; --pro-card: #37474F; --pro-text: #ECEFF1; --pro-accent: #00E5FF;
--text-color: #455A64; --card-bg: #FFFFFF; --success: #66BB6A; --error: #EF5350;
--timer-warning: #FF9800; --timer-danger: #F44336; --gold: #FFD700; --silver: #C0C0C0; --bronze: #CD7F32;
--letter-primary: #FF85A2; --letter-secondary: #A2D2FF; --letter-accent: #FFC8DD;
}
* { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Comic Sans MS', 'Chalkboard SE', sans-serif; user-select: none; -webkit-tap-highlight-color: transparent; }
body { background-color: var(--girl-bg); background-image: radial-gradient(#F8BBD0 15%, transparent 16%), radial-gradient(#F8BBD0 15%, transparent 16%); background-size: 60px 60px; background-position: 0 0, 30px 30px; color: var(--text-color); min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; overflow-x: hidden; transition: background 0.5s ease; }
body.boy-theme { background-color: var(--boy-bg); background-image: radial-gradient(#BBDEFB 15%, transparent 16%), radial-gradient(#BBDEFB 15%, transparent 16%); }
body.pro-theme { background-color: var(--pro-bg); background-image: radial-gradient(#455A64 15%, transparent 16%); color: var(--pro-text); }
.background-shapes { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; overflow: hidden; pointer-events: none; }
.shape { position: absolute; opacity: 0.4; animation: float 15s infinite linear; }
@keyframes float { 0% { transform: translateY(100vh) rotate(0deg); } 100% { transform: translateY(-100px) rotate(360deg); } }
/* --- MENIU PRINCIPAL --- */
.container { width: 90%; max-width: 900px; text-align: center; padding: 2rem; }
h1 { font-size: 3rem; margin-bottom: 2rem; color: var(--girl-primary); text-shadow: 2px 2px 0px #FFF; transition: color 0.5s; font-family: 'Fredoka One', cursive; }
body.boy-theme h1 { color: var(--boy-primary); text-shadow: none; }
body.pro-theme h1 { color: var(--pro-accent); text-shadow: 0 0 10px rgba(0, 229, 255, 0.5); }
.menu-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; width: 100%; margin-bottom: 2rem; }
.big-card { background: var(--card-bg); border-radius: 30px; padding: 2rem; cursor: pointer; transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1); box-shadow: 0 10px 0 rgba(0,0,0,0.1); border: 5px solid #FFF; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 220px; position: relative; }
body.pro-theme .big-card { background: var(--pro-card); color: var(--pro-text); border: 3px solid var(--pro-accent); }
.big-card:hover { transform: translateY(-10px) scale(1.02); box-shadow: 0 20px 0 rgba(0,0,0,0.1); }
.big-card-icon { font-size: 4.5rem; margin-bottom: 1rem; filter: drop-shadow(0 5px 5px rgba(0,0,0,0.2)); }
.big-card-title { font-weight: 900; font-size: 1.6rem; margin-bottom: 0.5rem; font-family: 'Fredoka One', cursive; }
body.pro-theme .big-card-title { color: var(--pro-text); }
body:not(.pro-theme) .big-card-title { color: var(--text-color); }
.big-card-desc { font-size: 1rem; line-height: 1.4; font-weight: 600; opacity: 0.8; }
/* --- STILURI JOC MATEMATIC --- */
.sub-menu-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; width: 100%; }
.card { background: var(--card-bg); border-radius: 25px; padding: 1.5rem; cursor: pointer; transition: all 0.3s; box-shadow: 0 8px 0 rgba(0,0,0,0.1); border: 4px solid #FFF; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 160px; }
body.pro-theme .card { background: var(--pro-card); color: var(--pro-text); border: 2px solid var(--pro-accent); }
.card:hover { transform: translateY(-8px); box-shadow: 0 15px 0 rgba(0,0,0,0.1); }
.card.kg-card { border-bottom: 6px solid var(--boy-accent); }
.card.easy-card { border-bottom: 6px solid var(--girl-secondary); }
.card.pro-card { border-bottom: 6px solid var(--pro-accent); }
.card-icon { font-size: 3rem; margin-bottom: 0.5rem; }
.card-title { font-weight: 900; font-size: 1.3rem; margin-bottom: 0.5rem; }
.card-desc { font-size: 0.9rem; line-height: 1.4; font-weight: 600; opacity: 0.8; }
.game-area { display: none; background: var(--card-bg); border-radius: 30px; padding: 2.5rem; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 100%; max-width: 600px; animation: popIn 0.5s; border: 5px solid var(--girl-secondary); transition: border-color 0.5s, background 0.5s, color 0.5s; }
body.boy-theme .game-area { border-color: var(--boy-secondary); }
body.pro-theme .game-area { border-color: var(--pro-accent); background: var(--pro-card); color: var(--pro-text); }
@keyframes popIn { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }
.stats-bar { display: flex; justify-content: space-between; margin-bottom: 1rem; font-size: 1.3rem; font-weight: 800; color: var(--girl-primary); background: #F8BBD0; padding: 10px 20px; border-radius: 50px; transition: all 0.5s; }
body.boy-theme .stats-bar { color: var(--boy-primary); background: #BBDEFB; }
body.pro-theme .stats-bar { color: var(--pro-bg); background: var(--pro-accent); }
.timer-container { width: 100%; height: 15px; background-color: #eee; border-radius: 10px; margin-bottom: 1.5rem; overflow: hidden; border: 2px solid #ddd; }
.timer-bar { height: 100%; width: 100%; background-color: var(--success); transition: width 1s linear, background-color 0.5s; }
.visual-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; margin: 20px 0; min-height: 80px; align-items: center; }
.ball { width: 45px; height: 45px; border-radius: 50%; box-shadow: inset -3px -3px 10px rgba(0,0,0,0.1), 3px 3px 5px rgba(0,0,0,0.15); animation: bounce 2s infinite ease-in-out; border: 2px solid rgba(255,255,255,0.3); }
@keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-12px); } }
.sequence-display { font-size: 3.5rem; font-weight: 900; letter-spacing: 5px; margin: 20px 0; }
body:not(.pro-theme) .sequence-display { color: var(--text-color); }
body.pro-theme .sequence-display { color: var(--pro-text); }
.missing-number { color: var(--girl-primary); border-bottom: 4px dashed var(--girl-primary); padding: 0 10px; }
body.boy-theme .missing-number { color: var(--boy-primary); border-bottom-color: var(--boy-primary); }
body.pro-theme .missing-number { color: var(--pro-accent); border-bottom-color: var(--pro-accent); }
.problem-display { font-size: 4rem; font-weight: 900; margin: 1rem 0; color: var(--girl-primary); transition: color 0.5s; }
body.boy-theme .problem-display { color: var(--boy-primary); }
body.pro-theme .problem-display { color: var(--pro-accent); }
.input-group { display: flex; gap: 1rem; justify-content: center; margin-bottom: 1.5rem; }
input[type="number"], input[type="text"] { width: 130px; padding: 0.8rem; font-size: 2.2rem; text-align: center; border: 3px solid var(--girl-secondary); border-radius: 20px; outline: none; transition: all 0.3s; font-family: inherit; background: #FFF; }
body.pro-theme input[type="number"], body.pro-theme input[type="text"] { border-color: var(--pro-accent); background: #263238; color: white; }
body:not(.pro-theme) input[type="number"] { color: var(--text-color); }
input[type="number"]:focus, input[type="text"]:focus { border-color: var(--girl-primary); transform: scale(1.05); }
body.boy-theme input[type="number"]:focus { border-color: var(--boy-primary); }
body.pro-theme input[type="number"]:focus { border-color: var(--pro-accent); }
input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
input[type=number] { -moz-appearance: textfield; }
.choices-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-top: 2rem; }
.choice-btn { background: white; border: 4px solid var(--boy-secondary); border-radius: 20px; padding: 1.5rem; font-size: 2rem; font-weight: 900; color: var(--boy-primary); cursor: pointer; transition: all 0.2s; box-shadow: 0 6px 0 #0277BD; font-family: inherit; }
.choice-btn:active { transform: translateY(6px); box-shadow: none; }
.choice-btn:hover { background: #E1F5FE; }
.btn { padding: 1rem 2rem; font-size: 1.3rem; border: none; border-radius: 50px; cursor: pointer; font-weight: 900; transition: all 0.2s; color: white; font-family: inherit; text-transform: uppercase; letter-spacing: 1px; box-shadow: 0 5px 0 rgba(0,0,0,0.1); }
.btn:active { transform: translateY(4px); box-shadow: none; }
.btn-primary { background-color: var(--girl-primary); box-shadow: 0 5px 0 #C2185B; transition: background 0.5s, box-shadow 0.5s; }
body.boy-theme .btn-primary { background-color: var(--boy-primary); box-shadow: 0 5px 0 #1565C0; }
body.pro-theme .btn-primary { background-color: var(--pro-accent); color: var(--pro-bg); box-shadow: 0 5px 0 #00B8D4; }
.btn-secondary { background-color: #B0BEC5; box-shadow: 0 5px 0 #78909C; margin-top: 1rem; font-size: 1rem; padding: 0.8rem 1.5rem; }
.feedback { height: 3rem; margin-top: 1rem; font-weight: 900; font-size: 1.3rem; line-height: 1.4; }
.feedback.correct { color: var(--success); }
.feedback.wrong { color: var(--error); }
.back-btn { position: absolute; top: 20px; left: 20px; background: white; border: none; padding: 10px 20px; border-radius: 50px; cursor: pointer; font-weight: 900; box-shadow: 0 4px 10px rgba(0,0,0,0.1); display: flex; align-items: center; gap: 8px; z-index: 10; font-family: inherit; color: var(--girl-primary); transition: all 0.5s; }
body.boy-theme .back-btn { color: var(--boy-primary); }
body.pro-theme .back-btn { color: var(--pro-bg); background: var(--pro-accent); }
.back-btn:hover { transform: scale(1.1); }
.award-container, .leaderboard-container { display: none; flex-direction: column; align-items: center; justify-content: center; animation: popIn 0.8s; background: white; padding: 2rem; border-radius: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); max-width: 500px; margin: 0 auto; }
.award-icon { font-size: 8rem; margin: 1rem 0; filter: drop-shadow(0 10px 10px rgba(0,0,0,0.2)); animation: float 3s infinite ease-in-out; }
.award-title { font-size: 3rem; font-weight: 900; margin-bottom: 1rem; text-transform: uppercase; }
.award-gold { color: var(--gold); text-shadow: 2px 2px 0 #B8860B; }
.award-silver { color: var(--silver); text-shadow: 2px 2px 0 #78909C; }
.award-bronze { color: var(--bronze); text-shadow: 2px 2px 0 #8D6E63; }
.award-mention { color: var(--boy-primary); text-shadow: 2px 2px 0 #1565C0; }
.award-try { color: var(--error); text-shadow: 2px 2px 0 #C62828; }
.final-score { font-size: 2rem; color: var(--text-color); margin-bottom: 1rem; font-weight: bold; }
.name-input-group { margin: 1.5rem 0; display: flex; flex-direction: column; gap: 10px; align-items: center; }
.name-input-group label { font-size: 1.2rem; font-weight: bold; color: var(--text-color); }
.name-input-group input { width: 100%; font-size: 1.5rem; padding: 0.5rem; }
.leaderboard-table { width: 100%; border-collapse: collapse; margin: 1rem 0; font-size: 1.1rem; }
.leaderboard-table th { background: var(--girl-primary); color: white; padding: 10px; border-radius: 10px 10px 0 0; }
body.pro-theme .leaderboard-table th { background: var(--pro-accent); color: var(--pro-bg); }
body.boy-theme .leaderboard-table th { background: var(--boy-primary); }
.leaderboard-table td { padding: 10px; border-bottom: 1px solid #eee; text-align: center; }
.leaderboard-table tr:nth-child(even) { background-color: #f9f9f9; }
.leaderboard-table tr:first-child td { font-weight: bold; color: var(--gold); }
.leaderboard-table tr:nth-child(2) td { font-weight: bold; color: var(--silver); }
.leaderboard-table tr:nth-child(3) td { font-weight: bold; color: var(--bronze); }
/* --- STILURI JOC SƒÇRITURI --- */
#jumpGameContainer { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #222; z-index: 200; touch-action: none; }
#jumpCanvas { display: block; width: 100%; height: 100%; }
#jumpUI { position: absolute; top: 20px; left: 20px; color: white; font-size: 22px; font-weight: bold; text-shadow: 2px 2px 4px #000; z-index: 10; pointer-events: none; display: flex; flex-direction: column; gap: 10px; }
#jumpMenu { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: flex; flex-direction: column; justify-content: center; align-items: center; color: white; z-index: 20; }
#jumpWinScreen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(46, 213, 115, 0.95); display: none; flex-direction: column; justify-content: center; align-items: center; color: white; z-index: 30; text-align: center; }
/* --- STILURI JOC LITERE --- */
#letterGameContainer { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #FFF0F5; background-image: url('https://image.qwenlm.ai/public_source/9d076338-2b12-4553-8888-4cf6f0866228/1206da42b-50bc-4579-b502-e76be98f8371.png'); background-size: cover; z-index: 200; touch-action: none; font-family: 'Nunito', sans-serif; }
.letter-card-ui { background: rgba(255, 255, 255, 0.95); width: 95%; height: 95%; max-height: 800px; border-radius: 30px; box-shadow: 0 10px 25px rgba(255, 133, 162, 0.3); display: flex; flex-direction: column; align-items: center; padding: 15px; position: relative; backdrop-filter: blur(5px); margin: 2.5% auto; }
.letter-header { text-align: center; width: 100%; margin-bottom: 5px; flex-shrink: 0; }
.letter-header h1 { font-family: 'Fredoka One', cursive; color: var(--letter-primary); font-size: 1.8rem; margin: 0; text-shadow: 2px 2px 0px #FFE5EC; }
.letter-score { background: var(--letter-secondary); color: white; padding: 5px 15px; border-radius: 20px; font-weight: bold; font-size: 1.1rem; display: inline-block; margin-top: 5px; box-shadow: 0 4px 0 #7AB8E8; }
.letter-play-area { flex: 1; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 15px; min-height: 0; }
.letter-card-display { background: var(--letter-accent); width: 100px; height: 100px; border-radius: 25px; display: flex; justify-content: center; align-items: center; font-family: 'Fredoka One', cursive; font-size: 4rem; color: var(--letter-primary); box-shadow: 0 8px 0 #FFB3C6; transition: transform 0.2s; position: relative; flex-shrink: 0; border: 4px solid transparent; }
.letter-card-display.bounce { animation: bounce 0.5s; }
.letter-card-display.shake { animation: shake 0.5s; border-color: var(--error); }
@keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } }
.letter-canvas-container { position: relative; width: 100%; max-width: 350px; aspect-ratio: 1; background: white; border: 4px dashed var(--letter-secondary); border-radius: 25px; box-shadow: inset 0 0 20px rgba(0,0,0,0.05); flex-shrink: 0; }
.letter-canvas-container canvas { border-radius: 20px; width: 100%; height: 100%; display: block; position: absolute; top: 0; left: 0; }
#guideCanvas { z-index: 1; pointer-events: none; }
#drawCanvas { z-index: 2; }
.letter-clear-btn { position: absolute; top: 5px; right: 5px; background: #FFD1DC; border: none; width: 35px; height: 35px; border-radius: 50%; cursor: pointer; display: flex; justify-content: center; align-items: center; box-shadow: 0 4px 0 #FFB3C6; z-index: 10; }
.letter-clear-btn:active { transform: translateY(4px); box-shadow: none; }
.letter-clear-btn svg { width: 18px; height: 18px; fill: #D65A78; }
.letter-action-btn { background: var(--letter-primary); color: white; border: none; padding: 15px 30px; font-family: 'Fredoka One', cursive; font-size: 1.4rem; border-radius: 50px; cursor: pointer; box-shadow: 0 6px 0 #D65A78; transition: all 0.1s; width: 90%; max-width: 300px; flex-shrink: 0; margin-top: auto; margin-bottom: 10px; display: flex; justify-content: center; align-items: center; gap: 10px; }
.letter-action-btn:active { transform: translateY(6px); box-shadow: none; }
.letter-action-btn.next { background: var(--success); box-shadow: 0 6px 0 #8AC4E0; }
.letter-action-btn.skip { background: var(--timer-warning); color: #5E6472; box-shadow: 0 6px 0 #E5C335; }
.letter-feedback-overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255,255,255,0.95); display: flex; flex-direction: column; justify-content: center; align-items: center; font-family: 'Fredoka One', cursive; font-size: 3rem; pointer-events: none; opacity: 0; transition: opacity 0.3s; z-index: 100; border-radius: 30px; text-align: center; padding: 20px; }
.letter-feedback-overlay.show { opacity: 1; animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
.letter-feedback-overlay.fail { color: var(--error); }
.letter-feedback-overlay.success { color: var(--letter-primary); }
#letterConfetti { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 200; border-radius: 30px; }
.letter-mascot-img { position: absolute; top: -40px; right: -30px; width: 90px; height: auto; z-index: 5; filter: drop-shadow(0 5px 5px rgba(0,0,0,0.1)); }

@media (max-width: 600px) {
h1 { font-size: 2rem; }
.problem-display { font-size: 3rem; }
.menu-grid, .sub-menu-grid { grid-template-columns: 1fr; }
.card, .big-card { min-height: 160px; }
.choices-grid { grid-template-columns: 1fr; }
.award-icon { font-size: 6rem; }
.award-title { font-size: 2rem; }
}
</style>
</head>
<body>
<div class="background-shapes" id="bg-shapes"></div>
<!-- Meniu Principal -->
<div class="container" id="mainContainer">
<h1>Super Jocuri</h1>
<div class="menu-grid">
<!-- Buton Joc Matematic -->
<div class="big-card" onclick="openMathMenu()">
<div class="big-card-icon">üßÆ</div>
<div class="big-card-title">Joc Matematic</div>
<div class="big-card-desc">Exerci»õii de adunare, scƒÉdere, √Ænmul»õire!</div>
</div>
<!-- Buton Joc SƒÉrituri -->
<div class="big-card" onclick="openJumpGame()">
<div class="big-card-icon">ü¶ï</div>
<div class="big-card-title">Aventura Eroului</div>
<div class="big-card-desc">Sari peste obstacole »ôi c√¢»ôtigƒÉ trofee!</div>
</div>
<!-- Buton Joc Litere -->
<div class="big-card" onclick="openLetterGame()">
<div class="big-card-icon">‚úèÔ∏è</div>
<div class="big-card-title">Litere Magice</div>
<div class="big-card-desc">DeseneazƒÉ literele »ôi numerele pe contur!</div>
</div>
<!-- Buton Joc Pian -->
<div class="big-card" onclick="openPianoGame()" style="border-bottom: 6px solid #9C27B0;">
<div class="big-card-icon">üéπ</div>
<div class="big-card-title">Pian Muzical</div>
<div class="big-card-desc">C√¢ntƒÉ melodii cu versuri care cad!</div>
</div>
</div>
</div>

<!-- Interfa»õƒÉ Joc Matematic -->
<button class="back-btn" id="mathBackBtn" style="display: none;" onclick="showMainMenu()">‚Üê √énapoi</button>
<div class="container" id="mathContainer" style="display: none;">
<div id="mathMainMenu">
<h1>Alege Nivelul</h1>
<div class="sub-menu-grid" id="mathMenuGrid"></div>
<button class="btn btn-secondary" onclick="showMainMenu()" style="margin-top: 2rem;">√énapoi la Meniu</button>
</div>
<div id="mathSubMenu" style="display: none;">
<h2 id="mathSubMenuTitle">ActivitƒÉ»õi:</h2>
<div class="sub-menu-grid" id="mathSubMenuGrid"></div>
<button class="btn btn-secondary" onclick="openMathMenu()" style="margin-top: 2rem;">√énapoi</button>
</div>
<div id="mathGameArea" class="game-area">
<div class="stats-bar">
<span id="mathScoreDisplay">Scor: 100</span>
<span id="mathProgressDisplay">Exerci»õiul: 1/20</span>
</div>
<div class="timer-container"><div class="timer-bar" id="mathTimerBar"></div></div>
<div id="mathGameContent"></div>
<div id="mathChoicesContainer" class="choices-grid" style="display: none;"></div>
<div id="mathInputContainer" class="input-group" style="display: none;">
<input type="number" id="mathAnswerInput" placeholder="?" autocomplete="off" step="0.1">
<button class="btn btn-primary" onclick="checkMathAnswer()">VerificƒÉ</button>
</div>
<div class="feedback" id="mathFeedbackText"></div>
<button class="btn btn-secondary" onclick="openMathMenu()">Ie»ôire</button>
</div>
<div id="mathAwardScreen" class="award-container">
<div class="award-icon" id="mathAwardIcon">üèÜ</div>
<div class="award-title" id="mathAwardTitle">Premiul 1</div>
<div class="final-score" id="mathFinalScoreText">Scor Final: 100</div>
<div class="name-input-group" id="mathNameInputGroup" style="display: none;">
<label for="mathPlayerName">Introdu numele tƒÉu:</label>
<input type="text" id="mathPlayerName" placeholder="Nume..." maxlength="15">
<button class="btn btn-primary" onclick="saveMathScore()">SalveazƒÉ Scorul</button>
</div>
<button class="btn btn-secondary" id="mathCloseAwardBtn" onclick="openMathMenu()" style="display: none;">√énapoi</button>
</div>
<div id="mathLeaderboardScreen" class="leaderboard-container">
<h2 id="mathLeaderboardTitle">Clasament</h2>
<table class="leaderboard-table">
<thead><tr><th>#</th><th>Nume</th><th>Scor</th></tr></thead>
<tbody id="mathLeaderboardBody"></tbody>
</table>
<button class="btn btn-secondary" onclick="openMathMenu()">√énapoi</button>
</div>
</div>

<!-- Interfa»õƒÉ Joc SƒÉrituri -->
<div id="jumpGameContainer">
<canvas id="jumpCanvas"></canvas>
<div id="jumpUI">
<div class="badge">‚≠ê Scor: <span id="jumpScoreVal">0</span></div>
<div class="badge">üö© Sta»õia: <span id="jumpStationVal">0</span>/15</div>
</div>
<div id="jumpMenu">
<h1>Alege Eroul</h1>
<div style="margin-bottom: 20px;">
<button class="btn selected" id="jumpBtnGirl" onclick="setJumpChar('girl')">üåü Fata</button>
<button class="btn" id="jumpBtnBoy" onclick="setJumpChar('boy')">ü¶ï BƒÉiat</button>
</div>
<button class="btn" id="jumpStartBtn" onclick="startJumpGame()" style="background:#2ed573; margin-top:30px;">START JOC</button>
<p style="margin-top: 20px;">ApasƒÉ oriunde pentru a sƒÉri SUS!</p>
<button class="btn btn-secondary" onclick="closeJumpGame()" style="margin-top: 20px;">√énapoi la Meniu</button>
</div>
<div id="jumpWinScreen">
<h1 style="font-size: 50px;">VICTORIE! üèÜ</h1>
<p style="font-size: 24px; color: #fff;">Ai trecut prin toate cele 15 sta»õii!</p>
<button class="btn" onclick="closeJumpGame()" style="background:#fff; color:#2ed573; margin-top:30px;">√énapoi la Meniu</button>
</div>
</div>

<!-- Interfa»õƒÉ Joc Litere -->
<div id="letterGameContainer">
<div class="letter-card-ui">
<canvas id="letterConfetti"></canvas>
<header class="letter-header">
<h1>Jocul Literelor</h1>
<div class="letter-score">Stelu»õe: <span id="letterScore">0</span> ‚≠ê</div>
</header>
<div class="letter-play-area">
<div class="letter-card-display" id="letterTargetCard">
<span id="letterTargetChar">A</span>
<img src="https://image.qwenlm.ai/public_source/9d076338-2b12-4553-8888-4cf6f0866228/173d93ddf-8170-4865-8cf4-97af1e0962e2.png" alt="Mascot" class="letter-mascot-img">
</div>
<div class="letter-canvas-container">
<canvas id="guideCanvas"></canvas>
<canvas id="drawCanvas"></canvas>
<button class="letter-clear-btn" onclick="clearLetterCanvas()" title="»òterge">
<svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
</button>
</div>
<button id="letterMainBtn" class="letter-action-btn" onclick="handleLetterAction()">
<span>VerificƒÉ!</span>
</button>
</div>
<div class="letter-feedback-overlay" id="letterFeedback">
<div id="letterFeedbackIcon" style="font-size: 4rem; margin-bottom: 10px;">üéâ</div>
<div id="letterFeedbackText">Bravo!</div>
</div>
<button class="btn btn-secondary" onclick="closeLetterGame()" style="position:absolute; bottom:10px; left:10px; z-index:50;">Ie»ôire</button>
</div>
</div>

<!-- Interfa»õƒÉ Joc PIAN -->
<div id="pianoGameContainer" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:#1a1a2e; z-index:300; overflow-y:auto;">
    <div id="pianoRoot"></div>
    <button class="btn btn-secondary" onclick="closePianoGame()" style="position:absolute; top:20px; right:20px; z-index:400; background:#ff4757;">√énapoi la Meniu</button>
</div>

<!-- Scripturi externe pentru Pian (√ÆncƒÉrcate doar c√¢nd e nevoie) -->
<script src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://cdn.tailwindcss.com"></script>

<script>
// ==========================================
// LOGICA GENERALƒÇ & NAVIGARE
// ==========================================
function showMainMenu() {
document.getElementById('mainContainer').style.display = 'block';
document.getElementById('mathContainer').style.display = 'none';
document.getElementById('mathBackBtn').style.display = 'none';
closeJumpGame();
closeLetterGame();
closePianoGame();
}
function openMathMenu() {
document.getElementById('mainContainer').style.display = 'none';
document.getElementById('mathContainer').style.display = 'block';
document.getElementById('mathBackBtn').style.display = 'flex';
document.getElementById('mathBackBtn').onclick = showMainMenu;
document.getElementById('mathMainMenu').style.display = 'block';
document.getElementById('mathSubMenu').style.display = 'none';
document.getElementById('mathGameArea').style.display = 'none';
document.getElementById('mathAwardScreen').style.display = 'none';
document.getElementById('mathLeaderboardScreen').style.display = 'none';
renderMathMainMenu();
}
function openJumpGame() {
document.getElementById('mainContainer').style.display = 'none';
document.getElementById('mathContainer').style.display = 'none';
document.getElementById('jumpGameContainer').style.display = 'block';
initJumpGame();
}
function closeJumpGame() {
jumpGameRunning = false;
document.getElementById('jumpGameContainer').style.display = 'none';
document.getElementById('jumpMenu').style.display = 'flex';
document.getElementById('jumpWinScreen').style.display = 'none';
}
function openLetterGame() {
document.getElementById('mainContainer').style.display = 'none';
document.getElementById('mathContainer').style.display = 'none';
document.getElementById('letterGameContainer').style.display = 'block';
initLetterGame();
}
function closeLetterGame() {
document.getElementById('letterGameContainer').style.display = 'none';
}

// Func»õii noi pentru Jocul Pian
let pianoRoot = null;
function openPianoGame() {
    try {
        document.getElementById('mainContainer').style.display = 'none';
        document.getElementById('pianoGameContainer').style.display = 'block';
        
        // VerificƒÉm dacƒÉ React este √ÆncƒÉrcat corect
        if (typeof React === 'undefined' || typeof ReactDOM === 'undefined') {
            alert("Se √ÆncarcƒÉ componentele muzicale... Te rugƒÉm sƒÉ a»ôtep»õi o secundƒÉ »ôi sƒÉ √Æncerci din nou.");
            closePianoGame();
            return;
        }

        if (!pianoRoot) {
            pianoRoot = ReactDOM.createRoot(document.getElementById('pianoRoot'));
        }
        // RenderizƒÉm componenta React definitƒÉ mai jos
        pianoRoot.render(<PianoWithFallingDots />);
    } catch (e) {
        console.error("Eroare la √ÆncƒÉrcarea pianului:", e);
        alert("A apƒÉrut o eroare la √ÆncƒÉrcarea jocului Pian. Celelalte jocuri func»õioneazƒÉ normal.");
        closePianoGame();
    }
}

function closePianoGame() {
    document.getElementById('pianoGameContainer').style.display = 'none';
    if (pianoRoot) {
        try {
            pianoRoot.unmount(); // CurƒÉ»õƒÉm React c√¢nd ie»ôim
        } catch(e) {}
        pianoRoot = null;
    }
}

// ==========================================
// LOGICA JOC MATEMATIC
// ==========================================
let mathCurrentMode = '';
let mathScore = 100;
let mathCurrentAnswer = 0;
let mathTimeLeft = 0;
let mathMaxTime = 0;
let mathTimerInterval;
let mathDifficultyLevel = 1;
let mathProblemHTML = '';
let mathQuestionCount = 0;
const MAX_QUESTIONS = 20;
let mathCurrentSubMenuKey = '';
let isMathGameEnding = false;
const mathMenus = {
'kg': { title: 'GrƒÉdini»õƒÉ', theme: 'boy', items: [
{ id: 'kg_count', icon: 'üöó', title: 'NumƒÉrƒÉ Obiecte', desc: 'C√¢te ma»ôinu»õe sunt?' },
{ id: 'kg_sequence', icon: 'ü§ñ', title: '»òir Numeric', desc: 'ContinuƒÉ »ôirul (1-10)' },
{ id: 'kg_add', icon: '‚öΩ', title: 'AdunƒÉri Vizuale', desc: 'AdunƒÉ bilele' }
]},
'easy_menu': { title: 'Clasa 1 - 2 (FƒÉrƒÉ Trecere)', theme: 'girl', items: [
{ id: 'easy_math', icon: 'ü¶Ñ', title: 'Calcule', desc: 'AdunƒÉri »ôi scƒÉderi simple' },
{ id: 'easy_seq', icon: 'üî¢', title: '»òiruri Numerice', desc: 'GƒÉse»ôte urmƒÉtorul numƒÉr' },
{ id: 'easy_comp', icon: '‚öñÔ∏è', title: 'Compara»õii', desc: 'Care e mai mare?' }
]},
'max_menu': { title: 'Clasa 1 - 2 (Cu Trecere)', theme: 'girl', items: [
{ id: 'max_math', icon: 'üëë', title: 'Calcule Avansate', desc: 'Cu trecere peste ordin' },
{ id: 'max_seq', icon: 'üß©', title: '»òiruri Complexe', desc: 'Salturi de 2, 5, 10' },
{ id: 'max_eq', icon: '‚ùì', title: 'Ecua»õii Simple', desc: 'GƒÉse»ôte numƒÉrul lipsƒÉ' }
]},
'med_menu': { title: 'Clasa 3 - 4', theme: 'girl', items: [
{ id: 'med_math', icon: 'üå∏', title: '√énmul»õiri & √émpƒÉr»õiri', desc: 'Tabelele √Ænmul»õirii' },
{ id: 'med_round', icon: 'üéØ', title: 'Rotunjiri', desc: 'La zece sau sutƒÉ' },
{ id: 'med_order', icon: 'üìù', title: 'Ordinea Opera»õiilor', desc: 'Calcul cu paranteze' }
]},
'hard_menu': { title: 'Clasa 5+', theme: 'girl', items: [
{ id: 'hard_frac', icon: 'üç∞', title: 'Frac»õii', desc: 'AdunƒÉri cu frac»õii' },
{ id: 'hard_dec', icon: 'üíß', title: 'Zecimale', desc: 'Calcule cu virgulƒÉ' },
{ id: 'hard_pow', icon: '‚ö°', title: 'Puteri & Radicali', desc: 'Calcul avansat' }
]},
'pro_menu': { title: '5 Pro (Avansat)', theme: 'pro', items: [
{ id: 'pro_cong', icon: '‚öõÔ∏è', title: 'Congruen»õe', desc: 'AritmeticƒÉ modularƒÉ (mod n)' },
{ id: 'pro_last', icon: 'üî¢', title: 'Ultima CifrƒÉ', desc: 'DeterminƒÉ ultima cifrƒÉ' },
{ id: 'pro_div', icon: '‚ûó', title: 'Criterii Divizibilitate', desc: 'Restul √ÆmpƒÉr»õirii' }
]}
};
function initMath() {
createBackgroundShapes();
renderMathMainMenu();
document.getElementById('mathAnswerInput').addEventListener("keypress", function(event) {
if (event.key === "Enter") checkMathAnswer();
});
}
function createBackgroundShapes() {
const container = document.getElementById('bg-shapes');
const colors = ['#FFCC80', '#FFAB91', '#FFE082', '#A5D6A7', '#90CAF9'];
for(let i=0; i<12; i++) {
const shape = document.createElement('div');
shape.classList.add('shape');
const size = Math.random() * 60 + 30;
const color = colors[Math.floor(Math.random() * colors.length)];
shape.style.width = `${size}px`;
shape.style.height = `${size}px`;
shape.style.left = `${Math.random() * 100}%`;
shape.style.backgroundColor = color;
shape.style.borderRadius = Math.random() > 0.5 ? '50%' : '15%';
shape.style.animationDuration = `${Math.random() * 10 + 15}s`;
shape.style.animationDelay = `-${Math.random() * 20}s`;
container.appendChild(shape);
}
}
function renderMathMainMenu() {
const grid = document.getElementById('mathMenuGrid');
grid.innerHTML = '';
Object.keys(mathMenus).forEach(key => {
const menuData = mathMenus[key];
const card = document.createElement('div');
card.className = `card ${menuData.theme === 'boy' ? 'kg-card' : (menuData.theme === 'pro' ? 'pro-card' : 'easy-card')}`;
const lbBtn = document.createElement('button');
lbBtn.className = 'card-lb-btn';
lbBtn.innerHTML = 'üèÜ';
lbBtn.title = 'Vezi Clasament';
lbBtn.onclick = (e) => { e.stopPropagation(); showMathLeaderboard(key); };
card.innerHTML = `<div class="card-icon">${menuData.items[0].icon}</div><div class="card-title">${menuData.title}</div><div class="card-desc">${menuData.items[0].desc}</div>`;
card.appendChild(lbBtn);
card.onclick = () => openMathSubmenu(key);
grid.appendChild(card);
});
}
function openMathSubmenu(menuKey) {
mathCurrentSubMenuKey = menuKey;
const menuData = mathMenus[menuKey];
if(!menuData) return;
document.getElementById('mathMainMenu').style.display = 'none';
document.getElementById('mathSubMenu').style.display = 'block';
document.getElementById('mathSubMenuTitle').textContent = menuData.title;
const subGrid = document.getElementById('mathSubMenuGrid');
subGrid.innerHTML = '';
document.body.classList.remove('boy-theme', 'pro-theme');
if(menuData.theme === 'boy') document.body.classList.add('boy-theme');
if(menuData.theme === 'pro') document.body.classList.add('pro-theme');
menuData.items.forEach(item => {
const card = document.createElement('div');
card.className = `card ${menuData.theme === 'boy' ? 'kg-card' : (menuData.theme === 'pro' ? 'pro-card' : 'easy-card')}`;
card.innerHTML = `<div class="card-icon">${item.icon}</div><div class="card-title">${item.title}</div><div class="card-desc">${item.desc}</div>`;
card.onclick = () => startMathGame(item.id);
subGrid.appendChild(card);
});
}
function startMathGame(mode) {
mathCurrentMode = mode;
mathScore = 100;
mathQuestionCount = 0;
mathDifficultyLevel = 1;
isMathGameEnding = false;
updateMathStats();
document.getElementById('mathSubMenu').style.display = 'none';
document.getElementById('mathGameArea').style.display = 'block';
document.getElementById('mathAwardScreen').style.display = 'none';
document.getElementById('mathLeaderboardScreen').style.display = 'none';
const isBoy = mode.startsWith('kg');
const isPro = mode.startsWith('pro');
if(isBoy) {
document.body.classList.add('boy-theme');
document.getElementById('mathChoicesContainer').style.display = 'grid';
document.getElementById('mathInputContainer').style.display = 'none';
} else {
if(isPro) document.body.classList.add('pro-theme');
else document.body.classList.remove('boy-theme', 'pro-theme');
document.getElementById('mathChoicesContainer').style.display = 'none';
document.getElementById('mathInputContainer').style.display = 'flex';
}
nextMathProblem();
if(!isBoy) document.getElementById('mathAnswerInput').focus();
}
function updateMathStats() {
document.getElementById('mathScoreDisplay').textContent = `Scor: ${mathScore}`;
document.getElementById('mathProgressDisplay').textContent = `Exerci»õiul: ${mathQuestionCount + 1}/${MAX_QUESTIONS}`;
}
function startMathTimer(seconds) {
clearInterval(mathTimerInterval);
mathMaxTime = seconds;
mathTimeLeft = seconds;
updateMathTimerVisuals();
mathTimerInterval = setInterval(() => {
mathTimeLeft--;
updateMathTimerVisuals();
if (mathTimeLeft <= 0) { clearInterval(mathTimerInterval); handleMathTimeout(); }
}, 1000);
}
function updateMathTimerVisuals() {
const percentage = (mathTimeLeft / mathMaxTime) * 100;
document.getElementById('mathTimerBar').style.width = `${percentage}%`;
if (percentage > 50) document.getElementById('mathTimerBar').style.backgroundColor = 'var(--success)';
else if (percentage > 20) document.getElementById('mathTimerBar').style.backgroundColor = 'var(--timer-warning)';
else document.getElementById('mathTimerBar').style.backgroundColor = 'var(--timer-danger)';
}
function handleMathTimeout() {
showMathCorrectAnswer(true);
}
function getRandomInt(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }
function generateMathChoices(correctAnswer, minVal, maxVal) {
let choices = new Set();
choices.add(correctAnswer);
while(choices.size < 3) {
let offset = getRandomInt(-5, 5);
let wrong = correctAnswer + offset;
if(wrong >= minVal && wrong <= maxVal && wrong !== correctAnswer) choices.add(wrong);
else { let r = getRandomInt(minVal, maxVal); if(r !== correctAnswer) choices.add(r); }
}
return Array.from(choices).sort(() => Math.random() - 0.5);
}
function renderMathChoices(choices) {
const container = document.getElementById('mathChoicesContainer');
container.innerHTML = '';
choices.forEach(val => {
const btn = document.createElement('button');
btn.className = 'choice-btn';
btn.textContent = val;
btn.onclick = () => handleMathChoiceClick(val);
container.appendChild(btn);
});
}
function handleMathChoiceClick(val) {
if(isMathGameEnding) return;
let isCorrect = (val === mathCurrentAnswer);
processMathResult(isCorrect);
}
function checkMathAnswer() {
const isBoy = mathCurrentMode.startsWith('kg');
if(isBoy) return;
if(isMathGameEnding) return;
const userVal = parseFloat(document.getElementById('mathAnswerInput').value);
if (isNaN(userVal)) return;
let isCorrect = false;
if(mathCurrentMode === 'easy_comp') {
isCorrect = (userVal === mathCurrentAnswer);
} else {
isCorrect = (Math.abs(userVal - mathCurrentAnswer) < 0.01);
}
processMathResult(isCorrect);
}
function processMathResult(isCorrect) {
if(isCorrect) {
document.getElementById('mathFeedbackText').textContent = "Bravo! Corect! üéâ";
document.getElementById('mathFeedbackText').className = "feedback correct";
mathDifficultyLevel = 1;
} else {
mathScore -= 5;
updateMathStats();
document.getElementById('mathFeedbackText').textContent = "Gre»ôit! Vezi rƒÉspunsul corect mai sus. üò¢";
document.getElementById('mathFeedbackText').className = "feedback wrong";
mathDifficultyLevel++;
showMathCorrectAnswer(false);
return;
}
if (mathQuestionCount >= MAX_QUESTIONS) {
isMathGameEnding = true;
setTimeout(endMathGame, 1500);
} else {
setTimeout(nextMathProblem, 1500);
}
}
function nextMathProblem() {
if (mathQuestionCount >= MAX_QUESTIONS) { endMathGame(); return; }
mathQuestionCount++;
updateMathStats();
document.getElementById('mathAnswerInput').value = '';
document.getElementById('mathFeedbackText').textContent = '';
document.getElementById('mathFeedbackText').className = 'feedback';
document.getElementById('mathGameContent').innerHTML = '';
document.getElementById('mathChoicesContainer').innerHTML = '';
mathProblemHTML = '';
if (mathCurrentMode.startsWith('kg')) { if (mathDifficultyLevel === 1) startMathTimer(30); else startMathTimer(40); }
else { if (mathDifficultyLevel === 1) startMathTimer(20); else startMathTimer(30); }
// Generare probleme (codul original pƒÉstrat)
if (mathCurrentMode === 'kg_count') {
const maxCount = mathDifficultyLevel === 1 ? 5 : 10;
const count = getRandomInt(1, maxCount);
mathCurrentAnswer = count;
let html = '<div class="visual-container">';
const icons = ['üöó', '‚öΩ', 'üöÄ', 'ü§ñ', 'üö≤'];
const icon = icons[Math.floor(Math.random() * icons.length)];
for(let i=0; i<count; i++) html += `<div style="font-size: 3rem; animation: bounce 2s infinite; animation-delay: ${i*0.1}s">${icon}</div>`;
html += '</div><p style="font-size: 1.3rem; color: #546E7A; font-weight:bold;">C√¢te sunt?</p>';
document.getElementById('mathGameContent').innerHTML = html;
renderMathChoices(generateMathChoices(mathCurrentAnswer, 1, maxCount + 2));
}
else if (mathCurrentMode === 'kg_sequence') {
const start = getRandomInt(0, mathDifficultyLevel === 1 ? 3 : 6);
let sequence = [];
for(let i=0; i<3; i++) sequence.push(start + i);
mathCurrentAnswer = start + 3;
document.getElementById('mathGameContent').innerHTML = `<p style="font-size: 1.3rem; color: #546E7A; font-weight:bold;">CompleteazƒÉ codul:</p><div class="sequence-display">${sequence.join(' , ')} , <span class="missing-number">?</span></div>`;
renderMathChoices(generateMathChoices(mathCurrentAnswer, 0, 10));
}
else if (mathCurrentMode === 'kg_add') {
const maxNum = mathDifficultyLevel === 1 ? 4 : 9;
const n1 = getRandomInt(1, maxNum);
const n2 = getRandomInt(1, maxNum);
mathCurrentAnswer = n1 + n2;
let html = '<div class="visual-container">';
for(let i=0; i<n1; i++) html += `<div style="font-size: 2.5rem;">‚öΩ</div>`;
html += '<div style="width:20px; font-weight:900; color:#2196F3; font-size:1.5rem;">+</div>';
for(let i=0; i<n2; i++) html += `<div style="font-size: 2.5rem;">‚öΩ</div>`;
html += '</div>';
document.getElementById('mathGameContent').innerHTML = html + `<div class="problem-display">${n1} + ${n2} = ?</div>`;
renderMathChoices(generateMathChoices(mathCurrentAnswer, 2, maxNum * 2 + 2));
}
else if (mathCurrentMode === 'easy_math') {
const rangeMax = mathDifficultyLevel === 1 ? 50 : 90;
const op = Math.random() > 0.5 ? '+' : '-';
let n1 = getRandomInt(10, rangeMax);
let n2;
if(op === '+') {
let d1_10 = Math.floor(n1 / 10); let d1_1 = n1 % 10;
let d2_10 = getRandomInt(0, 9 - d1_10); let d2_1 = getRandomInt(0, 9 - d1_1);
n2 = (d2_10 * 10) + d2_1; if(n2===0) n2=1;
mathCurrentAnswer = n1 + n2;
} else {
let d1_10 = Math.floor(n1 / 10); let d1_1 = n1 % 10;
let d2_10 = getRandomInt(0, d1_10); let d2_1 = getRandomInt(0, d1_1);
n2 = (d2_10 * 10) + d2_1; if(n2===0) n2=1; if(n2 >= n1) n2 = getRandomInt(1, n1-1);
mathCurrentAnswer = n1 - n2;
}
mathProblemHTML = `<div class="problem-display">${n1} ${op} ${n2} = ?</div>`;
document.getElementById('mathGameContent').innerHTML = mathProblemHTML;
}
else if (mathCurrentMode === 'easy_seq') {
const start = getRandomInt(1, 20);
const step = 1;
let seq = [start, start+step, start+step*2];
mathCurrentAnswer = start + step*3;
mathProblemHTML = `<div class="sequence-display">${seq.join(', ')}, <span class="missing-number">?</span></div>`;
document.getElementById('mathGameContent').innerHTML = mathProblemHTML;
}
else if (mathCurrentMode === 'easy_comp') {
const n1 = getRandomInt(10, 50);
const n2 = getRandomInt(10, 50);
mathCurrentAnswer = n1 > n2 ? 1 : 2;
mathProblemHTML = `<div style="font-size:1.5rem; color:#666;">ComparƒÉ numerele:</div><div class="problem-display">${n1} <span class="missing-number">?</span> ${n2}</div><div style="font-size:1.2rem; color:#666;">(1 st√¢nga, 2 dreapta)</div>`;
document.getElementById('mathGameContent').innerHTML = mathProblemHTML;
}
else if (mathCurrentMode === 'max_math') {
const op = Math.random() > 0.5 ? '+' : '-';
let n1, n2;
if(op === '+') {
let u1 = getRandomInt(1, 9); let u2 = getRandomInt(10-u1, 9);
let t1 = getRandomInt(1, 8); let t2 = getRandomInt(0, 9-t1);
n1 = t1*10+u1; n2 = t2*10+u2; mathCurrentAnswer = n1+n2;
} else {
let u1 = getRandomInt(0, 8); let u2 = getRandomInt(u1+1, 9);
let t1 = getRandomInt(2, 9); let t2 = getRandomInt(0, t1-1);
n1 = t1*10+u1; n2 = t2*10+u2; mathCurrentAnswer = n1-n2;
}
mathProblemHTML = `<div class="problem-display">${n1} ${op} ${n2} = ?</div>`;
document.getElementById('mathGameContent').innerHTML = mathProblemHTML;
}
else if (mathCurrentMode === 'max_seq') {
const step = mathDifficultyLevel === 1 ? 2 : 5;
const start = getRandomInt(1, 10);
let seq = [start, start+step, start+step*2];
mathCurrentAnswer = start + step*3;
mathProblemHTML = `<div class="sequence-display">${seq.join(', ')}, <span class="missing-number">?</span></div>`;
document.getElementById('mathGameContent').innerHTML = mathProblemHTML;
}
else if (mathCurrentMode === 'max_eq') {
const res = getRandomInt(10, 50);
const add = getRandomInt(1, 9);
mathCurrentAnswer = res - add;
mathProblemHTML = `<div class="problem-display"><span class="missing-number">?</span> + ${add} = ${res}</div>`;
document.getElementById('mathGameContent').innerHTML = mathProblemHTML;
}
else if (mathCurrentMode === 'med_math') {
const n1 = getRandomInt(2, 9);
const n2 = getRandomInt(2, 9);
mathCurrentAnswer = n1 * n2;
mathProblemHTML = `<div class="problem-display">${n1} √ó ${n2} = ?</div>`;
document.getElementById('mathGameContent').innerHTML = mathProblemHTML;
}
else if (mathCurrentMode === 'med_round') {
const num = getRandomInt(15, 985);
const roundTo = mathDifficultyLevel === 1 ? 10 : 100;
mathCurrentAnswer = Math.round(num / roundTo) * roundTo;
mathProblemHTML = `<div style="font-size:1.5rem; color:#666;">Rotunjire la ${roundTo}:</div><div class="problem-display">${num} ‚âà <span class="missing-number">?</span></div>`;
document.getElementById('mathGameContent').innerHTML = mathProblemHTML;
}
else if (mathCurrentMode === 'med_order') {
const a = getRandomInt(2, 5);
const b = getRandomInt(2, 5);
const c = getRandomInt(1, 10);
mathCurrentAnswer = (a + b) * c;
mathProblemHTML = `<div class="problem-display">(${a} + ${b}) √ó ${c} = ?</div>`;
document.getElementById('mathGameContent').innerHTML = mathProblemHTML;
}
else if (mathCurrentMode === 'hard_frac') {
const den = getRandomInt(2, 9);
const n1 = getRandomInt(1, den-1);
const n2 = getRandomInt(1, den-n1);
mathCurrentAnswer = (n1 + n2) / den;
mathProblemHTML = `<div style="font-size:1.5rem; color:#666;">Calcul (zecimal):</div><div class="problem-display">${n1}/${den} + ${n2}/${den} = <span class="missing-number">?</span></div>`;
document.getElementById('mathGameContent').innerHTML = mathProblemHTML;
}
else if (mathCurrentMode === 'hard_dec') {
const n1 = getRandomInt(10, 50) / 10;
const n2 = getRandomInt(10, 50) / 10;
mathCurrentAnswer = n1 + n2;
mathProblemHTML = `<div class="problem-display">${n1} + ${n2} = <span class="missing-number">?</span></div>`;
document.getElementById('mathGameContent').innerHTML = mathProblemHTML;
}
else if (mathCurrentMode === 'hard_pow') {
const base = getRandomInt(2, 5);
const exp = getRandomInt(2, 3);
mathCurrentAnswer = Math.pow(base, exp);
mathProblemHTML = `<div class="problem-display">${base}<sup>${exp}</sup> = <span class="missing-number">?</span></div>`;
document.getElementById('mathGameContent').innerHTML = mathProblemHTML;
}
else if (mathCurrentMode === 'pro_cong') {
const n = mathDifficultyLevel === 1 ? getRandomInt(2, 5) : getRandomInt(6, 12);
const a = getRandomInt(10, 100);
mathCurrentAnswer = a % n;
mathProblemHTML = `<div style="font-size:1.5rem; color:#666;">Congruen»õƒÉ:</div><div class="problem-display">${a} ‚â° <span class="missing-number">?</span> (mod ${n})</div>`;
document.getElementById('mathGameContent').innerHTML = mathProblemHTML;
}
else if (mathCurrentMode === 'pro_last') {
const base = getRandomInt(11, 99);
const exp = getRandomInt(2, 5);
mathCurrentAnswer = Math.pow(base, exp) % 10;
mathProblemHTML = `<div style="font-size:1.5rem; color:#666;">Ultima cifrƒÉ:</div><div class="problem-display">${base}<sup>${exp}</sup> ‚Üí <span class="missing-number">?</span></div>`;
document.getElementById('mathGameContent').innerHTML = mathProblemHTML;
}
else if (mathCurrentMode === 'pro_div') {
const div = mathDifficultyLevel === 1 ? 3 : 7;
const a = getRandomInt(20, 100);
mathCurrentAnswer = a % div;
mathProblemHTML = `<div style="font-size:1.5rem; color:#666;">Restul √ÆmpƒÉr»õirii:</div><div class="problem-display">${a} : ${div} rest <span class="missing-number">?</span></div>`;
document.getElementById('mathGameContent').innerHTML = mathProblemHTML;
}
}
function endMathGame() {
clearInterval(mathTimerInterval);
document.getElementById('mathGameArea').style.display = 'none';
document.getElementById('mathAwardScreen').style.display = 'flex';
document.getElementById('mathFinalScoreText').textContent = `Scor Final: ${mathScore}`;
let icon = '', title = '', titleClass = '', showInput = false;
if (mathScore === 100) { icon = 'üèÜ'; title = 'PREMIUL 1'; titleClass = 'award-gold'; showInput = true; }
else if (mathScore === 95) { icon = 'ü•à'; title = 'PREMIUL 2'; titleClass = 'award-silver'; showInput = true; }
else if (mathScore === 90) { icon = 'ü•â'; title = 'PREMIUL 3'; titleClass = 'award-bronze'; showInput = true; }
else if (mathScore >= 70 && mathScore <= 85) { icon = 'üéñÔ∏è'; title = 'MEN»öIUNE'; titleClass = 'award-mention'; showInput = true; }
else { icon = 'üí™'; title = '√éNCEARCƒÇ DIN NOU'; titleClass = 'award-try'; showInput = false; }
document.getElementById('mathAwardIcon').textContent = icon;
document.getElementById('mathAwardTitle').textContent = title;
document.getElementById('mathAwardTitle').className = 'award-title ' + titleClass;
if(showInput) { document.getElementById('mathNameInputGroup').style.display = 'flex'; document.getElementById('mathCloseAwardBtn').style.display = 'none'; document.getElementById('mathPlayerName').value = ''; document.getElementById('mathPlayerName').focus(); }
else { document.getElementById('mathNameInputGroup').style.display = 'none'; document.getElementById('mathCloseAwardBtn').style.display = 'inline-block'; }
}
function saveMathScore() {
const name = document.getElementById('mathPlayerName').value.trim() || "Anonim";
const leaderboardKey = `math_leaderboard_${mathCurrentMode}`;
try {
let scores = JSON.parse(localStorage.getItem(leaderboardKey) || "[]");
scores.push({ name: name, score: mathScore, date: new Date().toLocaleDateString() });
scores.sort((a, b) => b.score - a.score);
scores = scores.slice(0, 10);
localStorage.setItem(leaderboardKey, JSON.stringify(scores));
document.getElementById('mathNameInputGroup').style.display = 'none';
document.getElementById('mathCloseAwardBtn').style.display = 'inline-block';
} catch (e) {
console.error("Eroare la salvarea scorului:", e);
alert("A apƒÉrut o eroare la salvarea scorului.");
}
}
function showMathLeaderboard(categoryKey) {
const key = categoryKey || mathCurrentSubMenuKey;
const menuData = mathMenus[key];
if (!menuData) return;
document.getElementById('mathGameArea').style.display = 'none';
document.getElementById('mathAwardScreen').style.display = 'none';
document.getElementById('mathSubMenu').style.display = 'none';
document.getElementById('mathMainMenu').style.display = 'none';
document.getElementById('mathLeaderboardScreen').style.display = 'flex';
document.getElementById('mathBackBtn').style.display = 'flex';
document.getElementById('mathBackBtn').onclick = () => { document.getElementById('mathLeaderboardScreen').style.display = 'none'; if(categoryKey) document.getElementById('mathMainMenu').style.display = 'block'; else document.getElementById('mathSubMenu').style.display = 'block'; };
document.getElementById('mathLeaderboardTitle').textContent = `Clasament: ${menuData.title}`;
let allScores = [];
if (menuData.items && Array.isArray(menuData.items)) {
menuData.items.forEach(item => {
try {
const itemKey = `math_leaderboard_${item.id}`;
const itemScores = JSON.parse(localStorage.getItem(itemKey) || "[]");
allScores = allScores.concat(itemScores);
} catch (e) { console.warn(`Eroare la citirea scorurilor pentru ${item.id}:`, e); }
});
}
allScores.sort((a, b) => b.score - a.score);
allScores = allScores.slice(0, 10);
const tbody = document.getElementById('mathLeaderboardBody');
tbody.innerHTML = '';
if(allScores.length === 0) { tbody.innerHTML = '<tr><td colspan="3">Nu existƒÉ √ÆncƒÉ scoruri.</td></tr>'; }
else {
allScores.forEach((entry, index) => {
const row = `<tr><td>${index + 1}</td><td>${entry.name}</td><td>${entry.score}</td></tr>`;
tbody.innerHTML += row;
});
}
}
function showMathCorrectAnswer(isTimeout) {
if(mathProblemHTML) {
const correctedHTML = mathProblemHTML.replace(
/<span class="missing-number">\?<\/span>/g,
`<span style="color:var(--success); font-weight:900; border-bottom: 4px solid var(--success);">${mathCurrentAnswer}</span>`
);
document.getElementById('mathGameContent').innerHTML = correctedHTML;
}
if(isTimeout) {
document.getElementById('mathFeedbackText').innerHTML = `Timp expirat! <br>RƒÉspunsul corect este <strong>${mathCurrentAnswer}</strong>. (-5 puncte)`;
} else {
document.getElementById('mathFeedbackText').innerHTML = `Gre»ôit! <br>RƒÉspunsul corect este <strong>${mathCurrentAnswer}</strong>. (-5 puncte)`;
}
document.getElementById('mathFeedbackText').className = "feedback wrong";
mathScore -= 5;
updateMathStats();
mathDifficultyLevel++;
document.getElementById('mathAnswerInput').value = '';
if (mathQuestionCount >= MAX_QUESTIONS) {
isMathGameEnding = true;
setTimeout(endMathGame, 3000);
} else {
setTimeout(nextMathProblem, 3000);
}
}
// ==========================================
// LOGICA JOC SƒÇRITURI
// ==========================================
const jumpCanvas = document.getElementById('jumpCanvas');
const jumpCtx = jumpCanvas.getContext('2d');
const jumpScoreEl = document.getElementById('jumpScoreVal');
const jumpStationEl = document.getElementById('jumpStationVal');
const jumpMenu = document.getElementById('jumpMenu');
const jumpWinScreen = document.getElementById('jumpWinScreen');
const jumpBtnGirl = document.getElementById('jumpBtnGirl');
const jumpBtnBoy = document.getElementById('jumpBtnBoy');
let jumpGameRunning = false;
let jumpScore = 0;
let jumpStation = 0;
const maxStations = 15;
let jumpFrame = 0;
let jumpSpeed = 6;
let jumpCharType = 'girl';
const jumpGravity = 0.5;
const jumpPower = -20;
const jumpGroundH = 100;
const jumpPlayer = { x: 100, y: 0, size: 80, dy: 0, angle: 0, grounded: false };
let jumpObstacles = [];
const jumpThemes = [
{bg: ['#ff9a9e', '#fecfef'], ground: '#6ab04c'}, {bg: ['#4facfe', '#00f2fe'], ground: '#0097e6'},
{bg: ['#fddb92', '#d1fdff'], ground: '#eccc68'}, {bg: ['#96fbc4', '#f9f586'], ground: '#2ed573'},
{bg: ['#c2e9fb', '#a1c4fd'], ground: '#3742fa'}, {bg: ['#ffecd2', '#fcb69f'], ground: '#ff7f50'},
{bg: ['#e0c3fc', '#8ec5fc'], ground: '#a55eea'}, {bg: ['#ffecd2', '#ffd1ff'], ground: '#ff4757'},
{bg: ['#d299c2', '#fef9d7'], ground: '#8c7ae6'}, {bg: ['#85FFBD', '#FFFB7D'], ground: '#26de81'},
{bg: ['#C9FFBF', '#FFAFBD'], ground: '#fc5c65'}, {bg: ['#FAD961', '#F76B1C'], ground: '#e58e26'},
{bg: ['#B5FFFC', '#D5FFEA'], ground: '#0be881'}, {bg: ['#FFDEE9', '#B5FFFC'], ground: '#4834d4'},
{bg: ['#F6D365', '#FDA085'], ground: '#be2edd'}, {bg: ['#667eea', '#764ba2'], ground: '#ffffff'}
];
function initJumpGame() {
resizeJumpCanvas();
window.addEventListener('resize', resizeJumpCanvas);
window.addEventListener('pointerdown', function(e) {
if(e.target.tagName === 'BUTTON') return;
jumpDoJump();
});
window.addEventListener('keydown', function(e) {
if ((e.code === 'Space' || e.code === 'ArrowUp') && jumpGameRunning) jumpDoJump();
});
}
function resizeJumpCanvas() {
jumpCanvas.width = window.innerWidth;
jumpCanvas.height = window.innerHeight;
if(!jumpGameRunning) {
jumpPlayer.y = jumpCanvas.height - jumpGroundH - jumpPlayer.size;
jumpPlayer.x = jumpCanvas.width * 0.15;
drawJump();
} else {
jumpPlayer.x = jumpCanvas.width * 0.15;
}
}
window.setJumpChar = function(type) {
jumpCharType = type;
if(type === 'girl') {
jumpBtnGirl.classList.add('selected');
jumpBtnBoy.classList.remove('selected');
} else {
jumpBtnBoy.classList.add('selected');
jumpBtnGirl.classList.remove('selected');
}
};
window.startJumpGame = function() {
jumpMenu.style.display = 'none';
jumpGameRunning = true;
jumpScore = 0;
jumpStation = 0;
jumpSpeed = 6;
jumpFrame = 0;
jumpObstacles = [];
jumpPlayer.y = jumpCanvas.height - jumpGroundH - jumpPlayer.size;
jumpPlayer.dy = 0;
updateJumpUI();
jumpLoop();
};
function jumpDoJump() {
if (!jumpGameRunning) return;
if (jumpPlayer.grounded || jumpPlayer.y > jumpCanvas.height - jumpGroundH - jumpPlayer.size - 10) {
jumpPlayer.dy = jumpPower;
jumpPlayer.grounded = false;
}
}
function updateJumpUI() {
jumpScoreEl.innerText = jumpScore;
jumpStationEl.innerText = Math.min(jumpStation, maxStations);
}
function jumpLoop() {
if (!jumpGameRunning) return;
requestAnimationFrame(jumpLoop);
jumpFrame++;
updateJump();
drawJump();
}
function updateJump() {
jumpPlayer.dy += jumpGravity;
jumpPlayer.y += jumpPlayer.dy;
if (jumpPlayer.y + jumpPlayer.size > jumpCanvas.height - jumpGroundH) {
jumpPlayer.y = jumpCanvas.height - jumpGroundH - jumpPlayer.size;
jumpPlayer.dy = 0;
jumpPlayer.grounded = true;
jumpPlayer.angle = 0;
} else {
jumpPlayer.grounded = false;
jumpPlayer.angle += 0.1;
}
if (jumpFrame % Math.floor(1000 / jumpSpeed) === 0) {
let oh = 40 + Math.random() * 40;
jumpObstacles.push({ x: jumpCanvas.width, y: jumpCanvas.height - jumpGroundH - oh, w: 40, h: oh, passed: false });
}
for (let i = 0; i < jumpObstacles.length; i++) {
let o = jumpObstacles[i];
o.x -= jumpSpeed;
if (jumpPlayer.x < o.x + o.w && jumpPlayer.x + jumpPlayer.size > o.x &&
jumpPlayer.y < o.y + o.h && jumpPlayer.y + jumpPlayer.size > o.y) {
jumpGameOver();
}
if (o.x + o.w < jumpPlayer.x && !o.passed) {
jumpScore++;
if (jumpScore % 5 === 0) {
jumpStation++;
jumpSpeed += 0.5;
if (jumpStation >= maxStations) {
jumpGameWin();
return;
}
}
updateJumpUI();
o.passed = true;
}
}
if (jumpObstacles.length > 0 && jumpObstacles[0].x < -50) jumpObstacles.shift();
}
function drawJump() {
let t = jumpThemes[Math.min(jumpStation, jumpThemes.length - 1)];
let grad = jumpCtx.createLinearGradient(0, 0, 0, jumpCanvas.height);
grad.addColorStop(0, t.bg[0]);
grad.addColorStop(1, t.bg[1]);
jumpCtx.fillStyle = grad;
jumpCtx.fillRect(0, 0, jumpCanvas.width, jumpCanvas.height);
jumpCtx.fillStyle = t.ground;
jumpCtx.fillRect(0, jumpCanvas.height - jumpGroundH, jumpCanvas.width, jumpGroundH);
jumpCtx.fillStyle = "rgba(255,255,255,0.3)";
jumpCtx.fillRect(0, jumpCanvas.height - jumpGroundH, jumpCanvas.width, 10);
jumpCtx.fillStyle = "#ff4757";
jumpObstacles.forEach(o => {
jumpCtx.beginPath();
jumpCtx.moveTo(o.x, o.y + o.h);
jumpCtx.lineTo(o.x + o.w/2, o.y);
jumpCtx.lineTo(o.x + o.w, o.y + o.h);
jumpCtx.fill();
});
jumpCtx.save();
jumpCtx.translate(jumpPlayer.x + jumpPlayer.size/2, jumpPlayer.y + jumpPlayer.size/2);
jumpCtx.rotate(jumpPlayer.angle);
jumpCtx.font = jumpPlayer.size + "px Arial";
jumpCtx.textAlign = "center";
jumpCtx.textBaseline = "middle";
jumpCtx.fillText(jumpCharType === 'girl' ? "üåü" : "ü¶ï", 0, 0);
jumpCtx.restore();
}
function jumpGameOver() {
jumpGameRunning = false;
jumpMenu.style.display = 'flex';
document.querySelector('#jumpMenu h1').innerText = "Joc Terminat!\nScor: " + jumpScore;
document.getElementById('jumpStartBtn').innerText = "√éncearcƒÉ Din Nou";
}
function jumpGameWin() {
jumpGameRunning = false;
jumpWinScreen.style.display = 'flex';
}
// ==========================================
// LOGICA JOC LITERE
// ==========================================
const letterLetters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
const letterNumbers = "0123456789";
const letterAllChars = letterLetters + letterNumbers;
let letterCurrentChar = '';
let letterScore = 0;
let letterIsLevelComplete = false;
let letterHasDrawnSomething = false;
const letterDrawCanvas = document.getElementById('drawCanvas');
const letterDrawCtx = letterDrawCanvas.getContext('2d');
const letterGuideCanvas = document.getElementById('guideCanvas');
const letterGuideCtx = letterGuideCanvas.getContext('2d');
const letterTargetCharEl = document.getElementById('letterTargetChar');
const letterTargetCard = document.getElementById('letterTargetCard');
const letterMainBtn = document.getElementById('letterMainBtn');
const letterFeedbackEl = document.getElementById('letterFeedback');
const letterFeedbackText = document.getElementById('letterFeedbackText');
const letterFeedbackIcon = document.getElementById('letterFeedbackIcon');
const letterScoreEl = document.getElementById('letterScore');
const letterConfettiCanvas = document.getElementById('letterConfetti');
const letterConfettiCtx = letterConfettiCanvas.getContext('2d');
function initLetterGame() {
resizeLetterCanvases();
window.addEventListener('resize', resizeLetterCanvases);
setupLetterDrawing();
nextLetterLevel();
}
function resizeLetterCanvases() {
const container = letterDrawCanvas.parentElement;
[letterDrawCanvas, letterGuideCanvas].forEach(c => {
c.width = container.clientWidth;
c.height = container.clientHeight;
});
letterDrawCtx.lineCap = 'round';
letterDrawCtx.lineJoin = 'round';
letterDrawCtx.lineWidth = Math.max(10, container.clientWidth / 20);
letterDrawCtx.strokeStyle = '#5E6472';
if(letterCurrentChar) drawLetterGuide();
}
function drawLetterGuide() {
letterGuideCtx.clearRect(0, 0, letterGuideCanvas.width, letterGuideCanvas.height);
letterGuideCtx.fillStyle = '#E0E0E0';
letterGuideCtx.font = `bold ${letterGuideCanvas.height * 0.8}px 'Fredoka One'`;
letterGuideCtx.textAlign = 'center';
letterGuideCtx.textBaseline = 'middle';
letterGuideCtx.fillText(letterCurrentChar, letterGuideCanvas.width / 2, letterGuideCanvas.height / 2 + (letterGuideCanvas.height * 0.05));
}
function setupLetterDrawing() {
let letterIsDrawing = false;
function getPos(e) {
const rect = letterDrawCanvas.getBoundingClientRect();
const clientX = e.touches ? e.touches[0].clientX : e.clientX;
const clientY = e.touches ? e.touches[0].clientY : e.clientY;
return { x: clientX - rect.left, y: clientY - rect.top };
}
function startDraw(e) {
if (letterIsLevelComplete) return;
letterIsDrawing = true;
letterHasDrawnSomething = true;
const pos = getPos(e);
letterDrawCtx.beginPath();
letterDrawCtx.moveTo(pos.x, pos.y);
if(e.cancelable) e.preventDefault();
}
function draw(e) {
if (!letterIsDrawing || letterIsLevelComplete) return;
const pos = getPos(e);
letterDrawCtx.lineTo(pos.x, pos.y);
letterDrawCtx.stroke();
if(e.cancelable) e.preventDefault();
}
function stopDraw() {
letterIsDrawing = false;
letterDrawCtx.closePath();
}
letterDrawCanvas.addEventListener('mousedown', startDraw);
letterDrawCanvas.addEventListener('mousemove', draw);
letterDrawCanvas.addEventListener('mouseup', stopDraw);
letterDrawCanvas.addEventListener('mouseout', stopDraw);
letterDrawCanvas.addEventListener('touchstart', startDraw, { passive: false });
letterDrawCanvas.addEventListener('touchmove', draw, { passive: false });
letterDrawCanvas.addEventListener('touchend', stopDraw);
}
function nextLetterLevel() {
letterIsLevelComplete = false;
letterHasDrawnSomething = false;
letterCurrentChar = letterAllChars.charAt(Math.floor(Math.random() * letterAllChars.length));
letterTargetCharEl.textContent = letterCurrentChar;
clearLetterCanvas();
drawLetterGuide();
letterTargetCard.classList.remove('bounce', 'shake');
void letterTargetCard.offsetWidth;
letterTargetCard.classList.add('bounce');
updateLetterButton('check');
hideLetterFeedback();
}
function clearLetterCanvas() {
letterDrawCtx.clearRect(0, 0, letterDrawCanvas.width, letterDrawCanvas.height);
letterHasDrawnSomething = false;
if (letterIsLevelComplete) {
letterIsLevelComplete = false;
updateLetterButton('check');
hideLetterFeedback();
}
}
function updateLetterButton(state) {
letterMainBtn.innerHTML = '';
letterMainBtn.className = 'letter-action-btn';
if (state === 'check') {
letterMainBtn.textContent = "VerificƒÉ!";
letterMainBtn.onclick = handleLetterCheck;
} else if (state === 'skip') {
letterMainBtn.innerHTML = "<span>üîÑ AltƒÉ LiterƒÉ</span>";
letterMainBtn.classList.add('skip');
letterMainBtn.onclick = nextLetterLevel;
} else if (state === 'next') {
letterMainBtn.textContent = "UrmƒÉtoarea ‚û°Ô∏è";
letterMainBtn.classList.add('next');
letterMainBtn.onclick = nextLetterLevel;
}
}
function handleLetterAction() {
if(letterIsLevelComplete) nextLetterLevel();
}
function handleLetterCheck() {
if (!letterHasDrawnSomething) {
showLetterFeedback("DeseneazƒÉ pe contur!", "fail", "‚úèÔ∏è");
return;
}
const analysis = analyzeLetterDrawing();
if (analysis.matchRatio < 0.35) {
showLetterFeedback("Nu ai respectat conturul!", "fail", "ü§î");
letterTargetCard.classList.add('shake');
setTimeout(() => letterTargetCard.classList.remove('shake'), 500);
updateLetterButton('skip');
return;
}
winLetterLevel();
}
function analyzeLetterDrawing() {
const drawData = letterDrawCtx.getImageData(0, 0, letterDrawCanvas.width, letterDrawCanvas.height).data;
const guideData = letterGuideCtx.getImageData(0, 0, letterGuideCanvas.width, letterGuideCanvas.height).data;
let drawPixels = 0;
let guidePixels = 0;
let matchPixels = 0;
for (let i = 0; i < drawData.length; i += 4) {
const isDraw = drawData[i + 3] > 0;
const isGuide = guideData[i + 3] > 0;
if (isDraw) drawPixels++;
if (isGuide) guidePixels++;
if (isDraw && isGuide) matchPixels++;
}
if (guidePixels === 0) return { matchRatio: 0 };
const coverage = matchPixels / guidePixels;
const precision = matchPixels / (drawPixels || 1);
const score = (coverage * 0.7) + (precision * 0.3);
return { matchRatio: score };
}
function winLetterLevel() {
letterIsLevelComplete = true;
letterScore += 1;
letterScoreEl.textContent = letterScore;
showLetterFeedback("Bravo! E corect!", "success", "üåü");
updateLetterButton('next');
fireLetterConfetti();
}
function showLetterFeedback(text, type, icon) {
letterFeedbackText.textContent = text;
letterFeedbackIcon.textContent = icon;
letterFeedbackEl.className = `letter-feedback-overlay show ${type}`;
setTimeout(hideLetterFeedback, 2000);
}
function hideLetterFeedback() {
letterFeedbackEl.classList.remove('show');
}
let letterParticles = [];
function resizeLetterConfetti() {
letterConfettiCanvas.width = window.innerWidth;
letterConfettiCanvas.height = window.innerHeight;
}
window.addEventListener('resize', resizeLetterConfetti);
resizeLetterConfetti();
function fireLetterConfetti() {
const colors = ['#FF85A2', '#A2D2FF', '#FFC8DD', '#FFD93D'];
const centerX = window.innerWidth / 2;
const centerY = window.innerHeight / 2;
for (let i = 0; i < 80; i++) {
letterParticles.push({
x: centerX, y: centerY,
vx: (Math.random() - 0.5) * 15,
vy: (Math.random() - 0.5) * 15 - 5,
size: Math.random() * 8 + 4,
color: colors[Math.floor(Math.random() * colors.length)],
life: 100
});
}
animateLetterConfetti();
}
function animateLetterConfetti() {
letterConfettiCtx.clearRect(0, 0, letterConfettiCanvas.width, letterConfettiCanvas.height);
letterParticles.forEach((p, index) => {
p.x += p.vx; p.y += p.vy; p.vy += 0.5; p.life--;
letterConfettiCtx.fillStyle = p.color;
letterConfettiCtx.beginPath();
letterConfettiCtx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
letterConfettiCtx.fill();
if (p.life <= 0) letterParticles.splice(index, 1);
});
if (letterParticles.length > 0) requestAnimationFrame(animateLetterConfetti);
}

// Ini»õializare
initMath();
</script>

<!-- COMPONENTA REACT PENTRU JOCUL PIAN -->
<script type="text/babel">
    const { useState, useRef, useEffect } = React;

    const PianoWithFallingDots = () => {
      const [activeKeys, setActiveKeys] = useState(new Set());
      const [fallingDots, setFallingDots] = useState([]);
      const [currentSong, setCurrentSong] = useState('twinkle');
      const [isAutoMode, setIsAutoMode] = useState(true);
      const [speedMultiplier, setSpeedMultiplier] = useState(1.0);
      const [isSongFinished, setIsSongFinished] = useState(false);
      const audioContextRef = useRef(null);
      const currentSongIndexRef = useRef(0);
      
      // All piano keys needed (C4 to E5)
      const whiteKeys = [
        { id: 'C4', note: 'C', freq: 261.63, lyric: 'Do', x: 0 },
        { id: 'D4', note: 'D', freq: 293.66, lyric: 'Re', x: 32 },
        { id: 'E4', note: 'E', freq: 329.63, lyric: 'Mi', x: 64 },
        { id: 'F4', note: 'F', freq: 349.23, lyric: 'Fa', x: 96 },
        { id: 'G4', note: 'G', freq: 392.00, lyric: 'Sol', x: 128 },
        { id: 'A4', note: 'A', freq: 440.00, lyric: 'La', x: 160 },
        { id: 'B4', note: 'B', freq: 493.88, lyric: 'Si', x: 192 },
        { id: 'C5', note: 'C', freq: 523.25, lyric: 'Do!', x: 224 },
        { id: 'D5', note: 'D', freq: 587.33, lyric: 'Re!', x: 256 },
        { id: 'E5', note: 'E', freq: 659.25, lyric: 'Mi!', x: 288 }
      ];

      // Black keys (Eb4, Bb4, D#5)
      const blackKeys = [
        { id: 'Eb4', note: 'Eb', freq: 311.13, lyric: 'Mi‚ô≠', x: 48 },   // between D4 & E4
        { id: 'Bb4', note: 'Bb', freq: 466.16, lyric: 'Si‚ô≠', x: 176 },  // between A4 & B4
        { id: 'D#5', note: 'D#', freq: 622.25, lyric: 'Re#', x: 272 }   // between D5 & E5
      ];

      const allKeys = [...whiteKeys, ...blackKeys];

      const baseSongs = {
        fur_elise: {
          name: 'Fur Elise - Beethoven',
          lyrics: [
            'Fur', 'Elise', 'melodie', 'clasicƒÉ',
            'Piano', 'suav', '»ôi', 'plin', 'de', 'gratie',
            'A', 'minor', 'tonalitate', 'dulce',
            'Beethoven', 'a', 'scris', 'cu', 'dragoste',
            'Note', 'care', 'zboarƒÉ', 'ca', 'fluturi',
            '√én', 'fiecare', 'm√¢na', 'care', 'c√¢ntƒÉ',
            'Emo»õie', 'purƒÉ', '»ôi', 'eternƒÉ',
            'Fur', 'Elise', 'pentru', 'totdeauna'
          ],
          notes: [
            // A section (main theme) ‚Äî 16 notes
            'E5', 'D#5', 'E5', 'D#5', 'E5', 'B4', 'D5', 'C5',
            'A4', 'C5', 'E5', 'A5', 'B5',
            'E5', 'D#5', 'E5', 'D#5', 'E5', 'B4', 'D5', 'C5',
            'A4', 'C5', 'E5', 'A5', 'B5',
            // B section (contrast) - 16 notes
            'E5', 'C5', 'B4', 'A4', 'B4', 'C5',
            'E5', 'D#5', 'E5', 'D#5', 'E5', 'B4', 'D5', 'C5',
            'A4', 'C5', 'E5', 'A5', 'B5',
            // A' section (return) - 16 notes
            'E5', 'D#5', 'E5', 'D#5', 'E5', 'B4', 'D5', 'C5',
            'A4', 'C5', 'E5', 'A5', 'B5',
            'E5', 'D#5', 'E5', 'D#5', 'E5', 'B4', 'D5', 'C5',
            'A4', 'C5', 'E5', 'A5', 'B5',
            // C section (modulation) - 12 notes
            'E5', 'C5', 'B4', 'A4', 'B4', 'C5',
            'E5', 'C5', 'B4', 'A4', 'B4', 'C5',
            // Final A'' ‚Äî 8 notes
            'E5', 'D#5', 'E5', 'D#5', 'E5', 'B4', 'D5', 'C5'
          ].map(note => {
            // Fix: A5 and B5 don't exist in our range, map to lower octave
            if (note === 'A5') return 'A4';
            if (note === 'B5') return 'B4';
            return note;
          }),
          tempo: 320
        },
        twinkle: {
          name: 'Steaua Cuceritoare',
          lyrics: [
            'Steaua', 'steaua', 'stea', 'strƒÉlucitoare',
            'MƒÉ', 'minunez', 'ce', 'frumoasƒÉ', 'e»ôti',
            'Sus', 'deasupra', 'lumi', 'de', 'sus',
            'Ca', 'un', 'diamant', 'pe', 'cer'
          ],
          notes: [
            'C4', 'C4', 'G4', 'G4', 'A4', 'A4', 'G4',
            'F4', 'F4', 'E4', 'E4', 'D4', 'D4', 'C4',
            'G4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4',
            'G4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4',
            'C4', 'C4', 'G4', 'G4', 'A4', 'A4', 'G4',
            'F4', 'F4', 'E4', 'E4', 'D4', 'D4', 'C4'
          ],
          tempo: 500
        },
        happy: {
          name: 'La Mul»õi Ani',
          lyrics: [
            'La', 'mul»õi', 'ani', 'cu', 'bucurie',
            'La', 'mul»õi', 'ani', 'cu', 'sƒÉnƒÉtate',
            'La', 'mul»õi', 'ani', 'bine', 'cuvinte',
            'La', 'mul»õi', 'ani', 'cu', 'bine'
          ],
          notes: [
            'C4', 'C4', 'D4', 'C4', 'F4', 'E4',
            'C4', 'C4', 'D4', 'C4', 'G4', 'F4',
            'C4', 'C4', 'C5', 'A4', 'F4', 'E4', 'D4',
            'A4', 'A4', 'G4', 'F4', 'G4', 'F4'
          ],
          tempo: 600
        },
        row: {
          name: 'Frunza Verde',
          lyrics: [
            'FrunzƒÉ', 'verde', 'frunzƒÉ', 'verde',
            'Pe', 'codru', 'mare', 'mƒÉ-ntind',
            'VeselƒÉ', 'veselƒÉ', 'veselƒÉ', 'veselƒÉ',
            'Via»õa', 'mea', 'e', 'un', 'vis'
          ],
          notes: [
            'C4', 'C4', 'C4', 'D4', 'E4',
            'E4', 'D4', 'E4', 'F4', 'G4',
            'G4', 'G4', 'G4', 'G4', 'G4', 'G4',
            'E4', 'E4', 'E4', 'E4', 'E4', 'E4',
            'G4', 'G4', 'G4', 'G4', 'G4', 'G4',
            'C4', 'C4', 'C4', 'C4', 'C4', 'C4'
          ],
          tempo: 450
        },
        jingle: {
          name: 'Clopo»õei de CrƒÉciun',
          lyrics: [
            'Clopo»õei', 'clopo»õei', 'clopo»õei',
            'Clopo»õei', 'de', 'CrƒÉciun',
            'Oh', 'ce', 'bucurie', 'mare',
            'C√¢nd', 'sanie', 'zburƒÉtoare'
          ],
          notes: [
            'E4', 'E4', 'E4', 'E4', 'E4', 'E4', 'E4', 'G4', 'C4', 'D4', 'E4',
            'F4', 'F4', 'F4', 'F4', 'F4', 'E4', 'E4', 'E4', 'E4', 'D4', 'D4', 'E4', 'D4', 'G4'
          ],
          tempo: 400
        },
        mary: {
          name: "MƒÉrioara »ôi Mielu»õa",
          lyrics: [
            'MƒÉrioara', 'avea', 'o', 'mielu»õƒÉ',
            'Mielu»õa', 'albƒÉ', 'mielu»õa',
            'MƒÉrioara', 'avea', 'o', 'mielu»õƒÉ',
            'Cu', 'lana', 'albƒÉ', 'ca', 'zƒÉpada'
          ],
          notes: [
            'E4', 'D4', 'C4', 'D4', 'E4', 'E4', 'E4',
            'D4', 'D4', 'D4', 'E4', 'G4', 'G4',
            'E4', 'D4', 'C4', 'D4', 'E4', 'E4', 'E4', 'E4', 'D4', 'D4', 'E4', 'D4', 'C4'
          ],
          tempo: 500
        },
        abc: {
          name: 'Alfabetul Cantat',
          lyrics: [
            'A', 'B', 'C', 'D', 'E', 'F', 'G',
            'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P',
            'Q', 'R', 'S', 'T', 'U', 'V',
            'W', 'X', 'Y', '»ôi', 'Z'
          ],
          notes: [
            'C4', 'C4', 'G4', 'G4', 'A4', 'A4', 'G4',
            'F4', 'F4', 'E4', 'E4', 'D4', 'D4', 'C4',
            'G4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4',
            'G4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4',
            'C4', 'C4', 'G4', 'G4', 'A4', 'A4', 'G4',
            'F4', 'F4', 'E4', 'E4', 'D4', 'D4', 'C4'
          ],
          tempo: 480
        },
        old: {
          name: 'Mo»ô Ion »ôi FermƒÉ',
          lyrics: [
            'Mo»ô', 'Ion', 'are', 'o', 'fermƒÉ',
            'E-i-e-i-o',
            '»òi', 'pe', 'fermƒÉ', 'are', 'o', 'vacƒÉ',
            'E-i-e-i-o'
          ],
          notes: [
            'G4', 'G4', 'G4', 'D4', 'E4', 'E4', 'D4',
            'G4', 'G4', 'G4', 'D4', 'E4', 'E4', 'D4',
            'G4', 'B4', 'B4', 'A4', 'A4', 'G4',
            'D4', 'D4', 'C4', 'C4', 'D4', 'E4', 'D4', 'G4',
            'G4', 'G4', 'D4', 'E4', 'E4', 'D4'
          ],
          tempo: 550
        },
        barbi: {
          name: 'Lumea Barbie',
          lyrics: [
            '√én', 'o', 'lume', 'Barbie', 'strƒÉlucitoare',
            'Unde', 'visurile', 'zboarƒÉ', 'noaptea',
            'Castelul', 'roz', 'strƒÉluce»ôte',
            'Magia', 'curge', 'a»ôa', 'frumos'
          ],
          notes: [
            'C4', 'E4', 'G4', 'C5', 'G4', 'E4', 'C4',
            'D4', 'F4', 'A4', 'D5', 'A4', 'F4', 'D4',
            'E4', 'G4', 'B4', 'E5', 'B4', 'G4', 'E4',
            'C4', 'E4', 'G4', 'C5', 'G4', 'E4', 'C4'
          ],
          tempo: 520
        },
        rainbow: {
          name: 'C√¢ntecul Culorilor',
          lyrics: [
            'Ro»ôu', '»ôi', 'galben', '»ôi', 'roz', '»ôi', 'verde',
            'Mov', '»ôi', 'portocaliu', '»ôi', 'albastru',
            'Pot', 'sƒÉ', 'c√¢nt', 'curcubeul',
            'C√¢ntƒÉ', '»ôi', 'tu', 'cu', 'mine'
          ],
          notes: [
            'C4', 'D4', 'E4', 'F4', 'G4', 'A4', 'B4',
            'C5', 'B4', 'A4', 'G4', 'F4', 'E4', 'D4',
            'C4', 'E4', 'G4', 'C5', 'G4', 'E4', 'C4',
            'D4', 'F4', 'A4', 'D5', 'A4', 'F4', 'D4'
          ],
          tempo: 500
        },
        wheels: {
          name: 'Rotile de la Autobuz',
          lyrics: [
            'Rotile', 'de', 'la', 'autobuz',
            'Se', '√Ænv√¢rt', 'mereu',
            '»òi', 'trec', 'prin', 'tot', 'ora»ôul'
          ],
          notes: [
            'C4', 'C4', 'C4', 'G4', 'G4', 'G4',
            'A4', 'A4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4', 'D4', 'C4',
            'G4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4',
            'G4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4',
            'C4', 'C4', 'G4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4', 'C4'
          ],
          tempo: 450
        },
        spider: {
          name: 'PƒÉianjenul Micu»õ',
          lyrics: [
            'PƒÉianjenul', 'micu»õ', 'cƒÉ»õƒÉrƒÉtor',
            'Se', 'urcƒÉ', 'pe', 'jgheabul', 'de', 'apƒÉ',
            'Ploaia', 'cade', 'de', 'sus',
            '»òi', 'spalƒÉ', 'pƒÉianjenul', 'jos'
          ],
          notes: [
            'C4', 'D4', 'E4', 'C4', 'E4', 'G4', 'E4', 'C4',
            'D4', 'E4', 'F4', 'D4', 'F4', 'A4', 'F4', 'D4',
            'E4', 'G4', 'E4', 'C4', 'E4', 'G4', 'E4', 'C4',
            'C4', 'G4', 'G4', 'G4', 'E4', 'E4', 'E4', 'C4'
          ],
          tempo: 500
        },
        baa: {
          name: 'Miau Miau Oaia',
          lyrics: [
            'Miau', 'miau', 'oaia', 'neagrƒÉ',
            'Ai', 'l√¢nƒÉ', 'de', 'v√¢nzare',
            'Da', 'doamne', 'da', 'doamne',
            'Trei', 'sƒÉcule»õi', 'pline'
          ],
          notes: [
            'E4', 'E4', 'E4', 'E4', 'E4', 'E4', 'E4', 'G4',
            'C4', 'D4', 'E4', 'F4', 'F4', 'E4', 'E4', 'D4', 'D4',
            'E4', 'D4', 'C4', 'D4', 'E4', 'E4', 'E4',
            'D4', 'D4', 'E4', 'D4', 'C4'
          ],
          tempo: 550
        },
        star: {
          name: 'Steaua StrƒÉlucitoare',
          lyrics: [
            'Steaua', 'strƒÉlucitoare',
            'Prima', 'stea', 'seara',
            'Doresc', 'ca', 'sƒÉ', 'pot', 'sƒÉ',
            '√émi', '√Æmplinesc', 'dorin»õa'
          ],
          notes: [
            'C4', 'C4', 'G4', 'G4', 'A4', 'A4', 'G4',
            'F4', 'F4', 'E4', 'E4', 'D4', 'D4', 'C4',
            'G4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4',
            'G4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4',
            'C4', 'C4', 'G4', 'G4', 'A4', 'A4', 'G4',
            'F4', 'F4', 'E4', 'E4', 'D4', 'D4', 'C4'
          ],
          tempo: 600
        },
        buburuza: {
          name: 'Buburuza',
          lyrics: [
            'Buburuza', 'micu»õƒÉ', 'zburƒÉtoare',
            'Pe', 'grƒÉdina', 'noastrƒÉ', 's-a', 'a»ôezat',
            'Cu', 'puncte', 'ro»ôii', 'pe', 'spate',
            '»òi', 'z√¢mbe»ôte', 'luminii', 'de', 'soare'
          ],
          notes: [
            'C4', 'D4', 'E4', 'G4', 'E4', 'D4', 'C4',
            'D4', 'E4', 'F4', 'A4', 'F4', 'E4', 'D4',
            'E4', 'G4', 'E4', 'C4', 'E4', 'G4', 'E4', 'C4',
            'C4', 'G4', 'G4', 'G4', 'E4', 'E4', 'E4', 'C4'
          ],
          tempo: 500
        },
        florile: {
          name: 'Florile PrimƒÉverii',
          lyrics: [
            'Crini', '»ôi', 'lalele', 'frumoase',
            '√én', 'grƒÉdinƒÉ', '√Ænfloreau',
            'Garoafe', 'ro»ôii', '»ôi', 'albastre',
            'Soarele', 'le', '√ÆncƒÉlzea'
          ],
          notes: [
            'C4', 'C4', 'G4', 'G4', 'A4', 'A4', 'G4',
            'F4', 'F4', 'E4', 'E4', 'D4', 'D4', 'C4',
            'G4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4',
            'G4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4',
            'C4', 'C4', 'G4', 'G4', 'A4', 'A4', 'G4',
            'F4', 'F4', 'E4', 'E4', 'D4', 'D4', 'C4'
          ],
          tempo: 520
        },
        puii: {
          name: 'Puii de GƒÉinƒÉ',
          lyrics: [
            'Pui', 'pui', 'pui', 'micu»õei',
            'Sub', 'aripa', 'mamei', 'stau',
            'Cioc', 'cioc', 'cioc', 'mereu',
            'P√¢nƒÉ', 'cresc', '»ôi', 'zboarƒÉ', 'spre', 'cer'
          ],
          notes: [
            'E4', 'E4', 'E4', 'D4', 'D4', 'D4', 'E4', 'G4',
            'C4', 'D4', 'E4', 'F4', 'F4', 'E4', 'E4', 'D4', 'D4',
            'E4', 'D4', 'C4', 'D4', 'E4', 'E4', 'E4',
            'D4', 'D4', 'E4', 'D4', 'C4'
          ],
          tempo: 450
        },
        trenulet: {
          name: 'Trenule»õul Vesel',
          lyrics: [
            '»öu-»õu', 'trenule»õ', 'micu»õ',
            'Pe', '»ôine', 'merge', 'repede',
            'Prin', 'pƒÉdure', '»ôi', 'pe', 'c√¢mp',
            'La', 'gara', 'din', 'ora»ô'
          ],
          notes: [
            'C4', 'C4', 'D4', 'D4', 'E4', 'E4', 'D4', 'D4',
            'C4', 'C4', 'D4', 'D4', 'E4', 'E4', 'D4', 'D4',
            'C4', 'C4', 'G4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4', 'D4',
            'C4', 'C4', 'G4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4', 'D4'
          ],
          tempo: 400
        },
        copacul: {
          name: 'Copacul BƒÉtr√¢n',
          lyrics: [
            'Copac', 'bƒÉtr√¢n', 'cu', 'ramuri', 'mari',
            '√én', 'grƒÉdinƒÉ', 'stƒÉ', 'de', 'mult',
            'PƒÉsƒÉri', 'mici', '√Æn', 'el', 'cuibƒÉresc',
            '»òi', 'frunzele', 'lui', 'sunt', 'frumoase'
          ],
          notes: [
            'G4', 'G4', 'G4', 'D4', 'E4', 'E4', 'D4',
            'G4', 'G4', 'G4', 'D4', 'E4', 'E4', 'D4',
            'G4', 'B4', 'B4', 'A4', 'A4', 'G4',
            'D4', 'D4', 'C4', 'C4', 'D4', 'E4', 'D4', 'G4',
            'G4', 'G4', 'D4', 'E4', 'E4', 'D4'
          ],
          tempo: 550
        },
        baloane: {
          name: 'Baloane Colorate',
          lyrics: [
            'Baloane', 'roz', '»ôi', 'albastre',
            'ZboarƒÉ', 'spre', 'cerul', 'albastru',
            'Cu', 'm√¢na', 'le', 'legƒÉm', 'bine',
            'SƒÉ', 'nu', 'le', 'piardƒÉ', 'v√¢ntul'
          ],
          notes: [
            'C4', 'E4', 'G4', 'C5', 'G4', 'E4', 'C4',
            'D4', 'F4', 'A4', 'D5', 'A4', 'F4', 'D4',
            'E4', 'G4', 'B4', 'E5', 'B4', 'G4', 'E4',
            'C4', 'E4', 'G4', 'C5', 'G4', 'E4', 'C4'
          ],
          tempo: 500
        },
        ploaia: {
          name: 'Ploaia de PrimƒÉvarƒÉ',
          lyrics: [
            'Ploaie', 'micƒÉ', 'pic', 'pic', 'pic',
            'Pe', 'ferestre', '»ôi', 'pe', 'pƒÉm√¢nt',
            'UdƒÉ', 'florile', '»ôi', 'iarba',
            '»òi', 'face', 'totul', 'verde'
          ],
          notes: [
            'E4', 'D4', 'C4', 'D4', 'E4', 'E4', 'E4',
            'D4', 'D4', 'D4', 'E4', 'G4', 'G4',
            'E4', 'D4', 'C4', 'D4', 'E4', 'E4', 'E4', 'E4', 'D4', 'D4', 'E4', 'D4', 'C4'
          ],
          tempo: 600
        },
        fluture: {
          name: 'Fluturele Alb',
          lyrics: [
            'Fluture', 'alb', 'cu', 'aripi', 'mari',
            'ZboarƒÉ', 'printre', 'flori', 'de', 'toate',
            'Se', 'opre»ôte', 'pe', 'un', 'trandafir',
            '»òi', 'danseazƒÉ', '√Æn', 'lumina', 'soarelui'
          ],
          notes: [
            'C4', 'D4', 'E4', 'C4', 'E4', 'G4', 'E4', 'C4',
            'D4', 'E4', 'F4', 'D4', 'F4', 'A4', 'F4', 'D4',
            'E4', 'G4', 'E4', 'C4', 'E4', 'G4', 'E4', 'C4',
            'C4', 'G4', 'G4', 'G4', 'E4', 'E4', 'E4', 'C4'
          ],
          tempo: 520
        },
        minge: {
          name: 'Mingea Ro»ôie',
          lyrics: [
            'Minge', 'ro»ôie', 'sƒÉritƒÉtoare',
            'Pe', 'iarbƒÉ', 'verde', 'se', 'rostogole»ôte',
            'O', 'prind', '»ôi', 'o', 'arunc', 'spre', 'cer',
            '»òi', 'cade', '√Ænapoi', '√Æn', 'm√¢inile', 'mele'
          ],
          notes: [
            'C4', 'C4', 'G4', 'G4', 'A4', 'A4', 'G4',
            'F4', 'F4', 'E4', 'E4', 'D4', 'D4', 'C4',
            'G4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4',
            'G4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4',
            'C4', 'C4', 'G4', 'G4', 'A4', 'A4', 'G4',
            'F4', 'F4', 'E4', 'E4', 'D4', 'D4', 'C4'
          ],
          tempo: 480
        },
        stelele: {
          name: 'Steaua de pe Cer',
          lyrics: [
            'Steaua', 'mea', 'strƒÉlucitoare',
            'Pe', 'cer', 'de', 'noapte', 'strƒÉluce»ôti',
            'MƒÉ', 'g√¢ndesc', 'la', 'tine', 'mereu',
            'C√¢nd', '√Ænchid', 'ochii', '»ôi', 'vis',
            'Te', 'vƒÉd', 'z√¢mbind', 'din', '√ÆnƒÉl»õimi',
            '»òi', 'luminezi', 'calea', 'mea'
          ],
          notes: [
            'C4', 'D4', 'E4', 'F4', 'G4', 'A4', 'B4',
            'C5', 'B4', 'A4', 'G4', 'F4', 'E4', 'D4',
            'C4', 'E4', 'G4', 'C5', 'G4', 'E4', 'C4',
            'D4', 'F4', 'A4', 'D5', 'A4', 'F4', 'D4',
            'E4', 'G4', 'B4', 'E5', 'B4', 'G4', 'E4',
            'C4', 'E4', 'G4', 'C5', 'G4', 'E4', 'C4'
          ],
          tempo: 550
        },
        pescarus: {
          name: 'PescƒÉru»ôul Albastru',
          lyrics: [
            'PescƒÉru»ô', 'albastru', 'zburƒÉtor',
            'Deasupra', 'mƒÉrii', 'albastre',
            'CautƒÉ', 'pe»ôti', '»ôi', 'se', 'joacƒÉ',
            'Cu', 'valurile', 'mari'
          ],
          notes: [
            'E4', 'E4', 'E4', 'E4', 'E4', 'E4', 'E4', 'G4',
            'C4', 'D4', 'E4', 'F4', 'F4', 'E4', 'E4', 'D4', 'D4',
            'E4', 'D4', 'C4', 'D4', 'E4', 'E4', 'E4',
            'D4', 'D4', 'E4', 'D4', 'C4'
          ],
          tempo: 500
        },
        soarele: {
          name: 'Soarele RƒÉsare',
          lyrics: [
            'Soarele', 'rƒÉsare', 'diminea»õa',
            '√éncƒÉlze»ôte', 'pƒÉm√¢ntul', 'cu', 'lumina',
            'Florile', 'deschid', 'petalele',
            '»òi', 'ziua', '√Æncepe', 'frumoasƒÉ'
          ],
          notes: [
            'C4', 'C4', 'C4', 'G4', 'G4', 'G4',
            'A4', 'A4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4', 'D4', 'C4',
            'G4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4',
            'G4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4',
            'C4', 'C4', 'G4', 'G4', 'F4', 'F4', 'E4', 'E4', 'D4', 'C4'
          ],
          tempo: 450
        },
        norisor: {
          name: 'Norisorul Alb',
          lyrics: [
            'Norisor', 'alb', 'pe', 'cer',
            'Plute»ôte', 'lini»ôtit', 'deasupra',
            'Uneori', 'pl√¢nge', 'cu', 'ploaie',
            '»òi', 'apoi', 'z√¢mbe»ôte', 'cu', 'soare'
          ],
          notes: [
            'G4', 'G4', 'G4', 'D4', 'E4', 'E4', 'D4',
            'G4', 'G4', 'G4', 'D4', 'E4', 'E4', 'D4',
            'G4', 'B4', 'B4', 'A4', 'A4', 'G4',
            'D4', 'D4', 'C4', 'C4', 'D4', 'E4', 'D4', 'G4',
            'G4', 'G4', 'D4', 'E4', 'E4', 'D4'
          ],
          tempo: 520
        }
      };

      const songs = {};
      Object.entries(baseSongs).forEach(([key, song]) => {
        songs[key] = {
          ...song,
          tempo: Math.max(100, Math.round(song.tempo / speedMultiplier))
        };
      });

      const initAudioContext = () => {
        if (!audioContextRef.current) {
          audioContextRef.current = new (window.AudioContext || window.webkitAudioContext)();
        }
      };

      const playNote = (freq, lyric) => {
        initAudioContext();
        const oscillator = audioContextRef.current.createOscillator();
        const gainNode = audioContextRef.current.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContextRef.current.destination);
        
        oscillator.frequency.value = freq;
        oscillator.type = 'sine';
        
        const now = audioContextRef.current.currentTime;
        gainNode.gain.setValueAtTime(0, now);
        gainNode.gain.linearRampToValueAtTime(0.4, now + 0.01);
        gainNode.gain.linearRampToValueAtTime(0, now + 0.7);
        
        oscillator.start(now);
        oscillator.stop(now + 0.7);
      };

      const createFallingDot = () => {
        const song = songs[currentSong];
        if (currentSongIndexRef.current >= song.notes.length) {
          setIsSongFinished(true);
          setIsAutoMode(false);
          return;
        }
        
        const noteId = song.notes[currentSongIndexRef.current];
        const lyric = song.lyrics[currentSongIndexRef.current % song.lyrics.length];
        currentSongIndexRef.current++;
        
        const key = allKeys.find(k => k.id === noteId);
        if (key) {
          const isBlack = key.id.includes('b') || key.id.includes('#');
          const newDot = {
            id: Date.now() + Math.random(),
            x: key.x + (isBlack ? 8 : 16),
            y: 0,
            targetKey: key.id,
            lyric: lyric,
            freq: key.freq,
            size: isBlack ? 16 : 20,
            color: isBlack 
              ? `hsl(${Math.random() * 360}, 70%, 45%)` 
              : `hsl(${Math.random() * 360}, 80%, 65%)`
          };
          setFallingDots(prev => [...prev, newDot]);
        }
      };

      useEffect(() => {
        const song = songs[currentSong];
        if (isSongFinished || !isAutoMode) return;
        
        const interval = setInterval(() => {
          if (isAutoMode) {
            createFallingDot();
          }
        }, song.tempo);

        return () => clearInterval(interval);
      }, [currentSong, isAutoMode, speedMultiplier, isSongFinished]);

      useEffect(() => {
        const fallInterval = setInterval(() => {
          setFallingDots(prev => {
            const updatedDots = prev.map(dot => ({
              ...dot,
              y: dot.y + (4.0 * speedMultiplier)
            })).filter(dot => dot.y < 300);
            return updatedDots;
          });
        }, 30);

        return () => clearInterval(fallInterval);
      }, [speedMultiplier]);

      const handleDotReachedPiano = (dot) => {
        const key = allKeys.find(k => k.id === dot.targetKey);
        if (key) {
          playNote(dot.freq, dot.lyric);
          setActiveKeys(prev => new Set([...prev, key.id]));
          setTimeout(() => {
            setActiveKeys(prev => {
              const newSet = new Set(prev);
              newSet.delete(key.id);
              return newSet;
            });
          }, 300);
          
          setFallingDots(prev => prev.filter(d => d.id !== dot.id));
        }
      };

      const handleKeyPress = (key) => {
        playNote(key.freq, key.lyric);
        setActiveKeys(prev => new Set([...prev, key.id]));
        setTimeout(() => {
          setActiveKeys(prev => {
            const newSet = new Set(prev);
            newSet.delete(key.id);
            return newSet;
          });
        }, 300);
        
        setFallingDots(prev => {
          const index = prev.findIndex(dot => dot.targetKey === key.id);
          if (index !== -1) {
            return [...prev.slice(0, index), ...prev.slice(index + 1)];
          }
          return prev;
        });
      };

      const handleDotClick = (dot) => {
        setFallingDots(prev => prev.filter(d => d.id !== dot.id));
        handleDotReachedPiano(dot);
      };

      const changeSong = (songKey) => {
        setCurrentSong(songKey);
        currentSongIndexRef.current = 0;
        setFallingDots([]);
        setIsSongFinished(false);
        setIsAutoMode(true);
      };

      const handleSpeedChange = (e) => {
        const value = parseFloat(e.target.value);
        setSpeedMultiplier(value);
      };

      const restartSong = () => {
        currentSongIndexRef.current = 0;
        setFallingDots([]);
        setIsSongFinished(false);
        setIsAutoMode(true);
      };

      return (
        <div className="min-h-screen bg-gradient-to-b from-indigo-900 via-purple-900 to-pink-800 flex flex-col items-center justify-center p-4">
          <div className="text-center mb-6">
            <h1 className="text-4xl md:text-5xl font-bold text-white mb-2 cursive-text" style={{fontFamily:'Caveat,cursive'}}>
              Aventura Pianului Muzical
            </h1>
            <p className="text-purple-200 text-lg cursive-text" style={{fontFamily:'Caveat,cursive'}}>
              C√¢ntƒÉ √ÆmpreunƒÉ cu versurile care cad sau creeazƒÉ propria ta melodie! üéµ
            </p>
          </div>

          <div className="mb-6 max-w-4xl w-full">
            <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2">
              {Object.entries(baseSongs).map(([key, song]) => (
                <button
                  key={key}
                  onClick={() => changeSong(key)}
                  className={`px-2 py-2 rounded-lg font-medium transition-all duration-200 text-sm cursive-text ${
                    currentSong === key
                      ? 'bg-gradient-to-r from-yellow-400 to-orange-500 text-white shadow-lg'
                      : 'bg-white/20 text-purple-200 hover:bg-white/30'
                  }`}
                  style={{fontFamily:'Caveat,cursive'}}
                >
                  {song.name}
                </button>
              ))}
            </div>
          </div>

          <div className="mb-6 flex flex-col items-center w-full max-w-md">
            <div className="flex items-center gap-4 mb-2 w-full">
              <span className="text-white cursive-text font-medium" style={{fontFamily:'Caveat,cursive'}}>√éncet</span>
              <input
                type="range"
                min="0.5"
                max="2.0"
                step="0.1"
                value={speedMultiplier}
                onChange={handleSpeedChange}
                className="w-full h-2 bg-purple-300 rounded-lg appearance-none cursor-pointer"
              />
              <span className="text-white cursive-text font-medium" style={{fontFamily:'Caveat,cursive'}}>Repede</span>
            </div>
            <div className="text-purple-200 cursive-text text-sm" style={{fontFamily:'Caveat,cursive'}}>
              VitezƒÉ: {speedMultiplier.toFixed(1)}x
            </div>
          </div>

          <div className="mb-6 flex gap-3">
            <button
              onClick={() => setIsAutoMode(!isAutoMode)}
              className={`px-4 py-2 rounded-full font-medium transition-all duration-200 cursive-text ${
                isAutoMode
                  ? 'bg-gradient-to-r from-green-400 to-emerald-500 text-white shadow-lg'
                  : 'bg-gradient-to-r from-purple-400 to-pink-500 text-white shadow-lg'
              }`}
              style={{fontFamily:'Caveat,cursive'}}
            >
              {isAutoMode ? 'Mod Auto: ON' : 'JoacƒÉ Liber: ON'}
            </button>
            
            {isSongFinished && (
              <button
                onClick={restartSong}
                className="px-4 py-2 bg-gradient-to-r from-blue-400 to-cyan-500 text-white rounded-full font-medium cursive-text shadow-lg hover:shadow-xl transition-all duration-200"
                style={{fontFamily:'Caveat,cursive'}}
              >
                Reia C√¢ntecul
              </button>
            )}
          </div>

          <div className="relative" style={{ width: '320px', height: '340px' }}>
            {fallingDots.map(dot => (
              <div
                key={dot.id}
                className="absolute rounded-full shadow-lg transform -translate-x-1/2 -translate-y-1/2 cursor-pointer transition-all duration-200 hover:scale-125"
                style={{
                  left: `${dot.x}px`,
                  top: `${dot.y}px`,
                  width: `${dot.size}px`,
                  height: `${dot.size}px`,
                  backgroundColor: dot.color,
                  boxShadow: `0 0 15px ${dot.color}cc, 0 0 30px ${dot.color}80`
                }}
                onClick={() => handleDotClick(dot)}
              >
                <div className="w-full h-full flex items-center justify-center">
                  <span className="text-white font-bold text-xs drop-shadow-md cursive-text" style={{fontFamily:'Caveat,cursive'}}>
                    {dot.lyric}
                  </span>
                </div>
              </div>
            ))}

            {/* Black keys */}
            <div className="absolute bottom-0 left-0 flex" style={{ width: '320px', height: '36px', zIndex: 20 }}>
              {blackKeys.map(key => (
                <button
                  key={key.id}
                  className={`absolute w-4 h-24 bg-black rounded-b-none shadow-lg z-20
                    ${activeKeys.has(key.id) 
                      ? 'bg-gradient-to-b from-gray-700 to-gray-800 transform -translate-y-2 ring-4 ring-gray-400 shadow-2xl' 
                      : 'hover:bg-gray-800 hover:shadow-xl'}
                    transition-all duration-150 ease-in-out cursor-pointer flex flex-col items-center justify-end pb-1`}
                  style={{ left: `${key.x}px` }}
                  onClick={() => handleKeyPress(key)}
                >
                  <div className="text-gray-300 font-bold text-xs mb-1 cursive-text" style={{fontFamily:'Caveat,cursive'}}>
                    {key.note}
                  </div>
                  <div className="text-gray-400 font-medium text-[8px] cursive-text" style={{fontFamily:'Caveat,cursive'}}>
                    {key.lyric}
                  </div>
                </button>
              ))}
            </div>

            {/* White keys */}
            <div className="absolute bottom-0 left-0 flex" style={{ width: '320px' }}>
              {whiteKeys.map(key => (
                <button
                  key={key.id}
                  className={`w-8 h-36 bg-white border-r border-gray-300 last:border-r-0 rounded-t-none shadow-lg relative
                    ${activeKeys.has(key.id) 
                      ? 'bg-gradient-to-b from-cyan-300 to-cyan-200 transform -translate-y-2 ring-4 ring-cyan-400 shadow-2xl z-30' 
                      : 'hover:bg-gray-100 hover:shadow-xl z-10'}
                    transition-all duration-150 ease-in-out cursor-pointer flex flex-col items-center justify-end pb-2`}
                  onClick={() => handleKeyPress(key)}
                >
                  <div className="text-gray-700 font-bold text-base mb-1 cursive-text" style={{fontFamily:'Caveat,cursive'}}>
                    {key.note}
                  </div>
                  <div className="text-gray-600 font-medium text-xs cursive-text" style={{fontFamily:'Caveat,cursive'}}>
                    {key.lyric}
                  </div>
                </button>
              ))}
            </div>

            <div className="absolute bottom-0 left-0 w-full h-36 bg-gradient-to-t from-amber-900 via-amber-800 to-amber-700 rounded-t-lg z-0 border-t-4 border-amber-950" />
          </div>

          <div className="mt-8 text-center max-w-md">
            <div className="bg-white/10 backdrop-blur-sm rounded-lg p-4 border border-white/20">
              <p className="text-purple-200 text-sm leading-relaxed cursive-text" style={{fontFamily:'Caveat,cursive'}}>
                Alege dintre <strong>24 de c√¢ntece</strong>, inclusiv <strong>Fur Elise</strong> autentic! 
                Toate versurile apar mereu pe punctele cƒÉzƒÉtoare. ‚ú®
              </p>
            </div>
          </div>
        </div>
      );
    };
</script>

</body>
</html>

