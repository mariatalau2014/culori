<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Super Jocuri Compact</title>
<link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;700&family=Comic+Sans+MS&display=swap" rel="stylesheet">
<style>
/* --- STILURI COMPACTE --- */
:root {
--boy-bg: #E3F2FD; --boy-primary: #2196F3; --boy-secondary: #4FC3F7;
--girl-bg: #FCE4EC; --girl-primary: #EC407A; --girl-secondary: #F48FB1;
--pro-bg: #263238; --pro-card: #37474F; --pro-text: #ECEFF1; --pro-accent: #00E5FF;
--text-color: #455A64; --card-bg: #FFFFFF; --success: #66BB6A; --error: #EF5350;
--gold: #FFD700; --silver: #C0C0C0; --bronze: #CD7F32;
--letter-primary: #FF85A2; --letter-secondary: #A2D2FF; --letter-accent: #FFC8DD;
}
* { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Comic Sans MS', sans-serif; user-select: none; -webkit-tap-highlight-color: transparent; }
body { background-color: var(--girl-bg); color: var(--text-color); min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; overflow-x: hidden; padding-top: 10px; transition: background 0.5s; }
body.boy-theme { background-color: var(--boy-bg); }
body.pro-theme { background-color: var(--pro-bg); color: var(--pro-text); }

/* Container Principal Mic */
.container { width: 95%; max-width: 400px; text-align: center; padding: 5px; }
h1 { font-size: 1.6rem; margin: 5px 0 10px 0; color: var(--girl-primary); font-family: 'Fredoka One', cursive; text-shadow: 1px 1px 0 #FFF; }
body.boy-theme h1 { color: var(--boy-primary); text-shadow: none; }
body.pro-theme h1 { color: var(--pro-accent); text-shadow: 0 0 5px rgba(0,229,255,0.5); }

/* Meniu Grid Compact */
.menu-grid, .sub-menu-grid { display: grid; grid-template-columns: 1fr; gap: 8px; width: 100%; }
.big-card, .card { background: var(--card-bg); border-radius: 12px; padding: 10px; cursor: pointer; transition: transform 0.2s; box-shadow: 0 4px 0 rgba(0,0,0,0.1); border: 2px solid #FFF; display: flex; align-items: center; gap: 10px; min-height: 70px; position: relative; }
body.pro-theme .big-card, body.pro-theme .card { background: var(--pro-card); border: 1px solid var(--pro-accent); color: var(--pro-text); }
.big-card:active, .card:active { transform: translateY(2px); box-shadow: 0 2px 0 rgba(0,0,0,0.1); }
.big-card-icon, .card-icon { font-size: 2rem; flex-shrink: 0; }
.big-card-content, .card-title-wrap { flex: 1; text-align: left; }
.big-card-title, .card-title { font-weight: 900; font-size: 1rem; line-height: 1.2; font-family: 'Fredoka One', cursive; }
.big-card-desc, .card-desc { font-size: 0.75rem; opacity: 0.8; margin-top: 2px; }
.card.kg-card { border-bottom: 3px solid var(--boy-primary); }
.card.easy-card { border-bottom: 3px solid var(--girl-secondary); }
.card.pro-card { border-bottom: 3px solid var(--pro-accent); }

/* Zona de Joc CompactƒÉ */
.game-area { display: none; background: var(--card-bg); border-radius: 15px; padding: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); width: 100%; border: 3px solid var(--girl-secondary); margin-top: 10px; }
body.boy-theme .game-area { border-color: var(--boy-secondary); }
body.pro-theme .game-area { border-color: var(--pro-accent); background: var(--pro-card); color: var(--pro-text); }

.stats-bar { display: flex; justify-content: space-between; font-size: 0.9rem; font-weight: 800; background: #F8BBD0; padding: 5px 10px; border-radius: 20px; margin-bottom: 8px; }
body.boy-theme .stats-bar { background: #BBDEFB; color: var(--boy-primary); }
body.pro-theme .stats-bar { background: var(--pro-accent); color: var(--pro-bg); }

.timer-container { width: 100%; height: 8px; background: #eee; border-radius: 4px; margin-bottom: 8px; overflow: hidden; }
.timer-bar { height: 100%; width: 100%; background: var(--success); transition: width 1s linear; }

.visual-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 5px; margin: 5px 0; min-height: 40px; }
.visual-item { font-size: 1.5rem; animation: bounce 1.5s infinite; }
@keyframes bounce { 50% { transform: translateY(-5px); } }

.sequence-display, .problem-display { font-size: 2rem; font-weight: 900; margin: 5px 0; color: var(--girl-primary); }
body.boy-theme .problem-display { color: var(--boy-primary); }
body.pro-theme .problem-display { color: var(--pro-accent); }
.missing-number { color: var(--girl-primary); border-bottom: 2px dashed currentColor; }

/* Input »ôi Butoane Mici */
.input-group { display: flex; gap: 5px; justify-content: center; margin: 8px 0; }
input[type="number"] { width: 80px; padding: 5px; font-size: 1.5rem; text-align: center; border: 2px solid var(--girl-secondary); border-radius: 8px; background: #FFF; }
body.pro-theme input { border-color: var(--pro-accent); background: #263238; color: white; }

.choices-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; margin-top: 10px; }
.choice-btn { background: white; border: 2px solid var(--boy-secondary); border-radius: 10px; padding: 10px 5px; font-size: 1.2rem; font-weight: 900; color: var(--boy-primary); box-shadow: 0 3px 0 #0277BD; }
body.pro-theme .choice-btn { background: #37474F; border-color: var(--pro-accent); color: var(--pro-accent); box-shadow: 0 3px 0 #00838F; }
.choice-btn:active { transform: translateY(3px); box-shadow: none; }

.btn { padding: 8px 15px; font-size: 0.9rem; border: none; border-radius: 20px; cursor: pointer; font-weight: 900; color: white; box-shadow: 0 3px 0 rgba(0,0,0,0.2); }
.btn:active { transform: translateY(2px); box-shadow: none; }
.btn-primary { background: var(--girl-primary); box-shadow: 0 3px 0 #C2185B; }
body.boy-theme .btn-primary { background: var(--boy-primary); box-shadow: 0 3px 0 #1565C0; }
body.pro-theme .btn-primary { background: var(--pro-accent); color: var(--pro-bg); box-shadow: 0 3px 0 #00838F; }
.btn-secondary { background: #B0BEC5; box-shadow: 0 3px 0 #78909C; font-size: 0.8rem; padding: 6px 12px; margin-top: 5px; }

.feedback { height: 1.2rem; font-size: 0.9rem; font-weight: bold; margin: 5px 0; }
.feedback.correct { color: var(--success); }
.feedback.wrong { color: var(--error); }

.back-btn { position: absolute; top: 5px; left: 5px; background: white; border: none; padding: 5px 10px; border-radius: 15px; font-size: 0.8rem; font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.2); z-index: 10; color: var(--girl-primary); }
body.pro-theme .back-btn { background: var(--pro-accent); color: var(--pro-bg); }

/* Ecrane Premiu/Clasament Compacte */
.award-container, .leaderboard-container { display: none; flex-direction: column; align-items: center; background: white; padding: 15px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.2); width: 95%; max-width: 350px; margin: 10px auto; }
.award-icon { font-size: 4rem; margin: 5px 0; }
.award-title { font-size: 1.5rem; font-weight: 900; margin-bottom: 5px; text-transform: uppercase; }
.final-score { font-size: 1.1rem; font-weight: bold; margin-bottom: 10px; }
.name-input-group { margin: 10px 0; display: flex; flex-direction: column; gap: 5px; width: 100%; }
.name-input-group input { width: 100%; font-size: 1rem; padding: 5px; border: 1px solid #ccc; border-radius: 5px; }
.leaderboard-table { width: 100%; font-size: 0.8rem; border-collapse: collapse; margin: 5px 0; }
.leaderboard-table th { background: var(--girl-primary); color: white; padding: 4px; }
body.pro-theme .leaderboard-table th { background: var(--pro-accent); color: var(--pro-bg); }
.leaderboard-table td { padding: 4px; border-bottom: 1px solid #eee; text-align: center; }

/* Joc SƒÉrituri Fullscreen */
#jumpGameContainer { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #222; z-index: 200; touch-action: none; }
#jumpCanvas { display: block; width: 100%; height: 100%; }
#jumpUI { position: absolute; top: 10px; left: 10px; color: white; font-size: 14px; font-weight: bold; text-shadow: 1px 1px 2px black; z-index: 10; }
#jumpMenu, #jumpWinScreen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); display: flex; flex-direction: column; justify-content: center; align-items: center; color: white; z-index: 20; padding: 20px; text-align: center; }
#jumpWinScreen { background: rgba(46, 213, 115, 0.9); display: none; }
#jumpMenu h1 { font-size: 1.5rem; color: white; text-shadow: none; margin-bottom: 15px; }
#jumpMenu p { font-size: 0.9rem; margin: 10px 0; }

/* Joc Litere Compact */
#letterGameContainer { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #FFF0F5; z-index: 200; touch-action: none; }
.letter-card-ui { background: rgba(255,255,255,0.95); width: 95%; height: 95%; max-height: 500px; border-radius: 15px; margin: 2.5% auto; display: flex; flex-direction: column; align-items: center; padding: 10px; position: relative; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
.letter-header h1 { font-size: 1.2rem; margin: 0; color: var(--letter-primary); }
.letter-score { font-size: 0.9rem; background: var(--letter-secondary); color: white; padding: 2px 8px; border-radius: 10px; display: inline-block; margin-top: 2px; }
.letter-play-area { flex: 1; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 8px; }
.letter-card-display { width: 60px; height: 60px; border-radius: 12px; background: var(--letter-accent); display: flex; justify-content: center; align-items: center; font-size: 2.5rem; font-family: 'Fredoka One'; color: var(--letter-primary); box-shadow: 0 4px 0 #FFB3C6; position: relative; }
.letter-canvas-container { position: relative; width: 100%; max-width: 250px; aspect-ratio: 1; background: white; border: 2px dashed var(--letter-secondary); border-radius: 12px; }
.letter-canvas-container canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 10px; }
#guideCanvas { z-index: 1; pointer-events: none; }
#drawCanvas { z-index: 2; }
.letter-clear-btn { position: absolute; top: 2px; right: 2px; width: 24px; height: 24px; background: #FFD1DC; border: none; border-radius: 50%; z-index: 10; display: flex; align-items: center; justify-content: center; }
.letter-clear-btn svg { width: 12px; height: 12px; fill: #D65A78; }
.letter-action-btn { width: 90%; max-width: 200px; padding: 8px; font-size: 1rem; background: var(--letter-primary); color: white; border: none; border-radius: 20px; font-weight: bold; box-shadow: 0 3px 0 #D65A78; margin-top: auto; }
.letter-action-btn:active { transform: translateY(3px); box-shadow: none; }
.letter-feedback-overlay { position: absolute; inset: 0; background: rgba(255,255,255,0.9); display: flex; flex-direction: column; justify-content: center; align-items: center; font-size: 2rem; font-weight: bold; border-radius: 15px; opacity: 0; pointer-events: none; transition: opacity 0.3s; z-index: 100; }
.letter-feedback-overlay.show { opacity: 1; }
.letter-mascot-img { position: absolute; top: -20px; right: -15px; width: 50px; }

/* Joc Coordonate Compact */
#coordGameContainer { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #4b0082; z-index: 200; color: white; overflow-y: auto; }
.coord-wrapper { display: flex; flex-direction: column; align-items: center; padding: 5px; min-height: 100vh; }
.coord-h1 { font-size: 1.1rem; margin: 5px 0; color: #ffd700; font-family: 'Fredoka One'; }
.coord-p { font-size: 0.75rem; margin: 0 0 5px 0; color: #ddd; text-align: center; }
#coord-board-wrapper { display: grid; grid-template-columns: 25px 1fr; grid-template-rows: 25px 1fr; gap: 1px; background: #ccc; border: 3px solid #ffd700; }
.corner-box, .axis-number, .cell-coord { display: flex; justify-content: center; align-items: center; }
.axis-number { background: #2a0a4a; color: #ffd700; font-size: 0.7rem; font-weight: bold; }
.cell-coord { background: #f9f9f9; width: 25px; height: 25px; cursor: pointer; position: relative; }
.cell-coord.highlight { background: #e0e0e0; animation: blink 0.5s infinite; }
@keyframes blink { 50% { background: #fff; } }
.crystal { width: 60%; height: 60%; border-radius: 2px; transform: rotate(45deg); box-shadow: inset 1px 1px 3px rgba(255,255,255,0.8), 0 0 4px currentColor; }
#coord-controls { margin-top: 8px; display: flex; gap: 5px; flex-wrap: wrap; justify-content: center; background: rgba(0,0,0,0.4); padding: 8px; border-radius: 10px; width: 95%; }
.color-btn { width: 24px; height: 24px; border-radius: 50%; border: 1px solid white; opacity: 0.6; }
.color-btn.auto-selected { border: 2px solid yellow; transform: scale(1.2); opacity: 1; box-shadow: 0 0 10px yellow; }
.action-btn-coord { padding: 6px 10px; border: none; border-radius: 5px; font-size: 0.75rem; font-weight: bold; color: white; }
.btn-start { background: #4CAF50; }
.btn-clear { background: #d32f2f; border: 1px solid yellow; }
.btn-undo { background: #2196F3; width: 30px; height: 30px; padding: 0; display: flex; align-items: center; justify-content: center; }
#status-box { margin-top: 5px; padding: 5px; background: rgba(255,255,255,0.1); border-radius: 5px; font-size: 0.8rem; text-align: center; min-height: 20px; color: #ffd700; }

</style>
</head>
<body>

<!-- Meniu Principal -->
<div class="container" id="mainContainer">
<h1>Super Jocuri</h1>
<div class="menu-grid">
<div class="big-card" onclick="openMathMenu()">
<div class="big-card-icon">üßÆ</div>
<div class="big-card-content">
<div class="big-card-title">MatematicƒÉ</div>
<div class="big-card-desc">Calcule »ôi »ôiruri</div>
</div>
</div>
<div class="big-card" onclick="openJumpGame()">
<div class="big-card-icon">ü¶ï</div>
<div class="big-card-content">
<div class="big-card-title">SƒÉrituri</div>
<div class="big-card-desc">Aventura eroului</div>
</div>
</div>
<div class="big-card" onclick="openLetterGame()">
<div class="big-card-icon">‚úèÔ∏è</div>
<div class="big-card-content">
<div class="big-card-title">Litere</div>
<div class="big-card-desc">DeseneazƒÉ contururi</div>
</div>
</div>
<div class="big-card" onclick="openCoordGame()">
<div class="big-card-icon">üíé</div>
<div class="big-card-content">
<div class="big-card-title">Coordonate</div>
<div class="big-card-desc">GƒÉse»ôte pozi»õia</div>
</div>
</div>
</div>
</div>

<!-- Interfa»õƒÉ MatematicƒÉ -->
<button class="back-btn" id="mathBackBtn" style="display:none;" onclick="showMainMenu()">‚Üê</button>
<div class="container" id="mathContainer" style="display:none;">
<div id="mathMainMenu"><h1>Alege Nivelul</h1><div class="sub-menu-grid" id="mathMenuGrid"></div><button class="btn btn-secondary" onclick="showMainMenu()" style="margin-top:10px; width:100%">√énapoi</button></div>
<div id="mathSubMenu" style="display:none;"><h2 id="mathSubMenuTitle" style="font-size:1.2rem; margin:5px 0;">ActivitƒÉ»õi:</h2><div class="sub-menu-grid" id="mathSubMenuGrid"></div><button class="btn btn-secondary" onclick="openMathMenu()" style="margin-top:10px; width:100%">√énapoi</button></div>
<div id="mathGameArea" class="game-area">
<div class="stats-bar"><span id="mathScoreDisplay">Scor: 100</span><span id="mathProgressDisplay">1/20</span></div>
<div class="timer-container"><div class="timer-bar" id="mathTimerBar"></div></div>
<div id="mathGameContent"></div>
<div id="mathChoicesContainer" class="choices-grid" style="display:none;"></div>
<div id="mathInputContainer" class="input-group" style="display:none;">
<input type="number" id="mathAnswerInput" placeholder="?">
<button class="btn btn-primary" onclick="checkMathAnswer()">OK</button>
</div>
<div class="feedback" id="mathFeedbackText"></div>
<button class="btn btn-secondary" onclick="openMathMenu()" style="width:100%">Ie»ôire</button>
</div>
<div id="mathAwardScreen" class="award-container">
<div class="award-icon" id="mathAwardIcon">üèÜ</div>
<div class="award-title" id="mathAwardTitle">Premiul 1</div>
<div class="final-score" id="mathFinalScoreText">Scor: 100</div>
<div class="name-input-group" id="mathNameInputGroup" style="display:none;">
<label>Nume:</label><input type="text" id="mathPlayerName" placeholder="Nume...">
<button class="btn btn-primary" onclick="saveMathScore()">SalveazƒÉ</button>
</div>
<button class="btn btn-secondary" id="mathCloseAwardBtn" onclick="openMathMenu()" style="display:none; width:100%">√énapoi</button>
</div>
<div id="mathLeaderboardScreen" class="leaderboard-container">
<h2 style="font-size:1.2rem; margin-bottom:5px;">Clasament</h2>
<table class="leaderboard-table"><thead><tr><th>#</th><th>Nume</th><th>Scor</th></tr></thead><tbody id="mathLeaderboardBody"></tbody></table>
<button class="btn btn-secondary" onclick="openMathMenu()" style="width:100%">√énapoi</button>
</div>
</div>

<!-- Joc SƒÉrituri -->
<div id="jumpGameContainer">
<canvas id="jumpCanvas"></canvas>
<div id="jumpUI"><div>‚≠ê <span id="jumpScoreVal">0</span></div><div>üö© <span id="jumpStationVal">0</span>/15</div></div>
<div id="jumpMenu">
<h1>Alege Eroul</h1>
<div style="display:flex; gap:10px; margin-bottom:15px;">
<button class="btn" id="jumpBtnGirl" onclick="setJumpChar('girl')" style="background:#EC407A">üåü Fata</button>
<button class="btn" id="jumpBtnBoy" onclick="setJumpChar('boy')" style="background:#2196F3">ü¶ï BƒÉiat</button>
</div>
<button class="btn" id="jumpStartBtn" onclick="startJumpGame()" style="background:#2ed573; font-size:1.1rem; padding:10px 20px;">START</button>
<p>ApasƒÉ oriunde pentru a sƒÉri!</p>
<button class="btn btn-secondary" onclick="closeJumpGame()">Ie»ôire</button>
</div>
<div id="jumpWinScreen">
<h1 style="color:white; font-size:2rem;">VICTORIE! üèÜ</h1>
<p>Ai trecut toate sta»õiile!</p>
<button class="btn" onclick="closeJumpGame()" style="background:white; color:#2ed573; margin-top:15px;">Meniu</button>
</div>
</div>

<!-- Joc Litere -->
<div id="letterGameContainer">
<div class="letter-card-ui">
<header class="letter-header"><h1>Litere</h1><div class="letter-score">‚≠ê <span id="letterScore">0</span></div></header>
<div class="letter-play-area">
<div class="letter-card-display" id="letterTargetCard"><span id="letterTargetChar">A</span><img src="https://image.qwenlm.ai/public_source/9d076338-2b12-4553-8888-4cf6f0866228/173d93ddf-8170-4865-8cf4-97af1e0962e2.png" class="letter-mascot-img"></div>
<div class="letter-canvas-container">
<canvas id="guideCanvas"></canvas><canvas id="drawCanvas"></canvas>
<button class="letter-clear-btn" onclick="clearLetterCanvas()"><svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg></button>
</div>
<button id="letterMainBtn" class="letter-action-btn" onclick="handleLetterAction()">VerificƒÉ!</button>
</div>
<div class="letter-feedback-overlay" id="letterFeedback"><div id="letterFeedbackIcon" style="font-size:3rem">üéâ</div><div id="letterFeedbackText">Bravo!</div></div>
<button class="btn btn-secondary" onclick="closeLetterGame()" style="position:absolute; bottom:5px; left:5px; font-size:0.7rem; padding:4px 8px;">Ie»ôire</button>
</div>
</div>

<!-- Joc Coordonate -->
<div id="coordGameContainer">
<div class="coord-wrapper">
<h1 class="coord-h1">Coordonate</h1>
<p class="coord-p">Culoarea se schimbƒÉ automat. GƒÉse»ôte locul!</p>
<div id="coord-board-wrapper"><div class="corner-box">X/Y</div><div id="axis-x"></div><div id="axis-y"></div><div id="game-area-coord"></div></div>
<div id="status-box">ApasƒÉ Start!</div>
<div id="coord-controls">
<div class="color-btn" style="background:#ff0000" data-color="#ff0000"></div>
<div class="color-btn" style="background:#ff8c00" data-color="#ff8c00"></div>
<div class="color-btn" style="background:#ffd700" data-color="#ffd700"></div>
<div class="color-btn" style="background:#008000" data-color="#008000"></div>
<div class="color-btn" style="background:#1e90ff" data-color="#1e90ff"></div>
<div class="color-btn" style="background:#4b0082" data-color="#4b0082"></div>
<div class="color-btn" style="background:#ffffff" data-color="#ffffff"></div>
<button class="action-btn-coord btn-start" onclick="startCoordGame()">Start</button>
<button class="action-btn-coord btn-undo" id="undoBtn" onclick="undoLast()">‚Ü©</button>
<button class="action-btn-coord btn-clear" onclick="clearGridNow()">»òterge</button>
</div>
<button class="btn btn-secondary" onclick="closeCoordGame()" style="margin-top:5px; font-size:0.8rem;">√énapoi</button>
</div>
</div>

<script>
// ==========================================
// LOGICA GENERALƒÇ
// ==========================================
function showMainMenu() {
document.getElementById('mainContainer').style.display = 'block';
document.getElementById('mathContainer').style.display = 'none';
document.getElementById('mathBackBtn').style.display = 'none';
closeJumpGame(); closeLetterGame(); closeCoordGame();
}
function openMathMenu() {
document.getElementById('mainContainer').style.display = 'none';
document.getElementById('mathContainer').style.display = 'block';
document.getElementById('mathBackBtn').style.display = 'block';
document.getElementById('mathBackBtn').onclick = showMainMenu;
document.getElementById('mathMainMenu').style.display = 'block';
document.getElementById('mathSubMenu').style.display = 'none';
document.getElementById('mathGameArea').style.display = 'none';
document.getElementById('mathAwardScreen').style.display = 'none';
document.getElementById('mathLeaderboardScreen').style.display = 'none';
renderMathMainMenu();
}
function openJumpGame() { document.getElementById('mainContainer').style.display = 'none'; document.getElementById('mathContainer').style.display = 'none'; document.getElementById('jumpGameContainer').style.display = 'block'; initJumpGame(); }
function closeJumpGame() { jumpGameRunning = false; document.getElementById('jumpGameContainer').style.display = 'none'; document.getElementById('jumpMenu').style.display = 'flex'; document.getElementById('jumpWinScreen').style.display = 'none'; }
function openLetterGame() { document.getElementById('mainContainer').style.display = 'none'; document.getElementById('mathContainer').style.display = 'none'; document.getElementById('letterGameContainer').style.display = 'block'; initLetterGame(); }
function closeLetterGame() { document.getElementById('letterGameContainer').style.display = 'none'; }
function openCoordGame() { document.getElementById('mainContainer').style.display = 'none'; document.getElementById('mathContainer').style.display = 'none'; document.getElementById('coordGameContainer').style.display = 'block'; initCoordGame(); }
function closeCoordGame() { document.getElementById('coordGameContainer').style.display = 'none'; }

// ==========================================
// LOGICA MATEMATICƒÇ
// ==========================================
let mathCurrentMode = '', mathScore = 100, mathCurrentAnswer = 0, mathTimeLeft = 0, mathMaxTime = 0, mathTimerInterval, mathDifficultyLevel = 1, mathProblemHTML = '', mathQuestionCount = 0, mathCurrentSubMenuKey = '', isMathGameEnding = false;
const MAX_QUESTIONS = 20;
const mathMenus = {
'kg': { title: 'GrƒÉdini»õƒÉ', theme: 'boy', items: [{id:'kg_count', icon:'üöó', title:'NumƒÉrƒÉ', desc:'C√¢te sunt?'}, {id:'kg_sequence', icon:'ü§ñ', title:'»òir', desc:'ContinuƒÉ »ôirul'}, {id:'kg_add', icon:'‚öΩ', title:'AdunƒÉ', desc:'AdunƒÉ vizual'}] },
'easy_menu': { title: 'Clasa 1-2 (FƒÉrƒÉ Trecere)', theme: 'girl', items: [{id:'easy_math', icon:'ü¶Ñ', title:'Calcule', desc:'AdunƒÉri/ScƒÉderi'}, {id:'easy_seq', icon:'üî¢', title:'»òiruri', desc:'UrmƒÉtorul nr'}, {id:'easy_comp', icon:'‚öñÔ∏è', title:'ComparƒÉ', desc:'Mai mare/mic'}] },
'max_menu': { title: 'Clasa 1-2 (Cu Trecere)', theme: 'girl', items: [{id:'max_math', icon:'üëë', title:'Calcule+', desc:'Cu trecere'}, {id:'max_seq', icon:'üß©', title:'»òiruri+', desc:'Salturi 2,5,10'}, {id:'max_eq', icon:'‚ùì', title:'Ecua»õii', desc:'Nr lipsƒÉ'}] },
'med_menu': { title: 'Clasa 3-4', theme: 'girl', items: [{id:'med_math', icon:'üå∏', title:'√énmul»õiri', desc:'Tabele'}, {id:'med_round', icon:'üéØ', title:'Rotunjiri', desc:'La 10 sau 100'}, {id:'med_order', icon:'üìù', title:'Ordine', desc:'Cu paranteze'}] },
'hard_menu': { title: 'Clasa 5+', theme: 'girl', items: [{id:'hard_frac', icon:'üç∞', title:'Frac»õii', desc:'AdunƒÉri frac»õii'}, {id:'hard_dec', icon:'üíß', title:'Zecimale', desc:'Cu virgulƒÉ'}, {id:'hard_pow', icon:'‚ö°', title:'Puteri', desc:'Calcul avansat'}] },
'pro_menu': { title: '5 Pro', theme: 'pro', items: [{id:'pro_cong', icon:'‚öõÔ∏è', title:'Congruen»õe', desc:'Mod n'}, {id:'pro_last', icon:'üî¢', title:'Ultima CifrƒÉ', desc:'DeterminƒÉ'}, {id:'pro_div', icon:'‚ûó', title:'Divizibilitate', desc:'Restul'}] }
};

function initMath() { renderMathMainMenu(); document.getElementById('mathAnswerInput').addEventListener("keypress", e => { if(e.key==="Enter") checkMathAnswer(); }); }
function renderMathMainMenu() {
const grid = document.getElementById('mathMenuGrid'); grid.innerHTML = '';
Object.keys(mathMenus).forEach(key => {
const m = mathMenus[key];
const card = document.createElement('div');
card.className = `card ${m.theme==='boy'?'kg-card':(m.theme==='pro'?'pro-card':'easy-card')}`;
const lbBtn = document.createElement('button'); lbBtn.innerHTML='üèÜ'; lbBtn.style.position='absolute'; lbBtn.style.top='5px'; lbBtn.style.right='5px'; lbBtn.style.background='none'; lbBtn.style.border='none'; lbBtn.style.fontSize='1.2rem'; lbBtn.onclick=(e)=>{e.stopPropagation(); showMathLeaderboard(key);};
card.innerHTML = `<div class="card-icon">${m.items[0].icon}</div><div class="card-title-wrap"><div class="card-title">${m.title}</div><div class="card-desc">${m.items[0].desc}</div></div>`;
card.appendChild(lbBtn); card.onclick = () => openMathSubmenu(key); grid.appendChild(card);
});
}
function openMathSubmenu(key) {
mathCurrentSubMenuKey = key; const m = mathMenus[key]; if(!m) return;
document.getElementById('mathMainMenu').style.display='none'; document.getElementById('mathSubMenu').style.display='block';
document.getElementById('mathSubMenuTitle').textContent = m.title;
const subGrid = document.getElementById('mathSubMenuGrid'); subGrid.innerHTML='';
document.body.classList.remove('boy-theme','pro-theme');
if(m.theme==='boy') document.body.classList.add('boy-theme');
if(m.theme==='pro') document.body.classList.add('pro-theme');
m.items.forEach(item => {
const card = document.createElement('div');
card.className = `card ${m.theme==='boy'?'kg-card':(m.theme==='pro'?'pro-card':'easy-card')}`;
card.innerHTML = `<div class="card-icon">${item.icon}</div><div class="card-title-wrap"><div class="card-title">${item.title}</div><div class="card-desc">${item.desc}</div></div>`;
card.onclick = () => startMathGame(item.id); subGrid.appendChild(card);
});
}
function startMathGame(mode) {
mathCurrentMode = mode; mathScore = 100; mathQuestionCount = 0; mathDifficultyLevel = 1; isMathGameEnding = false;
updateMathStats();
document.getElementById('mathSubMenu').style.display='none'; document.getElementById('mathGameArea').style.display='block';
document.getElementById('mathAwardScreen').style.display='none'; document.getElementById('mathLeaderboardScreen').style.display='none';
const isBoy = mode.startsWith('kg'), isPro = mode.startsWith('pro');
if(isBoy) { document.body.classList.add('boy-theme'); document.getElementById('mathChoicesContainer').style.display='grid'; document.getElementById('mathInputContainer').style.display='none'; }
else { if(isPro) document.body.classList.add('pro-theme'); else document.body.classList.remove('boy-theme','pro-theme'); document.getElementById('mathChoicesContainer').style.display='none'; document.getElementById('mathInputContainer').style.display='flex'; }
nextMathProblem(); if(!isBoy) document.getElementById('mathAnswerInput').focus();
}
function updateMathStats() { document.getElementById('mathScoreDisplay').textContent=`Scor: ${mathScore}`; document.getElementById('mathProgressDisplay').textContent=`${mathQuestionCount+1}/${MAX_QUESTIONS}`; }
function startMathTimer(s) { clearInterval(mathTimerInterval); mathMaxTime=s; mathTimeLeft=s; updateMathTimerVisuals(); mathTimerInterval=setInterval(()=>{ mathTimeLeft--; updateMathTimerVisuals(); if(mathTimeLeft<=0){ clearInterval(mathTimerInterval); handleMathTimeout(); } }, 1000); }
function updateMathTimerVisuals() { const p=(mathTimeLeft/mathMaxTime)*100; document.getElementById('mathTimerBar').style.width=`${p}%`; document.getElementById('mathTimerBar').style.backgroundColor = p>50?'var(--success)':(p>20?'var(--timer-warning)':'var(--timer-danger)'); }
function handleMathTimeout() { showMathCorrectAnswer(true); }
function getRandomInt(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }
function generateMathChoices(correct, min, max) {
let s=new Set(); s.add(correct);
while(s.size<3) { let o=getRandomInt(-5,5), w=correct+o; if(w>=min && w<=max && w!==correct) s.add(w); else { let r=getRandomInt(min,max); if(r!==correct) s.add(r); } }
return Array.from(s).sort(()=>Math.random()-0.5);
}
function renderMathChoices(choices) {
const c=document.getElementById('mathChoicesContainer'); c.innerHTML='';
choices.forEach(v=>{ const b=document.createElement('button'); b.className='choice-btn'; b.textContent=v; b.onclick=()=>handleMathChoiceClick(v); c.appendChild(b); });
}
function handleMathChoiceClick(v) { if(isMathGameEnding) return; processMathResult(v===mathCurrentAnswer); }
function checkMathAnswer() {
if(mathCurrentMode.startsWith('kg') || isMathGameEnding) return;
const u=parseFloat(document.getElementById('mathAnswerInput').value); if(isNaN(u)) return;
let ok = mathCurrentMode==='easy_comp' ? (u===mathCurrentAnswer) : (Math.abs(u-mathCurrentAnswer)<0.01);
processMathResult(ok);
}
function processMathResult(ok) {
if(ok) { document.getElementById('mathFeedbackText').textContent="Bravo! üéâ"; document.getElementById('mathFeedbackText').className="feedback correct"; mathDifficultyLevel=1; }
else { mathScore-=5; updateMathStats(); document.getElementById('mathFeedbackText').textContent="Gre»ôit! üò¢"; document.getElementById('mathFeedbackText').className="feedback wrong"; mathDifficultyLevel++; showMathCorrectAnswer(false); return; }
if(mathQuestionCount>=MAX_QUESTIONS) { isMathGameEnding=true; setTimeout(endMathGame,1000); } else { setTimeout(nextMathProblem,1000); }
}
function nextMathProblem() {
if(mathQuestionCount>=MAX_QUESTIONS){ endMathGame(); return; }
mathQuestionCount++; updateMathStats();
document.getElementById('mathAnswerInput').value=''; document.getElementById('mathFeedbackText').textContent=''; document.getElementById('mathFeedbackText').className='feedback';
document.getElementById('mathGameContent').innerHTML=''; document.getElementById('mathChoicesContainer').innerHTML=''; mathProblemHTML='';
if(mathCurrentMode.startsWith('kg')) startMathTimer(mathDifficultyLevel===1?20:30); else startMathTimer(mathDifficultyLevel===1?15:25);

// Generare Probleme (scurtatƒÉ logic, same as before but compact)
if(mathCurrentMode==='kg_count'){ const mc=mathDifficultyLevel===1?5:10, c=getRandomInt(1,mc); mathCurrentAnswer=c; let h='<div class="visual-container>'; const icons=['üöó','‚öΩ','üöÄ']; for(let i=0;i<c;i++) h+=`<div class="visual-item">${icons[i%3]}</div>`; h+='</div><p style="font-size:0.9rem;font-weight:bold;">C√¢te?</p>'; document.getElementById('mathGameContent').innerHTML=h; renderMathChoices(generateMathChoices(c,1,mc+2)); }
else if(mathCurrentMode==='kg_sequence'){ const st=getRandomInt(0,mathDifficultyLevel===1?3:6), seq=[st,st+1,st+2]; mathCurrentAnswer=st+3; document.getElementById('mathGameContent').innerHTML=`<p style="font-size:0.9rem;font-weight:bold;">ContinuƒÉ:</p><div class="sequence-display">${seq.join(',')} <span class="missing-number">?</span></div>`; renderMathChoices(generateMathChoices(mathCurrentAnswer,0,10)); }
else if(mathCurrentMode==='kg_add'){ const mn=mathDifficultyLevel===1?4:9, n1=getRandomInt(1,mn), n2=getRandomInt(1,mn); mathCurrentAnswer=n1+n2; let h='<div class="visual-container">'; for(let i=0;i<n1;i++) h+='<div style="font-size:1.5rem">‚öΩ</div>'; h+='<div style="font-weight:900;color:#2196F3">+</div>'; for(let i=0;i<n2;i++) h+='<div style="font-size:1.5rem">‚öΩ</div>'; h+='</div>'; document.getElementById('mathGameContent').innerHTML=h+`<div class="problem-display">${n1}+${n2}=?</div>`; renderMathChoices(generateMathChoices(mathCurrentAnswer,2,mn*2+2)); }
else if(mathCurrentMode==='easy_math'){ const rm=mathDifficultyLevel===1?50:90, op=Math.random()>0.5?'+':'-'; let n1=getRandomInt(10,rm), n2; if(op==='+'){ let d1_10=Math.floor(n1/10), d1_1=n1%10, d2_10=getRandomInt(0,9-d1_10), d2_1=getRandomInt(0,9-d1_1); n2=(d2_10*10)+d2_1; if(n2===0)n2=1; mathCurrentAnswer=n1+n2; } else { let d1_10=Math.floor(n1/10), d1_1=n1%10, d2_10=getRandomInt(0,d1_10), d2_1=getRandomInt(0,d1_1); n2=(d2_10*10)+d2_1; if(n2===0)n2=1; if(n2>=n1)n2=getRandomInt(1,n1-1); mathCurrentAnswer=n1-n2; } mathProblemHTML=`<div class="problem-display">${n1} ${op} ${n2} = ?</div>`; document.getElementById('mathGameContent').innerHTML=mathProblemHTML; }
else if(mathCurrentMode==='easy_seq'){ const st=getRandomInt(1,20), seq=[st,st+1,st+2]; mathCurrentAnswer=st+3; mathProblemHTML=`<div class="sequence-display">${seq.join(',')}, <span class="missing-number">?</span></div>`; document.getElementById('mathGameContent').innerHTML=mathProblemHTML; }
else if(mathCurrentMode==='easy_comp'){ const n1=getRandomInt(10,50), n2=getRandomInt(10,50); mathCurrentAnswer=n1>n2?1:2; mathProblemHTML=`<div style="font-size:1rem;color:#666;">ComparƒÉ:</div><div class="problem-display">${n1} <span class="missing-number">?</span> ${n2}</div><div style="font-size:0.8rem;color:#666;">(1 st√¢nga, 2 dreapta)</div>`; document.getElementById('mathGameContent').innerHTML=mathProblemHTML; }
else if(mathCurrentMode==='max_math'){ const op=Math.random()>0.5?'+':'-'; let n1,n2; if(op==='+'){ let u1=getRandomInt(1,9), u2=getRandomInt(10-u1,9), t1=getRandomInt(1,8), t2=getRandomInt(0,9-t1); n1=t1*10+u1; n2=t2*10+u2; mathCurrentAnswer=n1+n2; } else { let u1=getRandomInt(0,8), u2=getRandomInt(u1+1,9), t1=getRandomInt(2,9), t2=getRandomInt(0,t1-1); n1=t1*10+u1; n2=t2*10+u2; mathCurrentAnswer=n1-n2; } mathProblemHTML=`<div class="problem-display">${n1} ${op} ${n2} = ?</div>`; document.getElementById('mathGameContent').innerHTML=mathProblemHTML; }
else if(mathCurrentMode==='max_seq'){ const step=mathDifficultyLevel===1?2:5, st=getRandomInt(1,10), seq=[st,st+step,st+step*2]; mathCurrentAnswer=st+step*3; mathProblemHTML=`<div class="sequence-display">${seq.join(',')}, <span class="missing-number">?</span></div>`; document.getElementById('mathGameContent').innerHTML=mathProblemHTML; }
else if(mathCurrentMode==='max_eq'){ const res=getRandomInt(10,50), add=getRandomInt(1,9); mathCurrentAnswer=res-add; mathProblemHTML=`<div class="problem-display"><span class="missing-number">?</span> + ${add} = ${res}</div>`; document.getElementById('mathGameContent').innerHTML=mathProblemHTML; }
else if(mathCurrentMode==='med_math'){ const n1=getRandomInt(2,9), n2=getRandomInt(2,9); mathCurrentAnswer=n1*n2; mathProblemHTML=`<div class="problem-display">${n1} √ó ${n2} = ?</div>`; document.getElementById('mathGameContent').innerHTML=mathProblemHTML; }
else if(mathCurrentMode==='med_round'){ const num=getRandomInt(15,985), rt=mathDifficultyLevel===1?10:100; mathCurrentAnswer=Math.round(num/rt)*rt; mathProblemHTML=`<div style="font-size:1rem;color:#666;">Rotunjire la ${rt}:</div><div class="problem-display">${num} ‚âà <span class="missing-number">?</span></div>`; document.getElementById('mathGameContent').innerHTML=mathProblemHTML; }
else if(mathCurrentMode==='med_order'){ const a=getRandomInt(2,5), b=getRandomInt(2,5), c=getRandomInt(1,10); mathCurrentAnswer=(a+b)*c; mathProblemHTML=`<div class="problem-display">(${a}+${b})√ó${c}=?</div>`; document.getElementById('mathGameContent').innerHTML=mathProblemHTML; }
else if(mathCurrentMode==='hard_frac'){ const den=getRandomInt(2,9), n1=getRandomInt(1,den-1), n2=getRandomInt(1,den-n1); mathCurrentAnswer=(n1+n2)/den; mathProblemHTML=`<div style="font-size:1rem;color:#666;">Calcul:</div><div class="problem-display">${n1}/${den}+${n2}/${den}=<span class="missing-number">?</span></div>`; document.getElementById('mathGameContent').innerHTML=mathProblemHTML; }
else if(mathCurrentMode==='hard_dec'){ const n1=getRandomInt(10,50)/10, n2=getRandomInt(10,50)/10; mathCurrentAnswer=n1+n2; mathProblemHTML=`<div class="problem-display">${n1}+${n2}=<span class="missing-number">?</span></div>`; document.getElementById('mathGameContent').innerHTML=mathProblemHTML; }
else if(mathCurrentMode==='hard_pow'){ const b=getRandomInt(2,5), e=getRandomInt(2,3); mathCurrentAnswer=Math.pow(b,e); mathProblemHTML=`<div class="problem-display">${b}<sup>${e}</sup>=<span class="missing-number">?</span></div>`; document.getElementById('mathGameContent').innerHTML=mathProblemHTML; }
else if(mathCurrentMode==='pro_cong'){ const n=mathDifficultyLevel===1?getRandomInt(2,5):getRandomInt(6,12), a=getRandomInt(10,100); mathCurrentAnswer=a%n; mathProblemHTML=`<div style="font-size:1rem;color:#666;">Congruen»õƒÉ:</div><div class="problem-display">${a}‚â°<span class="missing-number">?</span>(mod ${n})</div>`; document.getElementById('mathGameContent').innerHTML=mathProblemHTML; }
else if(mathCurrentMode==='pro_last'){ const b=getRandomInt(11,99), e=getRandomInt(2,5); mathCurrentAnswer=Math.pow(b,e)%10; mathProblemHTML=`<div style="font-size:1rem;color:#666;">Ultima cifrƒÉ:</div><div class="problem-display">${b}<sup>${e}</sup>‚Üí<span class="missing-number">?</span></div>`; document.getElementById('mathGameContent').innerHTML=mathProblemHTML; }
else if(mathCurrentMode==='pro_div'){ const d=mathDifficultyLevel===1?3:7, a=getRandomInt(20,100); mathCurrentAnswer=a%d; mathProblemHTML=`<div style="font-size:1rem;color:#666;">Rest:</div><div class="problem-display">${a}:${d} rest <span class="missing-number">?</span></div>`; document.getElementById('mathGameContent').innerHTML=mathProblemHTML; }
}
function endMathGame() {
clearInterval(mathTimerInterval); document.getElementById('mathGameArea').style.display='none'; document.getElementById('mathAwardScreen').style.display='flex';
document.getElementById('mathFinalScoreText').textContent=`Scor Final: ${mathScore}`;
let icon='', title='', tClass='', showIn=false;
if(mathScore===100){icon='üèÜ';title='PREMIUL 1';tClass='award-gold';showIn=true;}
else if(mathScore===95){icon='ü•à';title='PREMIUL 2';tClass='award-silver';showIn=true;}
else if(mathScore===90){icon='ü•â';title='PREMIUL 3';tClass='award-bronze';showIn=true;}
else if(mathScore>=70){icon='üéñÔ∏è';title='MEN»öIUNE';tClass='award-mention';showIn=true;}
else{icon='üí™';title='√éNCEARCƒÇ DIN NOU';tClass='award-try';showIn=false;}
document.getElementById('mathAwardIcon').textContent=icon; document.getElementById('mathAwardTitle').textContent=title; document.getElementById('mathAwardTitle').className='award-title '+tClass;
if(showIn){ document.getElementById('mathNameInputGroup').style.display='flex'; document.getElementById('mathCloseAwardBtn').style.display='none'; document.getElementById('mathPlayerName').value=''; document.getElementById('mathPlayerName').focus(); }
else{ document.getElementById('mathNameInputGroup').style.display='none'; document.getElementById('mathCloseAwardBtn').style.display='inline-block'; }
}
function saveMathScore() {
const name=document.getElementById('mathPlayerName').value.trim()||"Anonim"; const k=`math_leaderboard_${mathCurrentMode}`;
try{ let s=JSON.parse(localStorage.getItem(k)||"[]"); s.push({name:name,score:mathScore,date:new Date().toLocaleDateString()}); s.sort((a,b)=>b.score-a.score); s=s.slice(0,10); localStorage.setItem(k,JSON.stringify(s)); document.getElementById('mathNameInputGroup').style.display='none'; document.getElementById('mathCloseAwardBtn').style.display='inline-block'; }catch(e){alert("Eroare salvare");}
}
function showMathLeaderboard(catKey) {
const k=catKey||mathCurrentSubMenuKey, m=mathMenus[k]; if(!m) return;
document.getElementById('mathGameArea').style.display='none'; document.getElementById('mathAwardScreen').style.display='none'; document.getElementById('mathSubMenu').style.display='none'; document.getElementById('mathMainMenu').style.display='none';
document.getElementById('mathLeaderboardScreen').style.display='flex'; document.getElementById('mathBackBtn').style.display='block';
document.getElementById('mathBackBtn').onclick=()=>{ document.getElementById('mathLeaderboardScreen').style.display='none'; if(catKey) document.getElementById('mathMainMenu').style.display='block'; else document.getElementById('mathSubMenu').style.display='block'; };
document.getElementById('mathLeaderboardTitle').textContent=`Clasament: ${m.title}`;
let all=[]; if(m.items) m.items.forEach(it=>{ try{ const ik=`math_leaderboard_${it.id}`, is=JSON.parse(localStorage.getItem(ik)||"[]"); all=all.concat(is); }catch(e){} });
all.sort((a,b)=>b.score-a.score); all=all.slice(0,10);
const tb=document.getElementById('mathLeaderboardBody'); tb.innerHTML='';
if(all.length===0) tb.innerHTML='<tr><td colspan="3">FƒÉrƒÉ scoruri.</td></tr>';
else all.forEach((e,i)=>{ tb.innerHTML+=`<tr><td>${i+1}</td><td>${e.name}</td><td>${e.score}</td></tr>`; });
}
function showMathCorrectAnswer(isT) {
if(mathProblemHTML) document.getElementById('mathGameContent').innerHTML=mathProblemHTML.replace(/<span class="missing-number">\?<\/span>/g, `<span style="color:var(--success);font-weight:900;border-bottom:2px solid var(--success)">${mathCurrentAnswer}</span>`);
document.getElementById('mathFeedbackText').innerHTML=isT?`Timp! RƒÉspuns: <strong>${mathCurrentAnswer}</strong>.`:`Gre»ôit! RƒÉspuns: <strong>${mathCurrentAnswer}</strong>.`;
document.getElementById('mathFeedbackText').className="feedback wrong"; mathScore-=5; updateMathStats(); mathDifficultyLevel++; document.getElementById('mathAnswerInput').value='';
if(mathQuestionCount>=MAX_QUESTIONS){ isMathGameEnding=true; setTimeout(endMathGame,2000); } else { setTimeout(nextMathProblem,2000); }
}

// ==========================================
// LOGICA SƒÇRITURI
// ==========================================
const jumpCanvas=document.getElementById('jumpCanvas'), jumpCtx=jumpCanvas.getContext('2d'), jumpScoreEl=document.getElementById('jumpScoreVal'), jumpStationEl=document.getElementById('jumpStationVal'), jumpMenu=document.getElementById('jumpMenu'), jumpWinScreen=document.getElementById('jumpWinScreen'), jumpBtnGirl=document.getElementById('jumpBtnGirl'), jumpBtnBoy=document.getElementById('jumpBtnBoy');
let jumpGameRunning=false, jumpScore=0, jumpStation=0, maxStations=15, jumpFrame=0, jumpSpeed=6, jumpCharType='girl', jumpGravity=0.5, jumpPower=-15, jumpGroundH=80, jumpPlayer={x:80,y:0,size:60,dy:0,angle:0,grounded:false}, jumpObstacles=[];
const jumpThemes=[{bg:['#ff9a9e','#fecfef'],gr:'#6ab04c'},{bg:['#4facfe','#00f2fe'],gr:'#0097e6'},{bg:['#fddb92','#d1fdff'],gr:'#eccc68'},{bg:['#96fbc4','#f9f586'],gr:'#2ed573'},{bg:['#c2e9fb','#a1c4fd'],gr:'#3742fa'},{bg:['#ffecd2','#fcb69f'],gr:'#ff7f50'},{bg:['#e0c3fc','#8ec5fc'],gr:'#a55eea'},{bg:['#ffecd2','#ffd1ff'],gr:'#ff4757'},{bg:['#d299c2','#fef9d7'],gr:'#8c7ae6'},{bg:['#85FFBD','#FFFB7D'],gr:'#26de81'},{bg:['#C9FFBF','#FFAFBD'],gr:'#fc5c65'},{bg:['#FAD961','#F76B1C'],gr:'#e58e26'},{bg:['#B5FFFC','#D5FFEA'],gr:'#0be881'},{bg:['#FFDEE9','#B5FFFC'],gr:'#4834d4'},{bg:['#F6D365','#FDA085'],gr:'#be2edd'},{bg:['#667eea','#764ba2'],gr:'#ffffff'}];
function initJumpGame(){ resizeJumpCanvas(); window.addEventListener('resize',resizeJumpCanvas); window.addEventListener('pointerdown',e=>{if(e.target.tagName==='BUTTON')return;jumpDoJump();}); window.addEventListener('keydown',e=>{if((e.code==='Space'||e.code==='ArrowUp')&&jumpGameRunning)jumpDoJump();}); }
function resizeJumpCanvas(){ jumpCanvas.width=window.innerWidth; jumpCanvas.height=window.innerHeight; if(!jumpGameRunning){ jumpPlayer.y=jumpCanvas.height-jumpGroundH-jumpPlayer.size; jumpPlayer.x=jumpCanvas.width*0.15; drawJump(); } else { jumpPlayer.x=jumpCanvas.width*0.15; } }
window.setJumpChar=function(t){ jumpCharType=t; if(t==='girl'){jumpBtnGirl.classList.add('selected');jumpBtnBoy.classList.remove('selected');}else{jumpBtnBoy.classList.add('selected');jumpBtnGirl.classList.remove('selected');} };
window.startJumpGame=function(){ jumpMenu.style.display='none'; jumpGameRunning=true; jumpScore=0; jumpStation=0; jumpSpeed=6; jumpFrame=0; jumpObstacles=[]; jumpPlayer.y=jumpCanvas.height-jumpGroundH-jumpPlayer.size; jumpPlayer.dy=0; updateJumpUI(); jumpLoop(); };
function jumpDoJump(){ if(!jumpGameRunning)return; if(jumpPlayer.grounded||jumpPlayer.y>jumpCanvas.height-jumpGroundH-jumpPlayer.size-10){ jumpPlayer.dy=jumpPower; jumpPlayer.grounded=false; } }
function updateJumpUI(){ jumpScoreEl.innerText=jumpScore; jumpStationEl.innerText=Math.min(jumpStation,maxStations); }
function jumpLoop(){ if(!jumpGameRunning)return; requestAnimationFrame(jumpLoop); jumpFrame++; updateJump(); drawJump(); }
function updateJump(){ jumpPlayer.dy+=jumpGravity; jumpPlayer.y+=jumpPlayer.dy; if(jumpPlayer.y+jumpPlayer.size>jumpCanvas.height-jumpGroundH){ jumpPlayer.y=jumpCanvas.height-jumpGroundH-jumpPlayer.size; jumpPlayer.dy=0; jumpPlayer.grounded=true; jumpPlayer.angle=0; }else{ jumpPlayer.grounded=false; jumpPlayer.angle+=0.1; } if(jumpFrame%Math.floor(800/jumpSpeed)===0){ let oh=30+Math.random()*30; jumpObstacles.push({x:jumpCanvas.width,y:jumpCanvas.height-jumpGroundH-oh,w:30,h:oh,passed:false}); } for(let i=0;i<jumpObstacles.length;i++){ let o=jumpObstacles[i]; o.x-=jumpSpeed; if(jumpPlayer.x<o.x+o.w && jumpPlayer.x+jumpPlayer.size>o.x && jumpPlayer.y<o.y+o.h && jumpPlayer.y+jumpPlayer.size>o.y){ jumpGameOver(); } if(o.x+o.w<jumpPlayer.x&&!o.passed){ jumpScore++; if(jumpScore%5===0){ jumpStation++; jumpSpeed+=0.5; if(jumpStation>=maxStations){ jumpGameWin(); return; } } updateJumpUI(); o.passed=true; } } if(jumpObstacles.length>0&&jumpObstacles[0].x<-50)jumpObstacles.shift(); }
function drawJump(){ let t=jumpThemes[Math.min(jumpStation,jumpThemes.length-1)]; let g=jumpCtx.createLinearGradient(0,0,0,jumpCanvas.height); g.addColorStop(0,t.bg[0]); g.addColorStop(1,t.bg[1]); jumpCtx.fillStyle=g; jumpCtx.fillRect(0,0,jumpCanvas.width,jumpCanvas.height); jumpCtx.fillStyle=t.gr; jumpCtx.fillRect(0,jumpCanvas.height-jumpGroundH,jumpCanvas.width,jumpGroundH); jumpCtx.fillStyle="rgba(255,255,255,0.3)"; jumpCtx.fillRect(0,jumpCanvas.height-jumpGroundH,jumpCanvas.width,5); jumpCtx.fillStyle="#ff4757"; jumpObstacles.forEach(o=>{ jumpCtx.beginPath(); jumpCtx.moveTo(o.x,o.y+o.h); jumpCtx.lineTo(o.x+o.w/2,o.y); jumpCtx.lineTo(o.x+o.w,o.y+o.h); jumpCtx.fill(); }); jumpCtx.save(); jumpCtx.translate(jumpPlayer.x+jumpPlayer.size/2,jumpPlayer.y+jumpPlayer.size/2); jumpCtx.rotate(jumpPlayer.angle); jumpCtx.font=jumpPlayer.size+"px Arial"; jumpCtx.textAlign="center"; jumpCtx.textBaseline="middle"; jumpCtx.fillText(jumpCharType==='girl'?"üåü":"ü¶ï",0,0); jumpCtx.restore(); }
function jumpGameOver(){ jumpGameRunning=false; jumpMenu.style.display='flex'; document.querySelector('#jumpMenu h1').innerText="Joc Terminat!\nScor: "+jumpScore; document.getElementById('jumpStartBtn').innerText="√éncearcƒÉ Din Nou"; }
function jumpGameWin(){ jumpGameRunning=false; jumpWinScreen.style.display='flex'; }

// ==========================================
// LOGICA LITERE
// ==========================================
const letterAllChars="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789", letterDrawCanvas=document.getElementById('drawCanvas'), letterDrawCtx=letterDrawCanvas.getContext('2d'), letterGuideCanvas=document.getElementById('guideCanvas'), letterGuideCtx=letterGuideCanvas.getContext('2d'), letterTargetCharEl=document.getElementById('letterTargetChar'), letterTargetCard=document.getElementById('letterTargetCard'), letterMainBtn=document.getElementById('letterMainBtn'), letterFeedbackEl=document.getElementById('letterFeedback'), letterFeedbackText=document.getElementById('letterFeedbackText'), letterFeedbackIcon=document.getElementById('letterFeedbackIcon'), letterScoreEl=document.getElementById('letterScore');
let letterCurrentChar='', letterScore=0, letterIsLevelComplete=false, letterHasDrawnSomething=false;
function initLetterGame(){ resizeLetterCanvases(); window.addEventListener('resize',resizeLetterCanvases); setupLetterDrawing(); nextLetterLevel(); }
function resizeLetterCanvases(){ const c=letterDrawCanvas.parentElement; [letterDrawCanvas,letterGuideCanvas].forEach(cv=>{ cv.width=c.clientWidth; cv.height=c.clientHeight; }); letterDrawCtx.lineCap='round'; letterDrawCtx.lineJoin='round'; letterDrawCtx.lineWidth=Math.max(8,c.clientWidth/20); letterDrawCtx.strokeStyle='#5E6472'; if(letterCurrentChar)drawLetterGuide(); }
function drawLetterGuide(){ letterGuideCtx.clearRect(0,0,letterGuideCanvas.width,letterGuideCanvas.height); letterGuideCtx.fillStyle='#E0E0E0'; letterGuideCtx.font=`bold ${letterGuideCanvas.height*0.8}px 'Fredoka One'`; letterGuideCtx.textAlign='center'; letterGuideCtx.textBaseline='middle'; letterGuideCtx.fillText(letterCurrentChar,letterGuideCanvas.width/2,letterGuideCanvas.height/2+(letterGuideCanvas.height*0.05)); }
function setupLetterDrawing(){ let drawing=false; function getPos(e){ const r=letterDrawCanvas.getBoundingClientRect(), cx=e.touches?e.touches[0].clientX:e.clientX, cy=e.touches?e.touches[0].clientY:e.clientY; return{x:cx-r.left,y:cy-r.top}; } function start(e){ if(letterIsLevelComplete)return; drawing=true; letterHasDrawnSomething=true; const p=getPos(e); letterDrawCtx.beginPath(); letterDrawCtx.moveTo(p.x,p.y); if(e.cancelable)e.preventDefault(); } function move(e){ if(!drawing||letterIsLevelComplete)return; const p=getPos(e); letterDrawCtx.lineTo(p.x,p.y); letterDrawCtx.stroke(); if(e.cancelable)e.preventDefault(); } function stop(){ drawing=false; letterDrawCtx.closePath(); } letterDrawCanvas.addEventListener('mousedown',start); letterDrawCanvas.addEventListener('mousemove',move); letterDrawCanvas.addEventListener('mouseup',stop); letterDrawCanvas.addEventListener('mouseout',stop); letterDrawCanvas.addEventListener('touchstart',start,{passive:false}); letterDrawCanvas.addEventListener('touchmove',move,{passive:false}); letterDrawCanvas.addEventListener('touchend',stop); }
function nextLetterLevel(){ letterIsLevelComplete=false; letterHasDrawnSomething=false; letterCurrentChar=letterAllChars.charAt(Math.floor(Math.random()*letterAllChars.length)); letterTargetCharEl.textContent=letterCurrentChar; clearLetterCanvas(); drawLetterGuide(); letterTargetCard.classList.remove('bounce','shake'); void letterTargetCard.offsetWidth; letterTargetCard.classList.add('bounce'); updateLetterButton('check'); hideLetterFeedback(); }
function clearLetterCanvas(){ letterDrawCtx.clearRect(0,0,letterDrawCanvas.width,letterDrawCanvas.height); letterHasDrawnSomething=false; if(letterIsLevelComplete){ letterIsLevelComplete=false; updateLetterButton('check'); hideLetterFeedback(); } }
function updateLetterButton(st){ letterMainBtn.innerHTML=''; letterMainBtn.className='letter-action-btn'; if(st==='check'){ letterMainBtn.textContent="VerificƒÉ!"; letterMainBtn.onclick=handleLetterCheck; } else if(st==='skip'){ letterMainBtn.innerHTML="<span>üîÑ AltƒÉ</span>"; letterMainBtn.onclick=nextLetterLevel; } else if(st==='next'){ letterMainBtn.textContent="UrmƒÉtoarea ‚û°Ô∏è"; letterMainBtn.onclick=nextLetterLevel; } }
function handleLetterAction(){ if(letterIsLevelComplete)nextLetterLevel(); }
function handleLetterCheck(){ if(!letterHasDrawnSomething){ showLetterFeedback("DeseneazƒÉ!", "fail", "‚úèÔ∏è"); return; } const a=analyzeLetterDrawing(); if(a.matchRatio<0.35){ showLetterFeedback("Nu e bine!", "fail", "ü§î"); letterTargetCard.classList.add('shake'); setTimeout(()=>letterTargetCard.classList.remove('shake'),500); updateLetterButton('skip'); return; } winLetterLevel(); }
function analyzeLetterDrawing(){ const dD=letterDrawCtx.getImageData(0,0,letterDrawCanvas.width,letterDrawCanvas.height).data, gD=letterGuideCtx.getImageData(0,0,letterGuideCanvas.width,letterGuideCanvas.height).data; let dP=0,gP=0,mP=0; for(let i=0;i<dD.length;i+=4){ const isD=dD[i+3]>0, isG=gD[i+3]>0; if(isD)dP++; if(isG)gP++; if(isD&&isG)mP++; } if(gP===0)return{matchRatio:0}; return{matchRatio:(mP/gP*0.7)+(mP/(dP||1)*0.3)}; }
function winLetterLevel(){ letterIsLevelComplete=true; letterScore++; letterScoreEl.textContent=letterScore; showLetterFeedback("Bravo!", "success", "üåü"); updateLetterButton('next'); }
function showLetterFeedback(txt,type,icon){ letterFeedbackText.textContent=txt; letterFeedbackIcon.textContent=icon; letterFeedbackEl.className=`letter-feedback-overlay show ${type}`; setTimeout(hideLetterFeedback,1500); }
function hideLetterFeedback(){ letterFeedbackEl.classList.remove('show'); }

// ==========================================
// LOGICA COORDONATE
// ==========================================
const gameAreaCoord=document.getElementById('game-area-coord'), axisX=document.getElementById('axis-x'), axisY=document.getElementById('axis-y'), statusBox=document.getElementById('status-box'), undoBtn=document.getElementById('undoBtn'), colorButtons=document.querySelectorAll('.color-btn'), ROWS=12, COLS=10;
let actionHistory=[], isCoordGameMode=false, targetCoord=null, targetColor=null;
function initCoordBoard(){ axisX.style.gridTemplateColumns=`repeat(${COLS},25px)`; for(let i=1;i<=COLS;i++){ const n=document.createElement('div'); n.className='axis-number'; n.textContent=i; axisX.appendChild(n); } axisY.style.gridTemplateRows=`repeat(${ROWS},25px)`; for(let i=1;i<=ROWS;i++){ const n=document.createElement('div'); n.className='axis-number'; n.textContent=i; axisY.appendChild(n); } gameAreaCoord.style.gridTemplateColumns=`repeat(${COLS},25px)`; gameAreaCoord.style.gridTemplateRows=`repeat(${ROWS},25px)`; for(let r=1;r<=ROWS;r++){ for(let c=1;c<=COLS;c++){ const cell=document.createElement('div'); cell.classList.add('cell-coord'); cell.dataset.r=r; cell.dataset.c=c; cell.addEventListener('mousedown',e=>{if(e.button===0)handleCellClick(cell);}); cell.addEventListener('touchstart',e=>{e.preventDefault();handleCellClick(cell);},{passive:false}); gameAreaCoord.appendChild(cell); } } }
function highlightColorButton(hex){ colorButtons.forEach(b=>{ b.classList.remove('auto-selected'); if(b.dataset.color===hex)b.classList.add('auto-selected'); }); }
function handleCellClick(cell){ if(!isCoordGameMode)return; const r=parseInt(cell.dataset.r), c=parseInt(cell.dataset.c); checkMove(cell,r,c); }
function placeCrystal(cell,color){ if(cell.querySelector('.crystal'))return; const cr=document.createElement('div'); cr.classList.add('crystal'); cr.style.backgroundColor=color; let sh=color; if(color==='#ffffff'||color==='#ffd700')sh='#ccc'; cr.style.boxShadow=`inset 1px 1px 3px rgba(255,255,255,0.8), inset -1px -1px 3px rgba(0,0,0,0.3), 0 0 4px ${sh}`; cell.appendChild(cr); actionHistory.push({cell:cell,crystal:cr}); updateUndoBtn(); }
function startCoordGame(){ isCoordGameMode=true; clearGridNow(); nextLevel(); }
function updateStatus(){ if(!isCoordGameMode||!targetCoord)return; statusBox.innerHTML=`Pune cristalul <span style="color:${targetColor};font-size:1.1em">‚óè</span> la:<br><strong>Col ${targetCoord.c}, R√¢nd ${targetCoord.r}</strong>`; statusBox.style.color="#fff"; }
function checkMove(cell,r,c){ if(!targetCoord)return; if(r===targetCoord.r&&c===targetCoord.c){ placeCrystal(cell,targetColor); statusBox.innerHTML="<span style='color:#4CAF50;font-size:1.1rem'>BRAVO!</span>"; setTimeout(nextLevel,800); } else { statusBox.innerHTML=`<span style='color:#ff6b6b'>Gre»ôit! CautƒÉ Col ${targetCoord.c}, R√¢nd ${targetCoord.r}.</span>`; cell.style.backgroundColor="#ffcccc"; setTimeout(()=>cell.style.backgroundColor="#f9f9f9",200); } }
function nextLevel(){ const r=Math.floor(Math.random()*ROWS)+1, c=Math.floor(Math.random()*COLS)+1, colors=['#ff0000','#ff8c00','#ffd700','#008000','#1e90ff','#4b0082','#ffffff'], color=colors[Math.floor(Math.random()*colors.length)], existing=document.querySelector(`.cell-coord[data-r='${r}'][data-c='${c}'] .crystal`); if(existing){nextLevel();return;} targetCoord={r,c}; targetColor=color; highlightColorButton(color); const tc=document.querySelector(`.cell-coord[data-r='${r}'][data-c='${c}']`); if(tc){ tc.classList.add('highlight'); setTimeout(()=>tc.classList.remove('highlight'),1000); } updateStatus(); }
function undoLast(){ if(actionHistory.length===0)return; const l=actionHistory.pop(); if(l.crystal&&l.crystal.parentNode)l.crystal.remove(); updateUndoBtn(); }
function updateUndoBtn(){ undoBtn.disabled=actionHistory.length===0; }
function clearGridNow(){ document.querySelectorAll('.crystal').forEach(c=>{if(c.parentNode)c.parentNode.removeChild(c);}); actionHistory=[]; isCoordGameMode=false; targetCoord=null; targetColor=null; updateUndoBtn(); colorButtons.forEach(b=>b.classList.remove('auto-selected')); statusBox.textContent="Tabla curatƒÉ! ApasƒÉ Start."; statusBox.style.backgroundColor="rgba(255,255,255,0.1)"; }
function initCoordGame(){ initCoordBoard(); }

initMath();
</script>
</body>
</html>

